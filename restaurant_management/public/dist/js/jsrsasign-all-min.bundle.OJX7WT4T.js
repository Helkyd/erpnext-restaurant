(()=>{H===void 0&&(H={});var H;H.lang={extend:function(t,e,i){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var n=function(){};if(n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),i){var r;for(r in i)t.prototype[r]=i[r];var s=function(){},o=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(s=function(h,g){for(r=0;r<o.length;r=r+1){var p=o[r],S=g[p];typeof S=="function"&&S!=Object.prototype[p]&&(h[p]=S)}})}catch(h){}s(t.prototype,i)}}};var V=V||function(t,e){var i={},n=i.lib={},r=n.Base=function(){function f(){}return{extend:function(c){f.prototype=this;var u=new f;return c&&u.mixIn(c),u.hasOwnProperty("init")||(u.init=function(){u.$super.init.apply(this,arguments)}),u.init.prototype=u,u.$super=this,u},create:function(){var c=this.extend();return c.init.apply(c,arguments),c},init:function(){},mixIn:function(c){for(var u in c)c.hasOwnProperty(u)&&(this[u]=c[u]);c.hasOwnProperty("toString")&&(this.toString=c.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=n.WordArray=r.extend({init:function(f,c){f=this.words=f||[],c!=e?this.sigBytes=c:this.sigBytes=f.length*4},toString:function(f){return(f||h).stringify(this)},concat:function(f){var c=this.words,u=f.words,d=this.sigBytes,v=f.sigBytes;if(this.clamp(),d%4)for(var m=0;m<v;m++){var F=u[m>>>2]>>>24-m%4*8&255;c[d+m>>>2]|=F<<24-(d+m)%4*8}else for(var m=0;m<v;m+=4)c[d+m>>>2]=u[m>>>2];return this.sigBytes+=v,this},clamp:function(){var f=this.words,c=this.sigBytes;f[c>>>2]&=4294967295<<32-c%4*8,f.length=t.ceil(c/4)},clone:function(){var f=r.clone.call(this);return f.words=this.words.slice(0),f},random:function(f){for(var c=[],u=0;u<f;u+=4)c.push(t.random()*4294967296|0);return new s.init(c,f)}}),o=i.enc={},h=o.Hex={stringify:function(f){for(var c=f.words,u=f.sigBytes,d=[],v=0;v<u;v++){var m=c[v>>>2]>>>24-v%4*8&255;d.push((m>>>4).toString(16)),d.push((m&15).toString(16))}return d.join("")},parse:function(f){for(var c=f.length,u=[],d=0;d<c;d+=2)u[d>>>3]|=parseInt(f.substr(d,2),16)<<24-d%8*4;return new s.init(u,c/2)}},g=o.Latin1={stringify:function(f){for(var c=f.words,u=f.sigBytes,d=[],v=0;v<u;v++){var m=c[v>>>2]>>>24-v%4*8&255;d.push(String.fromCharCode(m))}return d.join("")},parse:function(f){for(var c=f.length,u=[],d=0;d<c;d++)u[d>>>2]|=(f.charCodeAt(d)&255)<<24-d%4*8;return new s.init(u,c)}},p=o.Utf8={stringify:function(f){try{return decodeURIComponent(escape(g.stringify(f)))}catch(c){throw new Error("Malformed UTF-8 data")}},parse:function(f){return g.parse(unescape(encodeURIComponent(f)))}},S=n.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(f){typeof f=="string"&&(f=p.parse(f)),this._data.concat(f),this._nDataBytes+=f.sigBytes},_process:function(f){var c=this._data,u=c.words,d=c.sigBytes,v=this.blockSize,m=v*4,F=d/m;f?F=t.ceil(F):F=t.max((F|0)-this._minBufferSize,0);var x=F*v,E=t.min(x*4,d);if(x){for(var w=0;w<x;w+=v)this._doProcessBlock(u,w);var B=u.splice(0,x);c.sigBytes-=E}return new s.init(B,E)},clone:function(){var f=r.clone.call(this);return f._data=this._data.clone(),f},_minBufferSize:0}),y=n.Hasher=S.extend({cfg:r.extend(),init:function(f){this.cfg=this.cfg.extend(f),this.reset()},reset:function(){S.reset.call(this),this._doReset()},update:function(f){return this._append(f),this._process(),this},finalize:function(f){f&&this._append(f);var c=this._doFinalize();return c},blockSize:512/32,_createHelper:function(f){return function(c,u){return new f.init(u).finalize(c)}},_createHmacHelper:function(f){return function(c,u){return new l.HMAC.init(f,u).finalize(c)}}}),l=i.algo={};return i}(Math);(function(t){var r=V,e=r.lib,i=e.Base,n=e.WordArray,r=r.x64={};r.Word=i.extend({init:function(s,o){this.high=s,this.low=o}}),r.WordArray=i.extend({init:function(s,o){s=this.words=s||[],this.sigBytes=o!=t?o:8*s.length},toX32:function(){for(var s=this.words,o=s.length,h=[],g=0;g<o;g++){var p=s[g];h.push(p.high),h.push(p.low)}return n.create(h,this.sigBytes)},clone:function(){for(var s=i.clone.call(this),o=s.words=this.words.slice(0),h=o.length,g=0;g<h;g++)o[g]=o[g].clone();return s}})})();V.lib.Cipher||function(t){var f=V,e=f.lib,i=e.Base,n=e.WordArray,r=e.BufferedBlockAlgorithm,s=f.enc.Base64,o=f.algo.EvpKDF,h=e.Cipher=r.extend({cfg:i.extend(),createEncryptor:function(u,d){return this.create(this._ENC_XFORM_MODE,u,d)},createDecryptor:function(u,d){return this.create(this._DEC_XFORM_MODE,u,d)},init:function(u,d,v){this.cfg=this.cfg.extend(v),this._xformMode=u,this._key=d,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(u){return this._append(u),this._process()},finalize:function(u){return u&&this._append(u),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(u){return{encrypt:function(d,v,m){return(typeof v=="string"?c:l).encrypt(u,d,v,m)},decrypt:function(d,v,m){return(typeof v=="string"?c:l).decrypt(u,d,v,m)}}}});e.StreamCipher=h.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var y=f.mode={},g=function(u,d,v){var m=this._iv;m?this._iv=t:m=this._prevBlock;for(var F=0;F<v;F++)u[d+F]^=m[F]},p=(e.BlockCipherMode=i.extend({createEncryptor:function(u,d){return this.Encryptor.create(u,d)},createDecryptor:function(u,d){return this.Decryptor.create(u,d)},init:function(u,d){this._cipher=u,this._iv=d}})).extend();p.Encryptor=p.extend({processBlock:function(u,d){var v=this._cipher,m=v.blockSize;g.call(this,u,d,m),v.encryptBlock(u,d),this._prevBlock=u.slice(d,d+m)}}),p.Decryptor=p.extend({processBlock:function(u,d){var v=this._cipher,m=v.blockSize,F=u.slice(d,d+m);v.decryptBlock(u,d),g.call(this,u,d,m),this._prevBlock=F}}),y=y.CBC=p,p=(f.pad={}).Pkcs7={pad:function(u,d){for(var v=4*d,v=v-u.sigBytes%v,m=v<<24|v<<16|v<<8|v,F=[],x=0;x<v;x+=4)F.push(m);v=n.create(F,v),u.concat(v)},unpad:function(u){u.sigBytes-=u.words[u.sigBytes-1>>>2]&255}},e.BlockCipher=h.extend({cfg:h.cfg.extend({mode:y,padding:p}),reset:function(){h.reset.call(this);var d=this.cfg,u=d.iv,d=d.mode;if(this._xformMode==this._ENC_XFORM_MODE)var v=d.createEncryptor;else v=d.createDecryptor,this._minBufferSize=1;this._mode=v.call(d,this,u&&u.words)},_doProcessBlock:function(u,d){this._mode.processBlock(u,d)},_doFinalize:function(){var u=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){u.pad(this._data,this.blockSize);var d=this._process(!0)}else d=this._process(!0),u.unpad(d);return d},blockSize:4});var S=e.CipherParams=i.extend({init:function(u){this.mixIn(u)},toString:function(u){return(u||this.formatter).stringify(this)}}),y=(f.format={}).OpenSSL={stringify:function(u){var d=u.ciphertext;return u=u.salt,(u?n.create([1398893684,1701076831]).concat(u).concat(d):d).toString(s)},parse:function(u){u=s.parse(u);var d=u.words;if(d[0]==1398893684&&d[1]==1701076831){var v=n.create(d.slice(2,4));d.splice(0,4),u.sigBytes-=16}return S.create({ciphertext:u,salt:v})}},l=e.SerializableCipher=i.extend({cfg:i.extend({format:y}),encrypt:function(u,d,v,m){m=this.cfg.extend(m);var F=u.createEncryptor(v,m);return d=F.finalize(d),F=F.cfg,S.create({ciphertext:d,key:v,iv:F.iv,algorithm:u,mode:F.mode,padding:F.padding,blockSize:u.blockSize,formatter:m.format})},decrypt:function(u,d,v,m){return m=this.cfg.extend(m),d=this._parse(d,m.format),u.createDecryptor(v,m).finalize(d.ciphertext)},_parse:function(u,d){return typeof u=="string"?d.parse(u,this):u}}),f=(f.kdf={}).OpenSSL={execute:function(u,d,v,m){return m||(m=n.random(8)),u=o.create({keySize:d+v}).compute(u,m),v=n.create(u.words.slice(d),4*v),u.sigBytes=4*d,S.create({key:u,iv:v,salt:m})}},c=e.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:f}),encrypt:function(u,d,v,m){return m=this.cfg.extend(m),v=m.kdf.execute(v,u.keySize,u.ivSize),m.iv=v.iv,u=l.encrypt.call(this,u,d,v.key,m),u.mixIn(v),u},decrypt:function(u,d,v,m){return m=this.cfg.extend(m),d=this._parse(d,m.format),v=m.kdf.execute(v,u.keySize,u.ivSize,d.salt),m.iv=v.iv,l.decrypt.call(this,u,d,v.key,m)}})}();(function(){for(var t=V,e=t.lib.BlockCipher,w=t.algo,i=[],n=[],r=[],s=[],o=[],h=[],g=[],p=[],S=[],y=[],l=[],f=0;256>f;f++)l[f]=128>f?f<<1:f<<1^283;for(var c=0,u=0,f=0;256>f;f++){var d=u^u<<1^u<<2^u<<3^u<<4,d=d>>>8^d&255^99;i[c]=d,n[d]=c;var v=l[c],m=l[v],F=l[m],x=257*l[d]^16843008*d;r[c]=x<<24|x>>>8,s[c]=x<<16|x>>>16,o[c]=x<<8|x>>>24,h[c]=x,x=16843009*F^65537*m^257*v^16843008*c,g[d]=x<<24|x>>>8,p[d]=x<<16|x>>>16,S[d]=x<<8|x>>>24,y[d]=x,c?(c=v^l[l[l[F^v]]],u^=l[l[u]]):c=u=1}var E=[0,1,2,4,8,16,32,64,128,27,54],w=w.AES=e.extend({_doReset:function(){for(var P=this._key,B=P.words,I=P.sigBytes/4,P=4*((this._nRounds=I+6)+1),R=this._keySchedule=[],N=0;N<P;N++)if(N<I)R[N]=B[N];else{var L=R[N-1];N%I?6<I&&N%I==4&&(L=i[L>>>24]<<24|i[L>>>16&255]<<16|i[L>>>8&255]<<8|i[L&255]):(L=L<<8|L>>>24,L=i[L>>>24]<<24|i[L>>>16&255]<<16|i[L>>>8&255]<<8|i[L&255],L^=E[N/I|0]<<24),R[N]=R[N-I]^L}for(B=this._invKeySchedule=[],I=0;I<P;I++)N=P-I,L=I%4?R[N]:R[N-4],B[I]=4>I||4>=N?L:g[i[L>>>24]]^p[i[L>>>16&255]]^S[i[L>>>8&255]]^y[i[L&255]]},encryptBlock:function(B,I){this._doCryptBlock(B,I,this._keySchedule,r,s,o,h,i)},decryptBlock:function(B,I){var P=B[I+1];B[I+1]=B[I+3],B[I+3]=P,this._doCryptBlock(B,I,this._invKeySchedule,g,p,S,y,n),P=B[I+1],B[I+1]=B[I+3],B[I+3]=P},_doCryptBlock:function(B,I,P,R,N,L,O,C){for(var D=this._nRounds,q=B[I]^P[0],Y=B[I+1]^P[1],G=B[I+2]^P[2],z=B[I+3]^P[3],A=4,T=1;T<D;T++)var _=R[q>>>24]^N[Y>>>16&255]^L[G>>>8&255]^O[z&255]^P[A++],k=R[Y>>>24]^N[G>>>16&255]^L[z>>>8&255]^O[q&255]^P[A++],M=R[G>>>24]^N[z>>>16&255]^L[q>>>8&255]^O[Y&255]^P[A++],z=R[z>>>24]^N[q>>>16&255]^L[Y>>>8&255]^O[G&255]^P[A++],q=_,Y=k,G=M;_=(C[q>>>24]<<24|C[Y>>>16&255]<<16|C[G>>>8&255]<<8|C[z&255])^P[A++],k=(C[Y>>>24]<<24|C[G>>>16&255]<<16|C[z>>>8&255]<<8|C[q&255])^P[A++],M=(C[G>>>24]<<24|C[z>>>16&255]<<16|C[q>>>8&255]<<8|C[Y&255])^P[A++],z=(C[z>>>24]<<24|C[q>>>16&255]<<16|C[Y>>>8&255]<<8|C[G&255])^P[A++],B[I]=_,B[I+1]=k,B[I+2]=M,B[I+3]=z},keySize:8});t.AES=e._createHelper(w)})();(function(){function t(l,f){var c=(this._lBlock>>>l^this._rBlock)&f;this._rBlock^=c,this._lBlock^=c<<l}function e(l,f){var c=(this._rBlock>>>l^this._lBlock)&f;this._lBlock^=c,this._rBlock^=c<<l}var i=V,r=i.lib,n=r.WordArray,r=r.BlockCipher,s=i.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],h=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],g=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],p=[{"0":8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{"0":1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{"0":260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{"0":2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{"0":128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{"0":268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{"0":1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{"0":134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],S=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],y=s.DES=r.extend({_doReset:function(){for(var l=this._key.words,f=[],c=0;56>c;c++){var u=o[c]-1;f[c]=l[u>>>5]>>>31-u%32&1}for(l=this._subKeys=[],u=0;16>u;u++){for(var d=l[u]=[],v=g[u],c=0;24>c;c++)d[c/6|0]|=f[(h[c]-1+v)%28]<<31-c%6,d[4+(c/6|0)]|=f[28+(h[c+24]-1+v)%28]<<31-c%6;for(d[0]=d[0]<<1|d[0]>>>31,c=1;7>c;c++)d[c]>>>=4*(c-1)+3;d[7]=d[7]<<5|d[7]>>>27}for(f=this._invSubKeys=[],c=0;16>c;c++)f[c]=l[15-c]},encryptBlock:function(l,f){this._doCryptBlock(l,f,this._subKeys)},decryptBlock:function(l,f){this._doCryptBlock(l,f,this._invSubKeys)},_doCryptBlock:function(l,f,c){this._lBlock=l[f],this._rBlock=l[f+1],t.call(this,4,252645135),t.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),t.call(this,1,1431655765);for(var u=0;16>u;u++){for(var d=c[u],v=this._lBlock,m=this._rBlock,F=0,x=0;8>x;x++)F|=p[x][((m^d[x])&S[x])>>>0];this._lBlock=m,this._rBlock=v^F}c=this._lBlock,this._lBlock=this._rBlock,this._rBlock=c,t.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),l[f]=this._lBlock,l[f+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});i.DES=r._createHelper(y),s=s.TripleDES=r.extend({_doReset:function(){var l=this._key.words;this._des1=y.createEncryptor(n.create(l.slice(0,2))),this._des2=y.createEncryptor(n.create(l.slice(2,4))),this._des3=y.createEncryptor(n.create(l.slice(4,6)))},encryptBlock:function(l,f){this._des1.encryptBlock(l,f),this._des2.decryptBlock(l,f),this._des3.encryptBlock(l,f)},decryptBlock:function(l,f){this._des3.decryptBlock(l,f),this._des2.encryptBlock(l,f),this._des1.decryptBlock(l,f)},keySize:6,ivSize:2,blockSize:2}),i.TripleDES=r._createHelper(s)})();(function(){var t=V,e=t.lib.WordArray;t.enc.Base64={stringify:function(i){var n=i.words,r=i.sigBytes,s=this._map;i.clamp(),i=[];for(var o=0;o<r;o+=3)for(var h=(n[o>>>2]>>>24-8*(o%4)&255)<<16|(n[o+1>>>2]>>>24-8*((o+1)%4)&255)<<8|n[o+2>>>2]>>>24-8*((o+2)%4)&255,g=0;4>g&&o+.75*g<r;g++)i.push(s.charAt(h>>>6*(3-g)&63));if(n=s.charAt(64))for(;i.length%4;)i.push(n);return i.join("")},parse:function(i){var n=i.length,r=this._map,s=r.charAt(64);s&&(s=i.indexOf(s),s!=-1&&(n=s));for(var s=[],o=0,h=0;h<n;h++)if(h%4){var g=r.indexOf(i.charAt(h-1))<<2*(h%4),p=r.indexOf(i.charAt(h))>>>6-2*(h%4);s[o>>>2]|=(g|p)<<24-8*(o%4),o++}return e.create(s,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(t){function e(y,l,f,c,u,d,v){return y=y+(l&f|~l&c)+u+v,(y<<d|y>>>32-d)+l}function i(y,l,f,c,u,d,v){return y=y+(l&c|f&~c)+u+v,(y<<d|y>>>32-d)+l}function n(y,l,f,c,u,d,v){return y=y+(l^f^c)+u+v,(y<<d|y>>>32-d)+l}function r(y,l,f,c,u,d,v){return y=y+(f^(l|~c))+u+v,(y<<d|y>>>32-d)+l}for(var s=V,g=s.lib,o=g.WordArray,h=g.Hasher,g=s.algo,p=[],S=0;64>S;S++)p[S]=4294967296*t.abs(t.sin(S+1))|0;g=g.MD5=h.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,l){for(var f=0;16>f;f++){var c=l+f,u=y[c];y[c]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360}var f=this._hash.words,c=y[l+0],u=y[l+1],d=y[l+2],v=y[l+3],m=y[l+4],F=y[l+5],x=y[l+6],E=y[l+7],w=y[l+8],B=y[l+9],I=y[l+10],P=y[l+11],R=y[l+12],N=y[l+13],L=y[l+14],O=y[l+15],C=f[0],T=f[1],A=f[2],D=f[3],C=e(C,T,A,D,c,7,p[0]),D=e(D,C,T,A,u,12,p[1]),A=e(A,D,C,T,d,17,p[2]),T=e(T,A,D,C,v,22,p[3]),C=e(C,T,A,D,m,7,p[4]),D=e(D,C,T,A,F,12,p[5]),A=e(A,D,C,T,x,17,p[6]),T=e(T,A,D,C,E,22,p[7]),C=e(C,T,A,D,w,7,p[8]),D=e(D,C,T,A,B,12,p[9]),A=e(A,D,C,T,I,17,p[10]),T=e(T,A,D,C,P,22,p[11]),C=e(C,T,A,D,R,7,p[12]),D=e(D,C,T,A,N,12,p[13]),A=e(A,D,C,T,L,17,p[14]),T=e(T,A,D,C,O,22,p[15]),C=i(C,T,A,D,u,5,p[16]),D=i(D,C,T,A,x,9,p[17]),A=i(A,D,C,T,P,14,p[18]),T=i(T,A,D,C,c,20,p[19]),C=i(C,T,A,D,F,5,p[20]),D=i(D,C,T,A,I,9,p[21]),A=i(A,D,C,T,O,14,p[22]),T=i(T,A,D,C,m,20,p[23]),C=i(C,T,A,D,B,5,p[24]),D=i(D,C,T,A,L,9,p[25]),A=i(A,D,C,T,v,14,p[26]),T=i(T,A,D,C,w,20,p[27]),C=i(C,T,A,D,N,5,p[28]),D=i(D,C,T,A,d,9,p[29]),A=i(A,D,C,T,E,14,p[30]),T=i(T,A,D,C,R,20,p[31]),C=n(C,T,A,D,F,4,p[32]),D=n(D,C,T,A,w,11,p[33]),A=n(A,D,C,T,P,16,p[34]),T=n(T,A,D,C,L,23,p[35]),C=n(C,T,A,D,u,4,p[36]),D=n(D,C,T,A,m,11,p[37]),A=n(A,D,C,T,E,16,p[38]),T=n(T,A,D,C,I,23,p[39]),C=n(C,T,A,D,N,4,p[40]),D=n(D,C,T,A,c,11,p[41]),A=n(A,D,C,T,v,16,p[42]),T=n(T,A,D,C,x,23,p[43]),C=n(C,T,A,D,B,4,p[44]),D=n(D,C,T,A,R,11,p[45]),A=n(A,D,C,T,O,16,p[46]),T=n(T,A,D,C,d,23,p[47]),C=r(C,T,A,D,c,6,p[48]),D=r(D,C,T,A,E,10,p[49]),A=r(A,D,C,T,L,15,p[50]),T=r(T,A,D,C,F,21,p[51]),C=r(C,T,A,D,R,6,p[52]),D=r(D,C,T,A,v,10,p[53]),A=r(A,D,C,T,I,15,p[54]),T=r(T,A,D,C,u,21,p[55]),C=r(C,T,A,D,w,6,p[56]),D=r(D,C,T,A,O,10,p[57]),A=r(A,D,C,T,x,15,p[58]),T=r(T,A,D,C,N,21,p[59]),C=r(C,T,A,D,m,6,p[60]),D=r(D,C,T,A,P,10,p[61]),A=r(A,D,C,T,d,15,p[62]),T=r(T,A,D,C,B,21,p[63]);f[0]=f[0]+C|0,f[1]=f[1]+T|0,f[2]=f[2]+A|0,f[3]=f[3]+D|0},_doFinalize:function(){var y=this._data,l=y.words,f=8*this._nDataBytes,c=8*y.sigBytes;l[c>>>5]|=128<<24-c%32;var u=t.floor(f/4294967296);for(l[(c+64>>>9<<4)+15]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360,l[(c+64>>>9<<4)+14]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,y.sigBytes=4*(l.length+1),this._process(),y=this._hash,l=y.words,f=0;4>f;f++)c=l[f],l[f]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360;return y},clone:function(){var y=h.clone.call(this);return y._hash=this._hash.clone(),y}}),s.MD5=h._createHelper(g),s.HmacMD5=h._createHmacHelper(g)})(Math);(function(){var t=V,r=t.lib,e=r.WordArray,i=r.Hasher,n=[],r=t.algo.SHA1=i.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(s,o){for(var h=this._hash.words,g=h[0],p=h[1],S=h[2],y=h[3],l=h[4],f=0;80>f;f++){if(16>f)n[f]=s[o+f]|0;else{var c=n[f-3]^n[f-8]^n[f-14]^n[f-16];n[f]=c<<1|c>>>31}c=(g<<5|g>>>27)+l+n[f],c=20>f?c+((p&S|~p&y)+1518500249):40>f?c+((p^S^y)+1859775393):60>f?c+((p&S|p&y|S&y)-1894007588):c+((p^S^y)-899497514),l=y,y=S,S=p<<30|p>>>2,p=g,g=c}h[0]=h[0]+g|0,h[1]=h[1]+p|0,h[2]=h[2]+S|0,h[3]=h[3]+y|0,h[4]=h[4]+l|0},_doFinalize:function(){var s=this._data,o=s.words,h=8*this._nDataBytes,g=8*s.sigBytes;return o[g>>>5]|=128<<24-g%32,o[(g+64>>>9<<4)+14]=Math.floor(h/4294967296),o[(g+64>>>9<<4)+15]=h,s.sigBytes=4*o.length,this._process(),this._hash},clone:function(){var s=i.clone.call(this);return s._hash=this._hash.clone(),s}});t.SHA1=i._createHelper(r),t.HmacSHA1=i._createHmacHelper(r)})();(function(t){for(var e=V,f=e.lib,i=f.WordArray,n=f.Hasher,f=e.algo,r=[],s=[],o=function(u){return 4294967296*(u-(u|0))|0},h=2,g=0;64>g;){var p;t:{p=h;for(var S=t.sqrt(p),y=2;y<=S;y++)if(!(p%y)){p=!1;break t}p=!0}p&&(8>g&&(r[g]=o(t.pow(h,.5))),s[g]=o(t.pow(h,1/3)),g++),h++}var l=[],f=f.SHA256=n.extend({_doReset:function(){this._hash=new i.init(r.slice(0))},_doProcessBlock:function(c,u){for(var d=this._hash.words,v=d[0],m=d[1],F=d[2],x=d[3],E=d[4],w=d[5],B=d[6],I=d[7],P=0;64>P;P++){if(16>P)l[P]=c[u+P]|0;else{var R=l[P-15],N=l[P-2];l[P]=((R<<25|R>>>7)^(R<<14|R>>>18)^R>>>3)+l[P-7]+((N<<15|N>>>17)^(N<<13|N>>>19)^N>>>10)+l[P-16]}R=I+((E<<26|E>>>6)^(E<<21|E>>>11)^(E<<7|E>>>25))+(E&w^~E&B)+s[P]+l[P],N=((v<<30|v>>>2)^(v<<19|v>>>13)^(v<<10|v>>>22))+(v&m^v&F^m&F),I=B,B=w,w=E,E=x+R|0,x=F,F=m,m=v,v=R+N|0}d[0]=d[0]+v|0,d[1]=d[1]+m|0,d[2]=d[2]+F|0,d[3]=d[3]+x|0,d[4]=d[4]+E|0,d[5]=d[5]+w|0,d[6]=d[6]+B|0,d[7]=d[7]+I|0},_doFinalize:function(){var c=this._data,u=c.words,d=8*this._nDataBytes,v=8*c.sigBytes;return u[v>>>5]|=128<<24-v%32,u[(v+64>>>9<<4)+14]=t.floor(d/4294967296),u[(v+64>>>9<<4)+15]=d,c.sigBytes=4*u.length,this._process(),this._hash},clone:function(){var c=n.clone.call(this);return c._hash=this._hash.clone(),c}});e.SHA256=n._createHelper(f),e.HmacSHA256=n._createHmacHelper(f)})(Math);(function(){var t=V,e=t.lib.WordArray,n=t.algo,i=n.SHA256,n=n.SHA224=i.extend({_doReset:function(){this._hash=new e.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var r=i._doFinalize.call(this);return r.sigBytes-=4,r}});t.SHA224=i._createHelper(n),t.HmacSHA224=i._createHmacHelper(n)})();(function(){function t(){return n.create.apply(n,arguments)}for(var e=V,i=e.lib.Hasher,s=e.x64,n=s.Word,r=s.WordArray,s=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],h=[],g=0;80>g;g++)h[g]=t();s=s.SHA512=i.extend({_doReset:function(){this._hash=new r.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(p,S){for(var m=this._hash.words,y=m[0],l=m[1],f=m[2],c=m[3],u=m[4],d=m[5],v=m[6],m=m[7],F=y.high,x=y.low,E=l.high,w=l.low,B=f.high,I=f.low,P=c.high,R=c.low,N=u.high,L=u.low,O=d.high,C=d.low,D=v.high,A=v.low,T=m.high,_=m.low,k=F,M=x,z=E,q=w,Y=B,G=I,Dt=P,gt=R,ot=N,ut=L,Mt=O,Vt=C,Ot=D,Lt=A,Wt=T,Kt=_,pt=0;80>pt;pt++){var Et=h[pt];if(16>pt)var lt=Et.high=p[S+2*pt]|0,W=Et.low=p[S+2*pt+1]|0;else{var lt=h[pt-15],W=lt.high,vt=lt.low,lt=(W>>>1|vt<<31)^(W>>>8|vt<<24)^W>>>7,vt=(vt>>>1|W<<31)^(vt>>>8|W<<24)^(vt>>>7|W<<25),Tt=h[pt-2],W=Tt.high,$=Tt.low,Tt=(W>>>19|$<<13)^(W<<3|$>>>29)^W>>>6,$=($>>>19|W<<13)^($<<3|W>>>29)^($>>>6|W<<26),W=h[pt-7],Jt=W.high,xt=h[pt-16],yt=xt.high,xt=xt.low,W=vt+W.low,lt=lt+Jt+(W>>>0<vt>>>0?1:0),W=W+$,lt=lt+Tt+(W>>>0<$>>>0?1:0),W=W+xt,lt=lt+yt+(W>>>0<xt>>>0?1:0);Et.high=lt,Et.low=W}var Jt=ot&Mt^~ot&Ot,xt=ut&Vt^~ut&Lt,Et=k&z^k&Y^z&Y,De=M&q^M&G^q&G,vt=(k>>>28|M<<4)^(k<<30|M>>>2)^(k<<25|M>>>7),Tt=(M>>>28|k<<4)^(M<<30|k>>>2)^(M<<25|k>>>7),$=o[pt],Te=$.high,oe=$.low,$=Kt+((ut>>>14|ot<<18)^(ut>>>18|ot<<14)^(ut<<23|ot>>>9)),yt=Wt+((ot>>>14|ut<<18)^(ot>>>18|ut<<14)^(ot<<23|ut>>>9))+($>>>0<Kt>>>0?1:0),$=$+xt,yt=yt+Jt+($>>>0<xt>>>0?1:0),$=$+oe,yt=yt+Te+($>>>0<oe>>>0?1:0),$=$+W,yt=yt+lt+($>>>0<W>>>0?1:0),W=Tt+De,Et=vt+Et+(W>>>0<Tt>>>0?1:0),Wt=Ot,Kt=Lt,Ot=Mt,Lt=Vt,Mt=ot,Vt=ut,ut=gt+$|0,ot=Dt+yt+(ut>>>0<gt>>>0?1:0)|0,Dt=Y,gt=G,Y=z,G=q,z=k,q=M,M=$+W|0,k=yt+Et+(M>>>0<$>>>0?1:0)|0}x=y.low=x+M,y.high=F+k+(x>>>0<M>>>0?1:0),w=l.low=w+q,l.high=E+z+(w>>>0<q>>>0?1:0),I=f.low=I+G,f.high=B+Y+(I>>>0<G>>>0?1:0),R=c.low=R+gt,c.high=P+Dt+(R>>>0<gt>>>0?1:0),L=u.low=L+ut,u.high=N+ot+(L>>>0<ut>>>0?1:0),C=d.low=C+Vt,d.high=O+Mt+(C>>>0<Vt>>>0?1:0),A=v.low=A+Lt,v.high=D+Ot+(A>>>0<Lt>>>0?1:0),_=m.low=_+Kt,m.high=T+Wt+(_>>>0<Kt>>>0?1:0)},_doFinalize:function(){var p=this._data,S=p.words,y=8*this._nDataBytes,l=8*p.sigBytes;return S[l>>>5]|=128<<24-l%32,S[(l+128>>>10<<5)+30]=Math.floor(y/4294967296),S[(l+128>>>10<<5)+31]=y,p.sigBytes=4*S.length,this._process(),this._hash.toX32()},clone:function(){var p=i.clone.call(this);return p._hash=this._hash.clone(),p},blockSize:32}),e.SHA512=i._createHelper(s),e.HmacSHA512=i._createHmacHelper(s)})();(function(){var t=V,r=t.x64,e=r.Word,i=r.WordArray,r=t.algo,n=r.SHA512,r=r.SHA384=n.extend({_doReset:function(){this._hash=new i.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var s=n._doFinalize.call(this);return s.sigBytes-=16,s}});t.SHA384=n._createHelper(r),t.HmacSHA384=n._createHmacHelper(r)})();(function(){var t=V,p=t.lib,e=p.WordArray,i=p.Hasher,p=t.algo,n=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),r=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),s=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),o=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=e.create([0,1518500249,1859775393,2400959708,2840853838]),g=e.create([1352829926,1548603684,1836072691,2053994217,0]),p=p.RIPEMD160=i.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(S,y){for(var l=0;16>l;l++){var f=y+l,c=S[f];S[f]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}var f=this._hash.words,c=h.words,u=g.words,d=n.words,v=r.words,m=s.words,F=o.words,x,E,w,B,I,P,R,N,L,O;P=x=f[0],R=E=f[1],N=w=f[2],L=B=f[3],O=I=f[4];for(var C,l=0;80>l;l+=1)C=x+S[y+d[l]]|0,C=16>l?C+((E^w^B)+c[0]):32>l?C+((E&w|~E&B)+c[1]):48>l?C+(((E|~w)^B)+c[2]):64>l?C+((E&B|w&~B)+c[3]):C+((E^(w|~B))+c[4]),C|=0,C=C<<m[l]|C>>>32-m[l],C=C+I|0,x=I,I=B,B=w<<10|w>>>22,w=E,E=C,C=P+S[y+v[l]]|0,C=16>l?C+((R^(N|~L))+u[0]):32>l?C+((R&L|N&~L)+u[1]):48>l?C+(((R|~N)^L)+u[2]):64>l?C+((R&N|~R&L)+u[3]):C+((R^N^L)+u[4]),C|=0,C=C<<F[l]|C>>>32-F[l],C=C+O|0,P=O,O=L,L=N<<10|N>>>22,N=R,R=C;C=f[1]+w+L|0,f[1]=f[2]+B+O|0,f[2]=f[3]+I+P|0,f[3]=f[4]+x+R|0,f[4]=f[0]+E+N|0,f[0]=C},_doFinalize:function(){var S=this._data,y=S.words,l=8*this._nDataBytes,f=8*S.sigBytes;for(y[f>>>5]|=128<<24-f%32,y[(f+64>>>9<<4)+14]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,S.sigBytes=4*(y.length+1),this._process(),S=this._hash,y=S.words,l=0;5>l;l++)f=y[l],y[l]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return S},clone:function(){var S=i.clone.call(this);return S._hash=this._hash.clone(),S}});t.RIPEMD160=i._createHelper(p),t.HmacRIPEMD160=i._createHmacHelper(p)})(Math);(function(){var t=V,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(i,n){i=this._hasher=new i.init,typeof n=="string"&&(n=e.parse(n));var r=i.blockSize,s=4*r;n.sigBytes>s&&(n=i.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),h=this._iKey=n.clone(),g=o.words,p=h.words,S=0;S<r;S++)g[S]^=1549556828,p[S]^=909522486;o.sigBytes=h.sigBytes=s,this.reset()},reset:function(){var i=this._hasher;i.reset(),i.update(this._iKey)},update:function(i){return this._hasher.update(i),this},finalize:function(i){var n=this._hasher;return i=n.finalize(i),n.reset(),n.finalize(this._oKey.clone().concat(i))}})})();(function(){var t=V,n=t.lib,e=n.Base,i=n.WordArray,n=t.algo,r=n.HMAC,s=n.PBKDF2=e.extend({cfg:e.extend({keySize:4,hasher:n.SHA1,iterations:1}),init:function(o){this.cfg=this.cfg.extend(o)},compute:function(o,h){for(var c=this.cfg,g=r.create(c.hasher,o),p=i.create(),S=i.create([1]),y=p.words,l=S.words,f=c.keySize,c=c.iterations;y.length<f;){var u=g.update(h).finalize(S);g.reset();for(var d=u.words,v=d.length,m=u,F=1;F<c;F++){m=g.finalize(m),g.reset();for(var x=m.words,E=0;E<v;E++)d[E]^=x[E]}p.concat(u),l[0]++}return p.sigBytes=4*f,p}});t.PBKDF2=function(o,h,g){return s.create(g).compute(o,h)}})();var Ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qt="=";function ce(t){var e,i,n="";for(e=0;e+3<=t.length;e+=3)i=parseInt(t.substring(e,e+3),16),n+=Ht.charAt(i>>6)+Ht.charAt(i&63);if(e+1==t.length?(i=parseInt(t.substring(e,e+1),16),n+=Ht.charAt(i<<2)):e+2==t.length&&(i=parseInt(t.substring(e,e+2),16),n+=Ht.charAt(i>>2)+Ht.charAt((i&3)<<4)),Qt)for(;(n.length&3)>0;)n+=Qt;return n}function te(t){var e="",i,n=0,r,s;for(i=0;i<t.length&&t.charAt(i)!=Qt;++i)s=Ht.indexOf(t.charAt(i)),!(s<0)&&(n==0?(e+=Ft(s>>2),r=s&3,n=1):n==1?(e+=Ft(r<<2|s>>4),r=s&15,n=2):n==2?(e+=Ft(r),e+=Ft(s>>2),r=s&3,n=3):(e+=Ft(r<<2|s>>4),e+=Ft(s&15),n=0));return n==1&&(e+=Ft(r<<2)),e}var wt,Ie=244837814094590,he=(Ie&16777215)==15715070;function b(t,e,i){t!=null&&(typeof t=="number"?this.fromNumber(t,e,i):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}function U(){return new b(null)}function Pe(t,e,i,n,r,s){for(;--s>=0;){var o=e*this[t++]+i[n]+r;r=Math.floor(o/67108864),i[n++]=o&67108863}return r}function Be(t,e,i,n,r,s){for(var o=e&32767,h=e>>15;--s>=0;){var g=this[t]&32767,p=this[t++]>>15,S=h*g+p*o;g=o*g+((S&32767)<<15)+i[n]+(r&1073741823),r=(g>>>30)+(S>>>15)+h*p+(r>>>30),i[n++]=g&1073741823}return r}function He(t,e,i,n,r,s){for(var o=e&16383,h=e>>14;--s>=0;){var g=this[t]&16383,p=this[t++]>>14,S=h*g+p*o;g=o*g+((S&16383)<<14)+i[n]+r,r=(g>>28)+(S>>14)+h*p,i[n++]=g&268435455}return r}he&&navigator.appName=="Microsoft Internet Explorer"?(b.prototype.am=Be,wt=30):he&&navigator.appName!="Netscape"?(b.prototype.am=Pe,wt=26):(b.prototype.am=He,wt=28);b.prototype.DB=wt;b.prototype.DM=(1<<wt)-1;b.prototype.DV=1<<wt;var ee=52;b.prototype.FV=Math.pow(2,ee);b.prototype.F1=ee-wt;b.prototype.F2=2*wt-ee;var Re="0123456789abcdefghijklmnopqrstuvwxyz",zt=new Array,Nt,dt;Nt="0".charCodeAt(0);for(dt=0;dt<=9;++dt)zt[Nt++]=dt;Nt="a".charCodeAt(0);for(dt=10;dt<36;++dt)zt[Nt++]=dt;Nt="A".charCodeAt(0);for(dt=10;dt<36;++dt)zt[Nt++]=dt;function Ft(t){return Re.charAt(t)}function de(t,e){var i=zt[t.charCodeAt(e)];return i==null?-1:i}function Ne(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function je(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function bt(t){var e=U();return e.fromInt(t),e}function Ve(t,e){var i;if(e==16)i=4;else if(e==8)i=3;else if(e==256)i=8;else if(e==2)i=1;else if(e==32)i=5;else if(e==4)i=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,r=!1,s=0;--n>=0;){var o=i==8?t[n]&255:de(t,n);if(o<0){t.charAt(n)=="-"&&(r=!0);continue}r=!1,s==0?this[this.t++]=o:s+i>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,s+=i,s>=this.DB&&(s-=this.DB)}i==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),r&&b.ZERO.subTo(this,this)}function Le(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function Ke(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var i=(1<<e)-1,n,r=!1,s="",o=this.t,h=this.DB-o*this.DB%e;if(o-- >0)for(h<this.DB&&(n=this[o]>>h)>0&&(r=!0,s=Ft(n));o>=0;)h<e?(n=(this[o]&(1<<h)-1)<<e-h,n|=this[--o]>>(h+=this.DB-e)):(n=this[o]>>(h-=e)&i,h<=0&&(h+=this.DB,--o)),n>0&&(r=!0),r&&(s+=Ft(n));return r?s:"0"}function ke(){var t=U();return b.ZERO.subTo(this,t),t}function Me(){return this.s<0?this.negate():this}function Oe(t){var e=this.s-t.s;if(e!=0)return e;var i=this.t;if(e=i-t.t,e!=0)return this.s<0?-e:e;for(;--i>=0;)if((e=this[i]-t[i])!=0)return e;return 0}function Gt(t){var e=1,i;return(i=t>>>16)!=0&&(t=i,e+=16),(i=t>>8)!=0&&(t=i,e+=8),(i=t>>4)!=0&&(t=i,e+=4),(i=t>>2)!=0&&(t=i,e+=2),(i=t>>1)!=0&&(t=i,e+=1),e}function _e(){return this.t<=0?0:this.DB*(this.t-1)+Gt(this[this.t-1]^this.s&this.DM)}function qe(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function Ue(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function ze(t,e){var i=t%this.DB,n=this.DB-i,r=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<i&this.DM,h;for(h=this.t-1;h>=0;--h)e[h+s+1]=this[h]>>n|o,o=(this[h]&r)<<i;for(h=s-1;h>=0;--h)e[h]=0;e[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function Ge(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t){e.t=0;return}var n=t%this.DB,r=this.DB-n,s=(1<<n)-1;e[0]=this[i]>>n;for(var o=i+1;o<this.t;++o)e[o-i-1]|=(this[o]&s)<<r,e[o-i]=this[o]>>n;n>0&&(e[this.t-i-1]|=(this.s&s)<<r),e.t=this.t-i,e.clamp()}function We(t,e){for(var i=0,n=0,r=Math.min(t.t,this.t);i<r;)n+=this[i]-t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n-=t[i],e[i++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[i++]=this.DV+n:n>0&&(e[i++]=n),e.t=i,e.clamp()}function Je(t,e){var i=this.abs(),n=t.abs(),r=i.t;for(e.t=r+n.t;--r>=0;)e[r]=0;for(r=0;r<n.t;++r)e[r+i.t]=i.am(0,n[r],e,r,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&b.ZERO.subTo(e,e)}function Xe(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var n=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,n,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function $e(t,e,i){var n=t.abs();if(!(n.t<=0)){var r=this.abs();if(r.t<n.t){e!=null&&e.fromInt(0),i!=null&&this.copyTo(i);return}i==null&&(i=U());var s=U(),o=this.s,h=t.s,g=this.DB-Gt(n[n.t-1]);g>0?(n.lShiftTo(g,s),r.lShiftTo(g,i)):(n.copyTo(s),r.copyTo(i));var p=s.t,S=s[p-1];if(S!=0){var y=S*(1<<this.F1)+(p>1?s[p-2]>>this.F2:0),l=this.FV/y,f=(1<<this.F1)/y,c=1<<this.F2,u=i.t,d=u-p,v=e==null?U():e;for(s.dlShiftTo(d,v),i.compareTo(v)>=0&&(i[i.t++]=1,i.subTo(v,i)),b.ONE.dlShiftTo(p,v),v.subTo(s,s);s.t<p;)s[s.t++]=0;for(;--d>=0;){var m=i[--u]==S?this.DM:Math.floor(i[u]*l+(i[u-1]+c)*f);if((i[u]+=s.am(0,m,i,d,0,p))<m)for(s.dlShiftTo(d,v),i.subTo(v,i);i[u]<--m;)i.subTo(v,i)}e!=null&&(i.drShiftTo(p,e),o!=h&&b.ZERO.subTo(e,e)),i.t=p,i.clamp(),g>0&&i.rShiftTo(g,i),o<0&&b.ZERO.subTo(i,i)}}}function Ze(t){var e=U();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(b.ZERO)>0&&t.subTo(e,e),e}function It(t){this.m=t}function Qe(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Ye(t){return t}function ti(t){t.divRemTo(this.m,null,t)}function ei(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function ii(t,e){t.squareTo(e),this.reduce(e)}It.prototype.convert=Qe;It.prototype.revert=Ye;It.prototype.reduce=ti;It.prototype.mulTo=ei;It.prototype.sqrTo=ii;function ni(){if(this.t<1)return 0;var t=this[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Pt(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function ri(t){var e=U();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(b.ZERO)>0&&this.m.subTo(e,e),e}function si(t){var e=U();return t.copyTo(e),this.reduce(e),e}function ai(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=t[e]&32767,n=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,n,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function oi(t,e){t.squareTo(e),this.reduce(e)}function hi(t,e,i){t.multiplyTo(e,i),this.reduce(i)}Pt.prototype.convert=ri;Pt.prototype.revert=si;Pt.prototype.reduce=ai;Pt.prototype.mulTo=hi;Pt.prototype.sqrTo=oi;function ui(){return(this.t>0?this[0]&1:this.s)==0}function fi(t,e){if(t>4294967295||t<1)return b.ONE;var i=U(),n=U(),r=e.convert(this),s=Gt(t)-1;for(r.copyTo(i);--s>=0;)if(e.sqrTo(i,n),(t&1<<s)>0)e.mulTo(n,r,i);else{var o=i;i=n,n=o}return e.revert(i)}function li(t,e){var i;return t<256||e.isEven()?i=new It(e):i=new Pt(e),this.exp(t,i)}b.prototype.copyTo=Ne;b.prototype.fromInt=je;b.prototype.fromString=Ve;b.prototype.clamp=Le;b.prototype.dlShiftTo=qe;b.prototype.drShiftTo=Ue;b.prototype.lShiftTo=ze;b.prototype.rShiftTo=Ge;b.prototype.subTo=We;b.prototype.multiplyTo=Je;b.prototype.squareTo=Xe;b.prototype.divRemTo=$e;b.prototype.invDigit=ni;b.prototype.isEven=ui;b.prototype.exp=fi;b.prototype.toString=Ke;b.prototype.negate=ke;b.prototype.abs=Me;b.prototype.compareTo=Oe;b.prototype.bitLength=_e;b.prototype.mod=Ze;b.prototype.modPowInt=li;b.ZERO=bt(0);b.ONE=bt(1);function ci(){var t=U();return this.copyTo(t),t}function di(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function gi(){return this.t==0?this.s:this[0]<<24>>24}function pi(){return this.t==0?this.s:this[0]<<16>>16}function vi(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function yi(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Si(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),n=bt(i),r=U(),s=U(),o="";for(this.divRemTo(n,r,s);r.signum()>0;)o=(i+s.intValue()).toString(t).substr(1)+o,r.divRemTo(n,r,s);return s.intValue().toString(t)+o}function mi(t,e){this.fromInt(0),e==null&&(e=10);for(var i=this.chunkSize(e),n=Math.pow(e,i),r=!1,s=0,o=0,h=0;h<t.length;++h){var g=de(t,h);if(g<0){t.charAt(h)=="-"&&this.signum()==0&&(r=!0);continue}o=e*o+g,++s>=i&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),r&&b.ZERO.subTo(this,this)}function Fi(t,e,i){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(b.ONE.shiftLeft(t-1),ie,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(b.ONE.shiftLeft(t-1),this);else{var n=new Array,r=t&7;n.length=(t>>3)+1,e.nextBytes(n),r>0?n[0]&=(1<<r)-1:n[0]=0,this.fromString(n,256)}}function xi(){var t=this.t,e=new Array;e[0]=this.s;var i=this.DB-t*this.DB%8,n,r=0;if(t-- >0)for(i<this.DB&&(n=this[t]>>i)!=(this.s&this.DM)>>i&&(e[r++]=n|this.s<<this.DB-i);t>=0;)i<8?(n=(this[t]&(1<<i)-1)<<8-i,n|=this[--t]>>(i+=this.DB-8)):(n=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),(n&128)!=0&&(n|=-256),r==0&&(this.s&128)!=(n&128)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e}function Ei(t){return this.compareTo(t)==0}function bi(t){return this.compareTo(t)<0?this:t}function wi(t){return this.compareTo(t)>0?this:t}function Ai(t,e,i){var n,r,s=Math.min(t.t,this.t);for(n=0;n<s;++n)i[n]=e(this[n],t[n]);if(t.t<this.t){for(r=t.s&this.DM,n=s;n<this.t;++n)i[n]=e(this[n],r);i.t=this.t}else{for(r=this.s&this.DM,n=s;n<t.t;++n)i[n]=e(r,t[n]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function Ci(t,e){return t&e}function Di(t){var e=U();return this.bitwiseTo(t,Ci,e),e}function ie(t,e){return t|e}function Ti(t){var e=U();return this.bitwiseTo(t,ie,e),e}function ge(t,e){return t^e}function Ii(t){var e=U();return this.bitwiseTo(t,ge,e),e}function pe(t,e){return t&~e}function Pi(t){var e=U();return this.bitwiseTo(t,pe,e),e}function Bi(){for(var t=U(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function Hi(t){var e=U();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Ri(t){var e=U();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Ni(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function ji(){for(var t=0;t<this.t;++t)if(this[t]!=0)return t*this.DB+Ni(this[t]);return this.s<0?this.t*this.DB:-1}function Vi(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Li(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=Vi(this[i]^e);return t}function Ki(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this[e]&1<<t%this.DB)!=0}function ki(t,e){var i=b.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}function Mi(t){return this.changeBit(t,ie)}function Oi(t){return this.changeBit(t,pe)}function _i(t){return this.changeBit(t,ge)}function qi(t,e){for(var i=0,n=0,r=Math.min(t.t,this.t);i<r;)n+=this[i]+t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n+=t[i],e[i++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[i++]=n:n<-1&&(e[i++]=this.DV+n),e.t=i,e.clamp()}function Ui(t){var e=U();return this.addTo(t,e),e}function zi(t){var e=U();return this.subTo(t,e),e}function Gi(t){var e=U();return this.multiplyTo(t,e),e}function Wi(){var t=U();return this.squareTo(t),t}function Ji(t){var e=U();return this.divRemTo(t,e,null),e}function Xi(t){var e=U();return this.divRemTo(t,null,e),e}function $i(t){var e=U(),i=U();return this.divRemTo(t,e,i),new Array(e,i)}function Zi(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Qi(t,e){if(t!=0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function kt(){}function ve(t){return t}function Yi(t,e,i){t.multiplyTo(e,i)}function tn(t,e){t.squareTo(e)}kt.prototype.convert=ve;kt.prototype.revert=ve;kt.prototype.mulTo=Yi;kt.prototype.sqrTo=tn;function en(t){return this.exp(t,new kt)}function nn(t,e,i){var n=Math.min(this.t+t.t,e);for(i.s=0,i.t=n;n>0;)i[--n]=0;var r;for(r=i.t-this.t;n<r;++n)i[n+this.t]=this.am(0,t[n],i,n,0,this.t);for(r=Math.min(t.t,e);n<r;++n)this.am(0,t[n],i,n,0,e-n);i.clamp()}function rn(t,e,i){--e;var n=i.t=this.t+t.t-e;for(i.s=0;--n>=0;)i[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)i[this.t+n-e]=this.am(e-n,t[n],i,0,0,this.t+n-e);i.clamp(),i.drShiftTo(1,i)}function jt(t){this.r2=U(),this.q3=U(),b.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function sn(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=U();return t.copyTo(e),this.reduce(e),e}function an(t){return t}function on(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function hn(t,e){t.squareTo(e),this.reduce(e)}function un(t,e,i){t.multiplyTo(e,i),this.reduce(i)}jt.prototype.convert=sn;jt.prototype.revert=an;jt.prototype.reduce=on;jt.prototype.mulTo=un;jt.prototype.sqrTo=hn;function fn(t,e){var i=t.bitLength(),n,r=bt(1),s;if(i<=0)return r;i<18?n=1:i<48?n=3:i<144?n=4:i<768?n=5:n=6,i<8?s=new It(e):e.isEven()?s=new jt(e):s=new Pt(e);var o=new Array,h=3,g=n-1,p=(1<<n)-1;if(o[1]=s.convert(this),n>1){var S=U();for(s.sqrTo(o[1],S);h<=p;)o[h]=U(),s.mulTo(S,o[h-2],o[h]),h+=2}var y=t.t-1,l,f=!0,c=U(),u;for(i=Gt(t[y])-1;y>=0;){for(i>=g?l=t[y]>>i-g&p:(l=(t[y]&(1<<i+1)-1)<<g-i,y>0&&(l|=t[y-1]>>this.DB+i-g)),h=n;(l&1)==0;)l>>=1,--h;if((i-=h)<0&&(i+=this.DB,--y),f)o[l].copyTo(r),f=!1;else{for(;h>1;)s.sqrTo(r,c),s.sqrTo(c,r),h-=2;h>0?s.sqrTo(r,c):(u=r,r=c,c=u),s.mulTo(c,o[l],r)}for(;y>=0&&(t[y]&1<<i)==0;)s.sqrTo(r,c),u=r,r=c,c=u,--i<0&&(i=this.DB-1,--y)}return s.revert(r)}function ln(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var n=e;e=i,i=n}var r=e.getLowestSetBit(),s=i.getLowestSetBit();if(s<0)return e;for(r<s&&(s=r),s>0&&(e.rShiftTo(s,e),i.rShiftTo(s,i));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=i.getLowestSetBit())>0&&i.rShiftTo(r,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return s>0&&i.lShiftTo(s,i),i}function cn(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(e==0)i=this[0]%t;else for(var n=this.t-1;n>=0;--n)i=(e*i+this[n])%t;return i}function dn(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return b.ZERO;for(var i=t.clone(),n=this.clone(),r=bt(1),s=bt(0),o=bt(0),h=bt(1);i.signum()!=0;){for(;i.isEven();)i.rShiftTo(1,i),e?((!r.isEven()||!s.isEven())&&(r.addTo(this,r),s.subTo(t,s)),r.rShiftTo(1,r)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!h.isEven())&&(o.addTo(this,o),h.subTo(t,h)),o.rShiftTo(1,o)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);i.compareTo(n)>=0?(i.subTo(n,i),e&&r.subTo(o,r),s.subTo(h,s)):(n.subTo(i,n),e&&o.subTo(r,o),h.subTo(s,h))}if(n.compareTo(b.ONE)!=0)return b.ZERO;if(h.compareTo(t)>=0)return h.subtract(t);if(h.signum()<0)h.addTo(t,h);else return h;return h.signum()<0?h.add(t):h}var st=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],gn=(1<<26)/st[st.length-1];function pn(t){var e,i=this.abs();if(i.t==1&&i[0]<=st[st.length-1]){for(e=0;e<st.length;++e)if(i[0]==st[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<st.length;){for(var n=st[e],r=e+1;r<st.length&&n<gn;)n*=st[r++];for(n=i.modInt(n);e<r;)if(n%st[e++]==0)return!1}return i.millerRabin(t)}function vn(t){var e=this.subtract(b.ONE),i=e.getLowestSetBit();if(i<=0)return!1;var n=e.shiftRight(i);t=t+1>>1,t>st.length&&(t=st.length);for(var r=U(),s=0;s<t;++s){r.fromInt(st[Math.floor(Math.random()*st.length)]);var o=r.modPow(n,this);if(o.compareTo(b.ONE)!=0&&o.compareTo(e)!=0){for(var h=1;h++<i&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(b.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}b.prototype.chunkSize=vi;b.prototype.toRadix=Si;b.prototype.fromRadix=mi;b.prototype.fromNumber=Fi;b.prototype.bitwiseTo=Ai;b.prototype.changeBit=ki;b.prototype.addTo=qi;b.prototype.dMultiply=Zi;b.prototype.dAddOffset=Qi;b.prototype.multiplyLowerTo=nn;b.prototype.multiplyUpperTo=rn;b.prototype.modInt=cn;b.prototype.millerRabin=vn;b.prototype.clone=ci;b.prototype.intValue=di;b.prototype.byteValue=gi;b.prototype.shortValue=pi;b.prototype.signum=yi;b.prototype.toByteArray=xi;b.prototype.equals=Ei;b.prototype.min=bi;b.prototype.max=wi;b.prototype.and=Di;b.prototype.or=Ti;b.prototype.xor=Ii;b.prototype.andNot=Pi;b.prototype.not=Bi;b.prototype.shiftLeft=Hi;b.prototype.shiftRight=Ri;b.prototype.getLowestSetBit=ji;b.prototype.bitCount=Li;b.prototype.testBit=Ki;b.prototype.setBit=Mi;b.prototype.clearBit=Oi;b.prototype.flipBit=_i;b.prototype.add=Ui;b.prototype.subtract=zi;b.prototype.multiply=Gi;b.prototype.divide=Ji;b.prototype.remainder=Xi;b.prototype.divideAndRemainder=$i;b.prototype.modPow=fn;b.prototype.modInverse=dn;b.prototype.pow=en;b.prototype.gcd=ln;b.prototype.isProbablePrime=pn;b.prototype.square=Wi;function ne(){this.i=0,this.j=0,this.S=new Array}function yn(t){var e,i,n;for(e=0;e<256;++e)this.S[e]=e;for(i=0,e=0;e<256;++e)i=i+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[i],this.S[i]=n;this.i=0,this.j=0}function Sn(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}ne.prototype.init=yn;ne.prototype.next=Sn;function mn(){return new ne}var Yt=256;var _t,ft,it;function Fn(t){ft[it++]^=t&255,ft[it++]^=t>>8&255,ft[it++]^=t>>16&255,ft[it++]^=t>>24&255,it>=Yt&&(it-=Yt)}function ye(){Fn(new Date().getTime())}if(ft==null){if(ft=new Array,it=0,window!==void 0&&(window.crypto!==void 0||window.msCrypto!==void 0)){if(Xt=window.crypto||window.msCrypto,Xt.getRandomValues)for($t=new Uint8Array(32),Xt.getRandomValues($t),ct=0;ct<32;++ct)ft[it++]=$t[ct];else if(navigator.appName=="Netscape"&&navigator.appVersion<"5")for(Zt=window.crypto.random(32),ct=0;ct<Zt.length;++ct)ft[it++]=Zt.charCodeAt(ct)&255}for(;it<Yt;)ct=Math.floor(65536*Math.random()),ft[it++]=ct>>>8,ft[it++]=ct&255;it=0,ye()}var ct,Xt,$t,Zt;function xn(){if(_t==null){for(ye(),_t=mn(),_t.init(ft),it=0;it<ft.length;++it)ft[it]=0;it=0}return _t.next()}function En(t){var e;for(e=0;e<t.length;++e)t[e]=xn()}function Bt(){}Bt.prototype.nextBytes=En;function nt(t,e){return new b(t,e)}function bn(t,e){if(e<t.length+11)throw"Message too long for RSA";for(var i=new Array,n=t.length-1;n>=0&&e>0;){var r=t.charCodeAt(n--);r<128?i[--e]=r:r>127&&r<2048?(i[--e]=r&63|128,i[--e]=r>>6|192):(i[--e]=r&63|128,i[--e]=r>>6&63|128,i[--e]=r>>12|224)}i[--e]=0;for(var s=new Bt,o=new Array;e>2;){for(o[0]=0;o[0]==0;)s.nextBytes(o);i[--e]=o[0]}return i[--e]=2,i[--e]=0,new b(i)}function ue(t,e,i){for(var n="",r=0;n.length<e;)n+=i(String.fromCharCode.apply(String,t.concat([(r&4278190080)>>24,(r&16711680)>>16,(r&65280)>>8,r&255]))),r+=1;return n}function wn(t,e,i,n){var r=a.crypto.MessageDigest,s=a.crypto.Util,o=null;if(i||(i="sha1"),typeof i=="string"&&(o=r.getCanonicalAlgName(i),n=r.getHashLength(o),i=function(u){return At(s.hashHex(mt(u),o))}),t.length+2*n+2>e)throw"Message too long for RSA";var h="",g;for(g=0;g<e-t.length-2*n-2;g+=1)h+="\0";var p=i("")+h+""+t,S=new Array(n);new Bt().nextBytes(S);var y=ue(S,p.length,i),l=[];for(g=0;g<p.length;g+=1)l[g]=p.charCodeAt(g)^y.charCodeAt(g);var f=ue(l,S.length,i),c=[0];for(g=0;g<S.length;g+=1)c[g+1]=S[g]^f.charCodeAt(g);return new b(c.concat(l))}function K(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function An(t,e){if(this.isPublic=!0,this.isPrivate=!1,typeof t!="string")this.n=t,this.e=e;else if(t!=null&&e!=null&&t.length>0&&e.length>0)this.n=nt(t,16),this.e=parseInt(e,16);else throw"Invalid RSA public key"}function Cn(t){return t.modPowInt(this.e,this.n)}function Dn(t){var e=bn(t,this.n.bitLength()+7>>3);if(e==null)return null;var i=this.doPublic(e);if(i==null)return null;var n=i.toString(16);return(n.length&1)==0?n:"0"+n}function Tn(t,e,i){var n=wn(t,this.n.bitLength()+7>>3,e,i);if(n==null)return null;var r=this.doPublic(n);if(r==null)return null;var s=r.toString(16);return(s.length&1)==0?s:"0"+s}K.prototype.doPublic=Cn;K.prototype.setPublic=An;K.prototype.encrypt=Dn;K.prototype.encryptOAEP=Tn;K.prototype.type="RSA";function In(t,e){for(var i=t.toByteArray(),n=0;n<i.length&&i[n]==0;)++n;if(i.length-n!=e-1||i[n]!=2)return null;for(++n;i[n]!=0;)if(++n>=i.length)return null;for(var r="";++n<i.length;){var s=i[n]&255;s<128?r+=String.fromCharCode(s):s>191&&s<224?(r+=String.fromCharCode((s&31)<<6|i[n+1]&63),++n):(r+=String.fromCharCode((s&15)<<12|(i[n+1]&63)<<6|i[n+2]&63),n+=2)}return r}function fe(t,e,i){for(var n="",r=0;n.length<e;)n+=i(t+String.fromCharCode.apply(String,[(r&4278190080)>>24,(r&16711680)>>16,(r&65280)>>8,r&255])),r+=1;return n}function Pn(t,e,i,n){var r=a.crypto.MessageDigest,s=a.crypto.Util,o=null;i||(i="sha1"),typeof i=="string"&&(o=r.getCanonicalAlgName(i),n=r.getHashLength(o),i=function(d){return At(s.hashHex(mt(d),o))}),t=t.toByteArray();var y;for(y=0;y<t.length;y+=1)t[y]&=255;for(;t.length<e;)t.unshift(0);if(t=String.fromCharCode.apply(String,t),t.length<2*n+2)throw"Cipher too short";var h=t.substr(1,n),g=t.substr(n+1),p=fe(g,n,i),S=[],y;for(y=0;y<h.length;y+=1)S[y]=h.charCodeAt(y)^p.charCodeAt(y);var l=fe(String.fromCharCode.apply(String,S),t.length-n,i),f=[];for(y=0;y<g.length;y+=1)f[y]=g.charCodeAt(y)^l.charCodeAt(y);if(f=String.fromCharCode.apply(String,f),f.substr(0,n)!==i(""))throw"Hash mismatch";f=f.substr(n);var c=f.indexOf(""),u=c!=-1?f.substr(0,c).lastIndexOf("\0"):-1;if(u+1!=c)throw"Malformed data";return f.substr(c+1)}function Bn(t,e,i){if(this.isPrivate=!0,typeof t!="string")this.n=t,this.e=e,this.d=i;else if(t!=null&&e!=null&&t.length>0&&e.length>0)this.n=nt(t,16),this.e=parseInt(e,16),this.d=nt(i,16);else throw"Invalid RSA private key"}function Hn(t,e,i,n,r,s,o,h){if(this.isPrivate=!0,this.isPublic=!1,t==null)throw"RSASetPrivateEx N == null";if(e==null)throw"RSASetPrivateEx E == null";if(t.length==0)throw"RSASetPrivateEx N.length == 0";if(e.length==0)throw"RSASetPrivateEx E.length == 0";if(t!=null&&e!=null&&t.length>0&&e.length>0)this.n=nt(t,16),this.e=parseInt(e,16),this.d=nt(i,16),this.p=nt(n,16),this.q=nt(r,16),this.dmp1=nt(s,16),this.dmq1=nt(o,16),this.coeff=nt(h,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function Rn(t,e){var i=new Bt,n=t>>1;this.e=parseInt(e,16);for(var r=new b(e,16);;){for(;this.p=new b(t-n,1,i),!(this.p.subtract(b.ONE).gcd(r).compareTo(b.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new b(n,1,i),!(this.q.subtract(b.ONE).gcd(r).compareTo(b.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(b.ONE),h=this.q.subtract(b.ONE),g=o.multiply(h);if(g.gcd(r).compareTo(b.ONE)==0){this.n=this.p.multiply(this.q),this.d=r.modInverse(g),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0}function Nn(t){if(this.p==null||this.q==null)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}function jn(t){var e=nt(t,16),i=this.doPrivate(e);return i==null?null:In(i,this.n.bitLength()+7>>3)}function Vn(t,e,i){var n=nt(t,16),r=this.doPrivate(n);return r==null?null:Pn(r,this.n.bitLength()+7>>3,e,i)}K.prototype.doPrivate=Nn;K.prototype.setPrivate=Bn;K.prototype.setPrivateEx=Hn;K.prototype.generate=Rn;K.prototype.decrypt=jn;K.prototype.decryptOAEP=Vn;function rt(t,e){this.x=e,this.q=t}function Ln(t){return t==this?!0:this.q.equals(t.q)&&this.x.equals(t.x)}function Kn(){return this.x}function kn(){return new rt(this.q,this.x.negate().mod(this.q))}function Mn(t){return new rt(this.q,this.x.add(t.toBigInteger()).mod(this.q))}function On(t){return new rt(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}function _n(t){return new rt(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}function qn(){return new rt(this.q,this.x.square().mod(this.q))}function Un(t){return new rt(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}rt.prototype.equals=Ln;rt.prototype.toBigInteger=Kn;rt.prototype.negate=kn;rt.prototype.add=Mn;rt.prototype.subtract=On;rt.prototype.multiply=_n;rt.prototype.square=qn;rt.prototype.divide=Un;function J(t,e,i,n){this.curve=t,this.x=e,this.y=i,n==null?this.z=b.ONE:this.z=n,this.zinv=null}function zn(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Gn(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Wn(t){if(t==this)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return this.isInfinity();var e,i;return e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),e.equals(b.ZERO)?(i=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q),i.equals(b.ZERO)):!1}function Jn(){return this.x==null&&this.y==null?!0:this.z.equals(b.ZERO)&&!this.y.toBigInteger().equals(b.ZERO)}function Xn(){return new J(this.curve,this.x,this.y.negate(),this.z)}function $n(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),i=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(b.ZERO.equals(i))return b.ZERO.equals(e)?this.twice():this.curve.getInfinity();var n=new b("3"),r=this.x.toBigInteger(),s=this.y.toBigInteger(),o=t.x.toBigInteger(),h=t.y.toBigInteger(),g=i.square(),p=g.multiply(i),S=r.multiply(g),y=e.square().multiply(this.z),l=y.subtract(S.shiftLeft(1)).multiply(t.z).subtract(p).multiply(i).mod(this.curve.q),f=S.multiply(n).multiply(e).subtract(s.multiply(p)).subtract(y.multiply(e)).multiply(t.z).add(e.multiply(p)).mod(this.curve.q),c=p.multiply(this.z).multiply(t.z).mod(this.curve.q);return new J(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(f),c)}function Zn(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var t=new b("3"),e=this.x.toBigInteger(),i=this.y.toBigInteger(),n=i.multiply(this.z),r=n.multiply(i).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t);b.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s))),o=o.mod(this.curve.q);var h=o.square().subtract(e.shiftLeft(3).multiply(r)).shiftLeft(1).multiply(n).mod(this.curve.q),g=o.multiply(t).multiply(e).subtract(r.shiftLeft(1)).shiftLeft(2).multiply(r).subtract(o.square().multiply(o)).mod(this.curve.q),p=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new J(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(g),p)}function Qn(t){if(this.isInfinity())return this;if(t.signum()==0)return this.curve.getInfinity();var e=t,i=e.multiply(new b("3")),n=this.negate(),r=this,s=this.curve.q.subtract(t),o=s.multiply(new b("3")),h=new J(this.curve,this.x,this.y),g=h.negate(),p;for(p=i.bitLength()-2;p>0;--p){r=r.twice();var S=i.testBit(p),y=e.testBit(p);S!=y&&(r=r.add(S?this:n))}for(p=o.bitLength()-2;p>0;--p){h=h.twice();var l=o.testBit(p),f=s.testBit(p);l!=f&&(h=h.add(l?h:g))}return r}function Yn(t,e,i){var n;t.bitLength()>i.bitLength()?n=t.bitLength()-1:n=i.bitLength()-1;for(var r=this.curve.getInfinity(),s=this.add(e);n>=0;)r=r.twice(),t.testBit(n)?i.testBit(n)?r=r.add(s):r=r.add(this):i.testBit(n)&&(r=r.add(e)),--n;return r}J.prototype.getX=zn;J.prototype.getY=Gn;J.prototype.equals=Wn;J.prototype.isInfinity=Jn;J.prototype.negate=Xn;J.prototype.add=$n;J.prototype.twice=Zn;J.prototype.multiply=Qn;J.prototype.multiplyTwo=Yn;function Ct(t,e,i){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(i),this.infinity=new J(this,null,null)}function tr(){return this.q}function er(){return this.a}function ir(){return this.b}function nr(t){return t==this?!0:this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)}function rr(){return this.infinity}function sr(t){return new rt(this.q,t)}function ar(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,i=t.substr(2,e),n=t.substr(e+2,e);return new J(this,this.fromBigInteger(new b(i,16)),this.fromBigInteger(new b(n,16)));default:return null}}Ct.prototype.getQ=tr;Ct.prototype.getA=er;Ct.prototype.getB=ir;Ct.prototype.equals=nr;Ct.prototype.getInfinity=rr;Ct.prototype.fromBigInteger=sr;Ct.prototype.decodePointHex=ar;rt.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};J.prototype.getEncoded=function(t){var e=function(s,o){var h=s.toByteArrayUnsigned();if(o<h.length)h=h.slice(h.length-o);else for(;o>h.length;)h.unshift(0);return h},i=this.getX().toBigInteger(),n=this.getY().toBigInteger(),r=e(i,32);return t?n.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(e(n,32))),r};J.decodeFrom=function(t,e){var i=e[0],n=e.length-1,r=e.slice(1,1+n/2),s=e.slice(1+n/2,1+n);r.unshift(0),s.unshift(0);var o=new b(r),h=new b(s);return new J(t,t.fromBigInteger(o),t.fromBigInteger(h))};J.decodeFromHex=function(t,e){var i=e.substr(0,2),n=e.length-2,r=e.substr(2,n/2),s=e.substr(2+n/2,n/2),o=new b(r,16),h=new b(s,16);return new J(t,t.fromBigInteger(o),t.fromBigInteger(h))};J.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),i=t.y.subtract(this.y),n=i.divide(e),r=n.square().subtract(this.x).subtract(t.x),s=n.multiply(this.x.subtract(r)).subtract(this.y);return new J(this.curve,r,s)};J.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var t=this.curve.fromBigInteger(b.valueOf(2)),e=this.curve.fromBigInteger(b.valueOf(3)),i=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),n=i.square().subtract(this.x.multiply(t)),r=i.multiply(this.x.subtract(n)).subtract(this.y);return new J(this.curve,n,r)};J.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(t.signum()==0)return this.curve.getInfinity();var e=t,i=e.multiply(new b("3")),n=this.negate(),r=this,s;for(s=i.bitLength()-2;s>0;--s){r=r.twice();var o=i.testBit(s),h=e.testBit(s);o!=h&&(r=r.add2D(o?this:n))}return r};J.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),i=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),r=this.curve.getQ(),s=e.multiply(e).mod(r),o=t.multiply(t).multiply(t).add(i.multiply(t)).add(n).mod(r);return s.equals(o)};J.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};J.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),i=this.getY().toBigInteger();if(e.compareTo(b.ONE)<0||e.compareTo(t.subtract(b.ONE))>0)throw new Error("x coordinate out of bounds");if(i.compareTo(b.ONE)<0||i.compareTo(t.subtract(b.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Se=function(){var t="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",e='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',i='(?:"'+e+'*")',n=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+t+"|"+i+")","g"),r=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),s={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function o(y,l,f){return l?s[l]:String.fromCharCode(parseInt(f,16))}var h=new String(""),g="\\",p={"{":Object,"[":Array},S=Object.hasOwnProperty;return function(y,l){var f=y.match(n),c,u=f[0],d=!1;u==="{"?c={}:u==="["?c=[]:(c=[],d=!0);for(var v,m=[c],F=1-d,x=f.length;F<x;++F){u=f[F];var E;switch(u.charCodeAt(0)){default:E=m[0],E[v||E.length]=+u,v=void 0;break;case 34:if(u=u.substring(1,u.length-1),u.indexOf(g)!==-1&&(u=u.replace(r,o)),E=m[0],!v)if(E instanceof Array)v=E.length;else{v=u||h;break}E[v]=u,v=void 0;break;case 91:E=m[0],m.unshift(E[v||E.length]=[]),v=void 0;break;case 93:m.shift();break;case 102:E=m[0],E[v||E.length]=!1,v=void 0;break;case 110:E=m[0],E[v||E.length]=null,v=void 0;break;case 116:E=m[0],E[v||E.length]=!0,v=void 0;break;case 123:E=m[0],m.unshift(E[v||E.length]={}),v=void 0;break;case 125:m.shift();break}}if(d){if(m.length!==1)throw new Error;c=c[0]}else if(m.length)throw new Error;if(l){var w=function(B,I){var P=B[I];if(P&&typeof P=="object"){var R=null;for(var N in P)if(S.call(P,N)&&P!==B){var L=w(P,N);L!==void 0?P[N]=L:(R||(R=[]),R.push(N))}if(R)for(var O=R.length;--O>=0;)delete P[R[O]]}return l.call(B,I,P)};c=w({"":c},"")}return c}}();(typeof a=="undefined"||!a)&&(a={});(typeof a.asn1=="undefined"||!a.asn1)&&(a.asn1={});a.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if(e.substr(0,1)!="-")e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var i=e.substr(1),n=i.length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var r="",s=0;s<n;s++)r+="f";var o=new b(r,16),h=o.xor(t).add(b.ONE);e=h.toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return ht(t,e)},this.newObject=function(t){var e=a,i=e.asn1,n=i.DERBoolean,r=i.DERInteger,s=i.DERBitString,o=i.DEROctetString,h=i.DERNull,g=i.DERObjectIdentifier,p=i.DEREnumerated,S=i.DERUTF8String,y=i.DERNumericString,l=i.DERPrintableString,f=i.DERTeletexString,c=i.DERIA5String,u=i.DERUTCTime,d=i.DERGeneralizedTime,v=i.DERSequence,m=i.DERSet,F=i.DERTaggedObject,x=i.ASN1Util.newObject,E=Object.keys(t);if(E.length!=1)throw"key of param shall be only one.";var w=E[0];if(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+w+":")==-1)throw"undefined key: "+w;if(w=="bool")return new n(t[w]);if(w=="int")return new r(t[w]);if(w=="bitstr")return new s(t[w]);if(w=="octstr")return new o(t[w]);if(w=="null")return new h(t[w]);if(w=="oid")return new g(t[w]);if(w=="enum")return new p(t[w]);if(w=="utf8str")return new S(t[w]);if(w=="numstr")return new y(t[w]);if(w=="prnstr")return new l(t[w]);if(w=="telstr")return new f(t[w]);if(w=="ia5str")return new c(t[w]);if(w=="utctime")return new u(t[w]);if(w=="gentime")return new d(t[w]);if(w=="seq"){for(var B=t[w],I=[],P=0;P<B.length;P++){var R=x(B[P]);I.push(R)}return new v({array:I})}if(w=="set"){for(var B=t[w],I=[],P=0;P<B.length;P++){var R=x(B[P]);I.push(R)}return new m({array:I})}if(w=="tag"){var N=t[w];if(Object.prototype.toString.call(N)==="[object Array]"&&N.length==3){var L=x(N[2]);return new F({tag:N[0],explicit:N[1],obj:L})}else{var O={};if(N.explicit!==void 0&&(O.explicit=N.explicit),N.tag!==void 0&&(O.tag=N.tag),N.obj===void 0)throw"obj shall be specified for 'tag'.";return O.obj=x(N.obj),new F(O)}}},this.jsonToASN1HEX=function(t){var e=this.newObject(t);return e.getEncodedHex()}};a.asn1.ASN1Util.oidHexToInt=function(t){for(var r="",e=parseInt(t.substr(0,2),16),i=Math.floor(e/40),n=e%40,r=i+"."+n,s="",o=2;o<t.length;o+=2){var h=parseInt(t.substr(o,2),16),g=("00000000"+h.toString(2)).slice(-8);if(s=s+g.substr(1,7),g.substr(0,1)=="0"){var p=new b(s,2);r=r+"."+p.toString(10),s=""}}return r};a.asn1.ASN1Util.oidIntToHex=function(t){var e=function(h){var g=h.toString(16);return g.length==1&&(g="0"+g),g},i=function(h){var g="",p=new b(h,10),S=p.toString(2),y=7-S.length%7;y==7&&(y=0);for(var l="",f=0;f<y;f++)l+="0";S=l+S;for(var f=0;f<S.length-1;f+=7){var c=S.substr(f,7);f!=S.length-7&&(c="1"+c),g+=e(parseInt(c,2))}return g};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var n="",r=t.split("."),s=parseInt(r[0])*40+parseInt(r[1]);n+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)n+=i(r[o]);return n};a.asn1.ASN1Object=function(){var t=!0,e=null,i="00",n="00",r="";this.getLengthHexFromValue=function(){if(typeof this.hV=="undefined"||this.hV==null)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+r.length+",v="+this.hV;var s=this.hV.length/2,o=s.toString(16);if(o.length%2==1&&(o="0"+o),s<128)return o;var h=o.length/2;if(h>15)throw"ASN.1 length too long to represent by 8x: n = "+s.toString(16);var g=128+h;return g.toString(16)+o},this.getEncodedHex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}};a.asn1.DERAbstractString=function(t){a.asn1.DERAbstractString.superclass.constructor.call(this);var e=null,i=null;this.getString=function(){return this.s},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.s=n,this.hV=Ut(this.s).toLowerCase()},this.setStringHex=function(n){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.getFreshValueHex=function(){return this.hV},typeof t!="undefined"&&(typeof t=="string"?this.setString(t):typeof t.str!="undefined"?this.setString(t.str):typeof t.hex!="undefined"&&this.setStringHex(t.hex))};H.lang.extend(a.asn1.DERAbstractString,a.asn1.ASN1Object);a.asn1.DERAbstractTime=function(t){a.asn1.DERAbstractTime.superclass.constructor.call(this);var e=null,i=null;this.localDateToUTC=function(n){var r=n.getTime()+n.getTimezoneOffset()*6e4,s=new Date(r);return s},this.formatDate=function(n,r,s){var o=this.zeroPadding,h=this.localDateToUTC(n),g=String(h.getFullYear());r=="utc"&&(g=g.substr(2,2));var p=o(String(h.getMonth()+1),2),S=o(String(h.getDate()),2),y=o(String(h.getHours()),2),l=o(String(h.getMinutes()),2),f=o(String(h.getSeconds()),2),c=g+p+S+y+l+f;if(s===!0){var u=h.getMilliseconds();if(u!=0){var d=o(String(u),3);d=d.replace(/[0]+$/,""),c=c+"."+d}}return c+"Z"},this.zeroPadding=function(n,r){return n.length>=r?n:new Array(r-n.length+1).join("0")+n},this.getString=function(){return this.s},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.s=n,this.hV=Rt(n)},this.setByDateValue=function(n,r,s,o,h,g){var p=new Date(Date.UTC(n,r-1,s,o,h,g,0));this.setByDate(p)},this.getFreshValueHex=function(){return this.hV}};H.lang.extend(a.asn1.DERAbstractTime,a.asn1.ASN1Object);a.asn1.DERAbstractStructured=function(t){a.asn1.DERAbstractString.superclass.constructor.call(this);var e=null;this.setByASN1ObjectArray=function(i){this.hTLV=null,this.isModified=!0,this.asn1Array=i},this.appendASN1Object=function(i){this.hTLV=null,this.isModified=!0,this.asn1Array.push(i)},this.asn1Array=new Array,typeof t!="undefined"&&typeof t.array!="undefined"&&(this.asn1Array=t.array)};H.lang.extend(a.asn1.DERAbstractStructured,a.asn1.ASN1Object);a.asn1.DERBoolean=function(){a.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"};H.lang.extend(a.asn1.DERBoolean,a.asn1.ASN1Object);a.asn1.DERInteger=function(t){a.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=a.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var i=new b(String(e),10);this.setByBigInteger(i)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},typeof t!="undefined"&&(typeof t.bigint!="undefined"?this.setByBigInteger(t.bigint):typeof t.int!="undefined"?this.setByInteger(t.int):typeof t=="number"?this.setByInteger(t):typeof t.hex!="undefined"&&this.setValueHex(t.hex))};H.lang.extend(a.asn1.DERInteger,a.asn1.ASN1Object);a.asn1.DERBitString=function(t){if(t!==void 0&&typeof t.obj!="undefined"){var e=a.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}a.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(i){this.hTLV=null,this.isModified=!0,this.hV=i},this.setUnusedBitsAndHexValue=function(i,n){if(i<0||7<i)throw"unused bits shall be from 0 to 7: u = "+i;var r="0"+i;this.hTLV=null,this.isModified=!0,this.hV=r+n},this.setByBinaryString=function(i){i=i.replace(/0+$/,"");var n=8-i.length%8;n==8&&(n=0);for(var r=0;r<=n;r++)i+="0";for(var s="",r=0;r<i.length-1;r+=8){var o=i.substr(r,8),h=parseInt(o,2).toString(16);h.length==1&&(h="0"+h),s+=h}this.hTLV=null,this.isModified=!0,this.hV="0"+n+s},this.setByBooleanArray=function(i){for(var n="",r=0;r<i.length;r++)i[r]==!0?n+="1":n+="0";this.setByBinaryString(n)},this.newFalseArray=function(i){for(var n=new Array(i),r=0;r<i;r++)n[r]=!1;return n},this.getFreshValueHex=function(){return this.hV},typeof t!="undefined"&&(typeof t=="string"&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):typeof t.hex!="undefined"?this.setHexValueIncludingUnusedBits(t.hex):typeof t.bin!="undefined"?this.setByBinaryString(t.bin):typeof t.array!="undefined"&&this.setByBooleanArray(t.array))};H.lang.extend(a.asn1.DERBitString,a.asn1.ASN1Object);a.asn1.DEROctetString=function(t){if(t!==void 0&&typeof t.obj!="undefined"){var e=a.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}a.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"};H.lang.extend(a.asn1.DEROctetString,a.asn1.DERAbstractString);a.asn1.DERNull=function(){a.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"};H.lang.extend(a.asn1.DERNull,a.asn1.ASN1Object);a.asn1.DERObjectIdentifier=function(t){var e=function(n){var r=n.toString(16);return r.length==1&&(r="0"+r),r},i=function(n){var r="",s=new b(n,10),o=s.toString(2),h=7-o.length%7;h==7&&(h=0);for(var g="",p=0;p<h;p++)g+="0";o=g+o;for(var p=0;p<o.length-1;p+=7){var S=o.substr(p,7);p!=o.length-7&&(S="1"+S),r+=e(parseInt(S,2))}return r};a.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(n){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.setValueOidString=function(n){if(!n.match(/^[0-9.]+$/))throw"malformed oid string: "+n;var r="",s=n.split("."),o=parseInt(s[0])*40+parseInt(s[1]);r+=e(o),s.splice(0,2);for(var h=0;h<s.length;h++)r+=i(s[h]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(n){var r=a.asn1.x509.OID.name2oid(n);if(r!=="")this.setValueOidString(r);else throw"DERObjectIdentifier oidName undefined: "+n},this.getFreshValueHex=function(){return this.hV},t!==void 0&&(typeof t=="string"?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):t.oid!==void 0?this.setValueOidString(t.oid):t.hex!==void 0?this.setValueHex(t.hex):t.name!==void 0&&this.setValueName(t.name))};H.lang.extend(a.asn1.DERObjectIdentifier,a.asn1.ASN1Object);a.asn1.DEREnumerated=function(t){a.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=a.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var i=new b(String(e),10);this.setByBigInteger(i)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},typeof t!="undefined"&&(typeof t.int!="undefined"?this.setByInteger(t.int):typeof t=="number"?this.setByInteger(t):typeof t.hex!="undefined"&&this.setValueHex(t.hex))};H.lang.extend(a.asn1.DEREnumerated,a.asn1.ASN1Object);a.asn1.DERUTF8String=function(t){a.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"};H.lang.extend(a.asn1.DERUTF8String,a.asn1.DERAbstractString);a.asn1.DERNumericString=function(t){a.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"};H.lang.extend(a.asn1.DERNumericString,a.asn1.DERAbstractString);a.asn1.DERPrintableString=function(t){a.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"};H.lang.extend(a.asn1.DERPrintableString,a.asn1.DERAbstractString);a.asn1.DERTeletexString=function(t){a.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"};H.lang.extend(a.asn1.DERTeletexString,a.asn1.DERAbstractString);a.asn1.DERIA5String=function(t){a.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"};H.lang.extend(a.asn1.DERIA5String,a.asn1.DERAbstractString);a.asn1.DERUTCTime=function(t){a.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=Rt(this.s)},this.getFreshValueHex=function(){return typeof this.date=="undefined"&&typeof this.s=="undefined"&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=Rt(this.s)),this.hV},t!==void 0&&(t.str!==void 0?this.setString(t.str):typeof t=="string"&&t.match(/^[0-9]{12}Z$/)?this.setString(t):t.hex!==void 0?this.setStringHex(t.hex):t.date!==void 0&&this.setByDate(t.date))};H.lang.extend(a.asn1.DERUTCTime,a.asn1.DERAbstractTime);a.asn1.DERGeneralizedTime=function(t){a.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=Rt(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=Rt(this.s)),this.hV},t!==void 0&&(t.str!==void 0?this.setString(t.str):typeof t=="string"&&t.match(/^[0-9]{14}Z$/)?this.setString(t):t.hex!==void 0?this.setStringHex(t.hex):t.date!==void 0&&this.setByDate(t.date),t.millis===!0&&(this.withMillis=!0))};H.lang.extend(a.asn1.DERGeneralizedTime,a.asn1.DERAbstractTime);a.asn1.DERSequence=function(t){a.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var e="",i=0;i<this.asn1Array.length;i++){var n=this.asn1Array[i];e+=n.getEncodedHex()}return this.hV=e,this.hV}};H.lang.extend(a.asn1.DERSequence,a.asn1.DERAbstractStructured);a.asn1.DERSet=function(t){a.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,i=0;i<this.asn1Array.length;i++){var n=this.asn1Array[i];e.push(n.getEncodedHex())}return this.sortFlag==!0&&e.sort(),this.hV=e.join(""),this.hV},typeof t!="undefined"&&typeof t.sortflag!="undefined"&&t.sortflag==!1&&(this.sortFlag=!1)};H.lang.extend(a.asn1.DERSet,a.asn1.DERAbstractStructured);a.asn1.DERTaggedObject=function(t){a.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,i,n){this.hT=i,this.isExplicit=e,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,i),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},typeof t!="undefined"&&(typeof t.tag!="undefined"&&(this.hT=t.tag),typeof t.explicit!="undefined"&&(this.isExplicit=t.explicit),typeof t.obj!="undefined"&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))};H.lang.extend(a.asn1.DERTaggedObject,a.asn1.ASN1Object);var j=new function(){};j.getLblen=function(t,e){if(t.substr(e+2,1)!="8")return 1;var i=parseInt(t.substr(e+3,1));return i==0?-1:0<i&&i<10?i+1:-2};j.getL=function(t,e){var i=j.getLblen(t,e);return i<1?"":t.substr(e+2,i*2)};j.getVblen=function(t,e){var i,n;return i=j.getL(t,e),i==""?-1:(i.substr(0,1)==="8"?n=new b(i.substr(2),16):n=new b(i,16),n.intValue())};j.getVidx=function(t,e){var i=j.getLblen(t,e);return i<0?i:e+(i+1)*2};j.getV=function(t,e){var i=j.getVidx(t,e),n=j.getVblen(t,e);return t.substr(i,n*2)};j.getTLV=function(t,e){return t.substr(e,2)+j.getL(t,e)+j.getV(t,e)};j.getNextSiblingIdx=function(t,e){var i=j.getVidx(t,e),n=j.getVblen(t,e);return i+n*2};j.getChildIdx=function(t,e){var i=j,n=new Array,r=i.getVidx(t,e);t.substr(e,2)=="03"?n.push(r+2):n.push(r);for(var s=i.getVblen(t,e),o=r,h=0;;){var g=i.getNextSiblingIdx(t,o);if(g==null||g-r>=s*2||h>=200)break;n.push(g),o=g,h++}return n};j.getNthChildIdx=function(t,e,i){var n=j.getChildIdx(t,e);return n[i]};j.getIdxbyList=function(t,e,i,n){var r=j,s,o;if(i.length==0){if(n!==void 0&&t.substr(e,2)!==n)throw"checking tag doesn't match: "+t.substr(e,2)+"!="+n;return e}return s=i.shift(),o=r.getChildIdx(t,e),r.getIdxbyList(t,o[s],i,n)};j.getTLVbyList=function(t,e,i,n){var r=j,s=r.getIdxbyList(t,e,i);if(s===void 0)throw"can't find nthList object";if(n!==void 0&&t.substr(s,2)!=n)throw"checking tag doesn't match: "+t.substr(s,2)+"!="+n;return r.getTLV(t,s)};j.getVbyList=function(t,e,i,n,r){var s=j,o,h;if(o=s.getIdxbyList(t,e,i,n),o===void 0)throw"can't find nthList object";return h=s.getV(t,o),r===!0&&(h=h.substr(2)),h};j.hextooidstr=function(t){var e=function(y,l){return y.length>=l?y:new Array(l-y.length+1).join("0")+y},i=[],n=t.substr(0,2),r=parseInt(n,16);i[0]=new String(Math.floor(r/40)),i[1]=new String(r%40);for(var s=t.substr(2),o=[],h=0;h<s.length/2;h++)o.push(parseInt(s.substr(h*2,2),16));for(var g=[],p="",h=0;h<o.length;h++)o[h]&128?p=p+e((o[h]&127).toString(2),7):(p=p+e((o[h]&127).toString(2),7),g.push(new String(parseInt(p,2))),p="");var S=i.join(".");return g.length>0&&(S=S+"."+g.join(".")),S};j.dump=function(t,e,i,n){var r=j,s=r.getV,o=r.dump,h=r.getChildIdx,g=t;t instanceof a.asn1.ASN1Object&&(g=t.getEncodedHex());var p=function(B,I){if(B.length<=I*2)return B;var P=B.substr(0,I)+"..(total "+B.length/2+"bytes).."+B.substr(B.length-I,I);return P};e===void 0&&(e={ommit_long_octet:32}),i===void 0&&(i=0),n===void 0&&(n="");var S=e.ommit_long_octet;if(g.substr(i,2)=="01"){var y=s(g,i);return y=="00"?n+`BOOLEAN FALSE
`:n+`BOOLEAN TRUE
`}if(g.substr(i,2)=="02"){var y=s(g,i);return n+"INTEGER "+p(y,S)+`
`}if(g.substr(i,2)=="03"){var y=s(g,i);return n+"BITSTRING "+p(y,S)+`
`}if(g.substr(i,2)=="04"){var y=s(g,i);if(r.isASN1HEX(y)){var l=n+`OCTETSTRING, encapsulates
`;return l=l+o(y,e,0,n+"  "),l}else return n+"OCTETSTRING "+p(y,S)+`
`}if(g.substr(i,2)=="05")return n+`NULL
`;if(g.substr(i,2)=="06"){var f=s(g,i),c=a.asn1.ASN1Util.oidHexToInt(f),u=a.asn1.x509.OID.oid2name(c),d=c.replace(/\./g," ");return u!=""?n+"ObjectIdentifier "+u+" ("+d+`)
`:n+"ObjectIdentifier ("+d+`)
`}if(g.substr(i,2)=="0c")return n+"UTF8String '"+tt(s(g,i))+`'
`;if(g.substr(i,2)=="13")return n+"PrintableString '"+tt(s(g,i))+`'
`;if(g.substr(i,2)=="14")return n+"TeletexString '"+tt(s(g,i))+`'
`;if(g.substr(i,2)=="16")return n+"IA5String '"+tt(s(g,i))+`'
`;if(g.substr(i,2)=="17")return n+"UTCTime "+tt(s(g,i))+`
`;if(g.substr(i,2)=="18")return n+"GeneralizedTime "+tt(s(g,i))+`
`;if(g.substr(i,2)=="30"){if(g.substr(i,4)=="3000")return n+`SEQUENCE {}
`;var l=n+`SEQUENCE
`,v=h(g,i),m=e;if((v.length==2||v.length==3)&&g.substr(v[0],2)=="06"&&g.substr(v[v.length-1],2)=="04"){var u=r.oidname(s(g,v[0])),F=JSON.parse(JSON.stringify(e));F.x509ExtName=u,m=F}for(var x=0;x<v.length;x++)l=l+o(g,m,v[x],n+"  ");return l}if(g.substr(i,2)=="31"){for(var l=n+`SET
`,v=h(g,i),x=0;x<v.length;x++)l=l+o(g,e,v[x],n+"  ");return l}var E=parseInt(g.substr(i,2),16);if((E&128)!=0){var w=E&31;if((E&32)!=0){for(var l=n+"["+w+`]
`,v=h(g,i),x=0;x<v.length;x++)l=l+o(g,e,v[x],n+"  ");return l}else{var y=s(g,i);y.substr(0,8)=="68747470"&&(y=tt(y)),e.x509ExtName==="subjectAltName"&&w==2&&(y=tt(y));var l=n+"["+w+"] "+y+`
`;return l}}return n+"UNKNOWN("+g.substr(i,2)+") "+s(g,i)+`
`};j.isASN1HEX=function(t){var e=j;if(t.length%2==1)return!1;var i=e.getVblen(t,0),n=t.substr(0,2),r=e.getL(t,0),s=t.length-n.length-r.length;return s==i*2};j.oidname=function(t){var e=a.asn1;a.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var i=e.x509.OID.oid2name(t);return i===""&&(i=t),i};(typeof a=="undefined"||!a)&&(a={});(typeof a.asn1=="undefined"||!a.asn1)&&(a.asn1={});(typeof a.asn1.x509=="undefined"||!a.asn1.x509)&&(a.asn1.x509={});a.asn1.x509.Certificate=function(t){a.asn1.x509.Certificate.superclass.constructor.call(this);var e=null,i=null,n=null,r=null,s=null,o=a,h=o.crypto,g=o.asn1,p=g.DERSequence,S=g.DERBitString;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;var y=new a.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg});y.init(this.prvKey),y.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=y.sign(),this.asn1Sig=new S({hex:"00"+this.hexSig});var l=new p({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=l.getEncodedHex(),this.isModified=!1},this.setSignatureHex=function(y){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,this.hexSig=y,this.asn1Sig=new S({hex:"00"+this.hexSig});var l=new p({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=l.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(this.isModified==!1&&this.hTLV!=null)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){var y=ae(this.getEncodedHex());return`-----BEGIN CERTIFICATE-----\r
`+y+`\r
-----END CERTIFICATE-----\r
`},t!==void 0&&(t.tbscertobj!==void 0&&(this.asn1TBSCert=t.tbscertobj),t.prvkeyobj!==void 0&&(this.prvKey=t.prvkeyobj))};H.lang.extend(a.asn1.x509.Certificate,a.asn1.ASN1Object);a.asn1.x509.TBSCertificate=function(t){a.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=a,i=e.asn1,n=i.DERSequence,r=i.DERInteger,s=i.DERTaggedObject,o=i.x509,h=o.Time,g=o.X500Name,p=o.SubjectPublicKeyInfo;this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new s({obj:new r({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(S){this.asn1SerialNumber=new r(S)},this.setSignatureAlgByParam=function(S){this.asn1SignatureAlg=new o.AlgorithmIdentifier(S)},this.setIssuerByParam=function(S){this.asn1Issuer=new g(S)},this.setNotBeforeByParam=function(S){this.asn1NotBefore=new h(S)},this.setNotAfterByParam=function(S){this.asn1NotAfter=new h(S)},this.setSubjectByParam=function(S){this.asn1Subject=new g(S)},this.setSubjectPublicKey=function(S){this.asn1SubjPKey=new p(S)},this.setSubjectPublicKeyByGetKey=function(S){var y=Q.getKey(S);this.asn1SubjPKey=new p(y)},this.appendExtension=function(S){this.extensionsArray.push(S)},this.appendExtensionByName=function(S,y){a.asn1.x509.Extension.appendByNameToArray(S,y,this.extensionsArray)},this.getEncodedHex=function(){if(this.asn1NotBefore==null||this.asn1NotAfter==null)throw"notBefore and/or notAfter not set";var S=new n({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(S),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var y=new n({array:this.extensionsArray}),l=new s({explicit:!0,tag:"a3",obj:y});this.asn1Array.push(l)}var f=new n({array:this.asn1Array});return this.hTLV=f.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()};H.lang.extend(a.asn1.x509.TBSCertificate,a.asn1.ASN1Object);a.asn1.x509.Extension=function(t){a.asn1.x509.Extension.superclass.constructor.call(this);var e=null,i=a,n=i.asn1,r=n.DERObjectIdentifier,s=n.DEROctetString,o=n.DERBitString,h=n.DERBoolean,g=n.DERSequence;this.getEncodedHex=function(){var p=new r({oid:this.oid}),S=new s({hex:this.getExtnValueHex()}),y=new Array;y.push(p),this.critical&&y.push(new h),y.push(S);var l=new g({array:y});return l.getEncodedHex()},this.critical=!1,t!==void 0&&t.critical!==void 0&&(this.critical=t.critical)};H.lang.extend(a.asn1.x509.Extension,a.asn1.ASN1Object);a.asn1.x509.Extension.appendByNameToArray=function(t,e,i){var n=t.toLowerCase(),r=a.asn1.x509;if(n=="basicconstraints"){var s=new r.BasicConstraints(e);i.push(s)}else if(n=="keyusage"){var s=new r.KeyUsage(e);i.push(s)}else if(n=="crldistributionpoints"){var s=new r.CRLDistributionPoints(e);i.push(s)}else if(n=="extkeyusage"){var s=new r.ExtKeyUsage(e);i.push(s)}else if(n=="authoritykeyidentifier"){var s=new r.AuthorityKeyIdentifier(e);i.push(s)}else if(n=="subjectkeyidentifier"){var s=new r.SubjectKeyIdentifier(e);i.push(s)}else if(n=="authorityinfoaccess"){var s=new r.AuthorityInfoAccess(e);i.push(s)}else if(n=="subjectaltname"){var s=new r.SubjectAltName(e);i.push(s)}else if(n=="issueraltname"){var s=new r.IssuerAltName(e);i.push(s)}else throw"unsupported extension name: "+t};a.asn1.x509.KeyUsage=function(t){a.asn1.x509.KeyUsage.superclass.constructor.call(this,t);var e=X.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",t!==void 0&&(t.bin!==void 0&&(this.asn1ExtnValue=new a.asn1.DERBitString(t)),t.names!==void 0&&t.names.length!==void 0)){for(var i=t.names,n="000000000",r=0;r<i.length;r++)for(var s=0;s<e.length;s++)i[r]===e[s]&&(n=n.substring(0,s)+"1"+n.substring(s+1,n.length));this.asn1ExtnValue=new a.asn1.DERBitString({bin:n})}};H.lang.extend(a.asn1.x509.KeyUsage,a.asn1.x509.Extension);a.asn1.x509.BasicConstraints=function(t){a.asn1.x509.BasicConstraints.superclass.constructor.call(this,t);var e=!1,i=-1;this.getExtnValueHex=function(){var n=new Array;this.cA&&n.push(new a.asn1.DERBoolean),this.pathLen>-1&&n.push(new a.asn1.DERInteger({int:this.pathLen}));var r=new a.asn1.DERSequence({array:n});return this.asn1ExtnValue=r,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,t!==void 0&&(t.cA!==void 0&&(this.cA=t.cA),t.pathLen!==void 0&&(this.pathLen=t.pathLen))};H.lang.extend(a.asn1.x509.BasicConstraints,a.asn1.x509.Extension);a.asn1.x509.CRLDistributionPoints=function(t){a.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,t);var e=a,i=e.asn1,n=i.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(r){this.asn1ExtnValue=new i.DERSequence({array:r})},this.setByOneURI=function(r){var s=new n.GeneralNames([{uri:r}]),o=new n.DistributionPointName(s),h=new n.DistributionPoint({dpobj:o});this.setByDPArray([h])},this.oid="2.5.29.31",t!==void 0&&(t.array!==void 0?this.setByDPArray(t.array):t.uri!==void 0&&this.setByOneURI(t.uri))};H.lang.extend(a.asn1.x509.CRLDistributionPoints,a.asn1.x509.Extension);a.asn1.x509.ExtKeyUsage=function(t){a.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,t);var e=a,i=e.asn1;this.setPurposeArray=function(n){this.asn1ExtnValue=new i.DERSequence;for(var r=0;r<n.length;r++){var s=new i.DERObjectIdentifier(n[r]);this.asn1ExtnValue.appendASN1Object(s)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",t!==void 0&&t.array!==void 0&&this.setPurposeArray(t.array)};H.lang.extend(a.asn1.x509.ExtKeyUsage,a.asn1.x509.Extension);a.asn1.x509.AuthorityKeyIdentifier=function(t){a.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,t);var e=a,i=e.asn1,n=i.DERTaggedObject;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var r=new Array;this.asn1KID&&r.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&r.push(new n({explicit:!1,tag:"a1",obj:this.asn1CertIssuer})),this.asn1CertSN&&r.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var s=new i.DERSequence({array:r});return this.asn1ExtnValue=s,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(r){this.asn1KID=new a.asn1.DEROctetString(r)},this.setCertIssuerByParam=function(r){this.asn1CertIssuer=new a.asn1.x509.X500Name(r)},this.setCertSNByParam=function(r){this.asn1CertSN=new a.asn1.DERInteger(r)},this.oid="2.5.29.35",t!==void 0&&(t.kid!==void 0&&this.setKIDByParam(t.kid),t.issuer!==void 0&&this.setCertIssuerByParam(t.issuer),t.sn!==void 0&&this.setCertSNByParam(t.sn))};H.lang.extend(a.asn1.x509.AuthorityKeyIdentifier,a.asn1.x509.Extension);a.asn1.x509.SubjectKeyIdentifier=function(t){a.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,t);var e=a,i=e.asn1,n=i.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(r){this.asn1KID=new n(r)},this.oid="2.5.29.14",t!==void 0&&t.kid!==void 0&&this.setKIDByParam(t.kid)};H.lang.extend(a.asn1.x509.SubjectKeyIdentifier,a.asn1.x509.Extension);a.asn1.x509.AuthorityInfoAccess=function(t){a.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,t),this.setAccessDescriptionArray=function(e){for(var i=new Array,n=a,r=n.asn1,s=r.DERSequence,o=0;o<e.length;o++){var h=new r.DERObjectIdentifier(e[o].accessMethod),g=new r.x509.GeneralName(e[o].accessLocation),p=new s({array:[h,g]});i.push(p)}this.asn1ExtnValue=new s({array:i})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",t!==void 0&&t.array!==void 0&&this.setAccessDescriptionArray(t.array)};H.lang.extend(a.asn1.x509.AuthorityInfoAccess,a.asn1.x509.Extension);a.asn1.x509.SubjectAltName=function(t){a.asn1.x509.SubjectAltName.superclass.constructor.call(this,t),this.setNameArray=function(e){this.asn1ExtnValue=new a.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",t!==void 0&&t.array!==void 0&&this.setNameArray(t.array)};H.lang.extend(a.asn1.x509.SubjectAltName,a.asn1.x509.Extension);a.asn1.x509.IssuerAltName=function(t){a.asn1.x509.IssuerAltName.superclass.constructor.call(this,t),this.setNameArray=function(e){this.asn1ExtnValue=new a.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",t!==void 0&&t.array!==void 0&&this.setNameArray(t.array)};H.lang.extend(a.asn1.x509.IssuerAltName,a.asn1.x509.Extension);a.asn1.x509.CRL=function(t){a.asn1.x509.CRL.superclass.constructor.call(this);var e=null,i=null,n=null,r=null,s=null;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new a.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new a.asn1.DERBitString({hex:"00"+this.hexSig});var o=new a.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=o.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(this.isModified==!1&&this.hTLV!=null)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){var o=ae(this.getEncodedHex());return`-----BEGIN X509 CRL-----\r
`+o+`\r
-----END X509 CRL-----\r
`},t!==void 0&&(t.tbsobj!==void 0&&(this.asn1TBSCertList=t.tbsobj),t.prvkeyobj!==void 0&&(this.prvKey=t.prvkeyobj))};H.lang.extend(a.asn1.x509.CRL,a.asn1.ASN1Object);a.asn1.x509.TBSCertList=function(t){a.asn1.x509.TBSCertList.superclass.constructor.call(this);var e=null,i=a,n=i.asn1,r=n.DERSequence,s=n.x509,o=s.Time;this.setSignatureAlgByParam=function(h){this.asn1SignatureAlg=new s.AlgorithmIdentifier(h)},this.setIssuerByParam=function(h){this.asn1Issuer=new s.X500Name(h)},this.setThisUpdateByParam=function(h){this.asn1ThisUpdate=new o(h)},this.setNextUpdateByParam=function(h){this.asn1NextUpdate=new o(h)},this.addRevokedCert=function(h,g){var p={};h!=null&&h!=null&&(p.sn=h),g!=null&&g!=null&&(p.time=g);var S=new s.CRLEntry(p);this.aRevokedCert.push(S)},this.getEncodedHex=function(){if(this.asn1Array=new Array,this.asn1Version!=null&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),this.asn1NextUpdate!=null&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var h=new r({array:this.aRevokedCert});this.asn1Array.push(h)}var g=new r({array:this.asn1Array});return this.hTLV=g.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()};H.lang.extend(a.asn1.x509.TBSCertList,a.asn1.ASN1Object);a.asn1.x509.CRLEntry=function(t){a.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=null,i=null,n=a,r=n.asn1;this.setCertSerial=function(s){this.sn=new r.DERInteger(s)},this.setRevocationDate=function(s){this.time=new r.x509.Time(s)},this.getEncodedHex=function(){var s=new r.DERSequence({array:[this.sn,this.time]});return this.TLV=s.getEncodedHex(),this.TLV},t!==void 0&&(t.time!==void 0&&this.setRevocationDate(t.time),t.sn!==void 0&&this.setCertSerial(t.sn))};H.lang.extend(a.asn1.x509.CRLEntry,a.asn1.ASN1Object);a.asn1.x509.X500Name=function(t){a.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array;var e=a,i=e.asn1,n=i.x509,r=at;if(this.setByString=function(o){var h=o.split("/");h.shift();for(var g=[],p=0;p<h.length;p++)if(h[p].match(/^[^=]+=.+$/))g.push(h[p]);else{var S=g.length-1;g[S]=g[S]+"/"+h[p]}for(var p=0;p<g.length;p++)this.asn1Array.push(new n.RDN({str:g[p]}))},this.setByLdapString=function(o){var h=n.X500Name.ldapToOneline(o);this.setByString(h)},this.setByObject=function(o){for(var h in o)if(o.hasOwnProperty(h)){var g=new a.asn1.x509.RDN({str:h+"="+o[h]});this.asn1Array?this.asn1Array.push(g):this.asn1Array=[g]}},this.getEncodedHex=function(){if(typeof this.hTLV=="string")return this.hTLV;var o=new i.DERSequence({array:this.asn1Array});return this.hTLV=o.getEncodedHex(),this.hTLV},t!==void 0){if(t.str!==void 0?this.setByString(t.str):t.ldapstr!==void 0?this.setByLdapString(t.ldapstr):typeof t=="object"&&this.setByObject(t),t.certissuer!==void 0){var s=new X;s.hex=r(t.certissuer),this.hTLV=s.getIssuerHex()}if(t.certsubject!==void 0){var s=new X;s.hex=r(t.certsubject),this.hTLV=s.getSubjectHex()}}};H.lang.extend(a.asn1.x509.X500Name,a.asn1.ASN1Object);a.asn1.x509.X500Name.onelineToLDAP=function(t){if(t.substr(0,1)!=="/")throw"malformed input";var e="";t=t.substr(1);var i=t.split("/");return i.reverse(),i=i.map(function(n){return n.replace(/,/,"\\,")}),i.join(",")};a.asn1.x509.X500Name.ldapToOneline=function(t){for(var e=t.split(","),i=!1,n=[],r=0;e.length>0;r++){var s=e.shift();if(i===!0){var o=n.pop(),h=(o+","+s).replace(/\\,/g,",");n.push(h),i=!1}else n.push(s);s.substr(-1,1)==="\\"&&(i=!0)}return n=n.map(function(g){return g.replace("/","\\/")}),n.reverse(),"/"+n.join("/")};a.asn1.x509.RDN=function(t){a.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(e){this.asn1Array.push(new a.asn1.x509.AttributeTypeAndValue({str:e}))},this.addByMultiValuedString=function(e){for(var i=a.asn1.x509.RDN.parseString(e),n=0;n<i.length;n++)this.addByString(i[n])},this.getEncodedHex=function(){var e=new a.asn1.DERSet({array:this.asn1Array});return this.TLV=e.getEncodedHex(),this.TLV},t!==void 0&&t.str!==void 0&&this.addByMultiValuedString(t.str)};H.lang.extend(a.asn1.x509.RDN,a.asn1.ASN1Object);a.asn1.x509.RDN.parseString=function(t){for(var e=t.split(/\+/),i=!1,n=[],r=0;e.length>0;r++){var s=e.shift();if(i===!0){var o=n.pop(),h=(o+"+"+s).replace(/\\\+/g,"+");n.push(h),i=!1}else n.push(s);s.substr(-1,1)==="\\"&&(i=!0)}for(var g=!1,p=[],r=0;n.length>0;r++){var s=n.shift();if(g===!0){var S=p.pop();if(s.match(/"$/)){var h=(S+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");p.push(h),g=!1}else p.push(S+"+"+s)}else p.push(s);s.match(/^[^=]+="/)&&(g=!0)}return p};a.asn1.x509.AttributeTypeAndValue=function(t){a.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var e=null,i=null,n="utf8",r=a,s=r.asn1;this.setByString=function(o){var h=o.match(/^([^=]+)=(.+)$/);if(h)this.setByAttrTypeAndValueStr(h[1],h[2]);else throw"malformed attrTypeAndValueStr: "+o},this.setByAttrTypeAndValueStr=function(o,h){this.typeObj=a.asn1.x509.OID.atype2obj(o);var g=n;o=="C"&&(g="prn"),this.valueObj=this.getValueObj(g,h)},this.getValueObj=function(o,h){if(o=="utf8")return new s.DERUTF8String({str:h});if(o=="prn")return new s.DERPrintableString({str:h});if(o=="tel")return new s.DERTeletexString({str:h});if(o=="ia5")return new s.DERIA5String({str:h});throw"unsupported directory string type: type="+o+" value="+h},this.getEncodedHex=function(){var o=new s.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=o.getEncodedHex(),this.TLV},t!==void 0&&t.str!==void 0&&this.setByString(t.str)};H.lang.extend(a.asn1.x509.AttributeTypeAndValue,a.asn1.ASN1Object);a.asn1.x509.SubjectPublicKeyInfo=function(t){a.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=null,i=null,n=a,r=n.asn1,s=r.DERInteger,o=r.DERBitString,h=r.DERObjectIdentifier,g=r.DERSequence,p=r.ASN1Util.newObject,S=r.x509,y=S.AlgorithmIdentifier,l=n.crypto,f=l.ECDSA,c=l.DSA;this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var u=new g({array:[this.asn1AlgId,this.asn1SubjPKey]});return u},this.getEncodedHex=function(){var u=this.getASN1Object();return this.hTLV=u.getEncodedHex(),this.hTLV},this.setPubKey=function(u){try{if(u instanceof K){var d=p({seq:[{int:{bigint:u.n}},{int:{int:u.e}}]}),v=d.getEncodedHex();this.asn1AlgId=new y({name:"rsaEncryption"}),this.asn1SubjPKey=new o({hex:"00"+v})}}catch(x){}try{if(u instanceof a.crypto.ECDSA){var m=new h({name:u.curveName});this.asn1AlgId=new y({name:"ecPublicKey",asn1params:m}),this.asn1SubjPKey=new o({hex:"00"+u.pubKeyHex})}}catch(x){}try{if(u instanceof a.crypto.DSA){var m=new p({seq:[{int:{bigint:u.p}},{int:{bigint:u.q}},{int:{bigint:u.g}}]});this.asn1AlgId=new y({name:"dsa",asn1params:m});var F=new s({bigint:u.y});this.asn1SubjPKey=new o({hex:"00"+F.getEncodedHex()})}}catch(x){}},t!==void 0&&this.setPubKey(t)};H.lang.extend(a.asn1.x509.SubjectPublicKeyInfo,a.asn1.ASN1Object);a.asn1.x509.Time=function(t){a.asn1.x509.Time.superclass.constructor.call(this);var e=null,i=null,n=a,r=n.asn1,s=r.DERUTCTime,o=r.DERGeneralizedTime;this.setTimeParams=function(h){this.timeParams=h},this.getEncodedHex=function(){var h=null;return this.timeParams!=null?this.type=="utc"?h=new s(this.timeParams):h=new o(this.timeParams):this.type=="utc"?h=new s:h=new o,this.TLV=h.getEncodedHex(),this.TLV},this.type="utc",t!==void 0&&(t.type!==void 0?this.type=t.type:t.str!==void 0&&(t.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),t.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=t)};H.lang.extend(a.asn1.x509.Time,a.asn1.ASN1Object);a.asn1.x509.AlgorithmIdentifier=function(t){a.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var e=a,i=e.asn1;if(this.getEncodedHex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw"algorithm not specified";this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=i.x509.OID.name2obj(this.nameAlg));var r=[this.asn1Alg];this.asn1Params!==null&&r.push(this.asn1Params);var s=new i.DERSequence({array:r});return this.hTLV=s.getEncodedHex(),this.hTLV},t!==void 0&&(t.name!==void 0&&(this.nameAlg=t.name),t.asn1params!==void 0&&(this.asn1Params=t.asn1params),t.paramempty!==void 0&&(this.paramEmpty=t.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){var n=this.nameAlg.toLowerCase();n.substr(-7,7)!=="withdsa"&&n.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new i.DERNull)}};H.lang.extend(a.asn1.x509.AlgorithmIdentifier,a.asn1.ASN1Object);a.asn1.x509.GeneralName=function(t){a.asn1.x509.GeneralName.superclass.constructor.call(this);var e=null,i=null,n={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},r=a,s=r.asn1,o=s.DERSequence,h=s.DEROctetString,g=s.DERIA5String,p=s.DERTaggedObject,S=s.ASN1Object,y=s.x509.X500Name,l=at;this.explicit=!1,this.setByParam=function(f){var c=null,u=null;if(f!==void 0){if(f.rfc822!==void 0&&(this.type="rfc822",u=new g({str:f[this.type]})),f.dns!==void 0&&(this.type="dns",u=new g({str:f[this.type]})),f.uri!==void 0&&(this.type="uri",u=new g({str:f[this.type]})),f.dn!==void 0&&(this.type="dn",this.explicit=!0,u=new y({str:f.dn})),f.ldapdn!==void 0&&(this.type="dn",this.explicit=!0,u=new y({ldapstr:f.ldapdn})),f.certissuer!==void 0){this.type="dn",this.explicit=!0;var d=f.certissuer,v=null;if(d.match(/^[0-9A-Fa-f]+$/)&&v==d,d.indexOf("-----BEGIN ")!=-1&&(v=l(d)),v==null)throw"certissuer param not cert";var m=new X;m.hex=v;var F=m.getIssuerHex();u=new S,u.hTLV=F}if(f.certsubj!==void 0){this.type="dn",this.explicit=!0;var d=f.certsubj,v=null;if(d.match(/^[0-9A-Fa-f]+$/)&&v==d,d.indexOf("-----BEGIN ")!=-1&&(v=l(d)),v==null)throw"certsubj param not cert";var m=new X;m.hex=v;var F=m.getSubjectHex();u=new S,u.hTLV=F}if(f.ip!==void 0){this.type="ip",this.explicit=!1;var x=f.ip,E,w="malformed IP address";if(x.match(/^[0-9.]+[.][0-9.]+$/)){if(E=pr("["+x.split(".").join(",")+"]"),E.length!==8)throw w}else if(x.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))E=cr(x);else if(x.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))E=x;else throw w;u=new h({hex:E})}if(this.type==null)throw"unsupported type in params="+f;this.asn1Obj=new p({explicit:this.explicit,tag:n[this.type],obj:u})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},t!==void 0&&this.setByParam(t)};H.lang.extend(a.asn1.x509.GeneralName,a.asn1.ASN1Object);a.asn1.x509.GeneralNames=function(t){a.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=null,i=a,n=i.asn1;this.setByParamArray=function(r){for(var s=0;s<r.length;s++){var o=new n.x509.GeneralName(r[s]);this.asn1Array.push(o)}},this.getEncodedHex=function(){var r=new n.DERSequence({array:this.asn1Array});return r.getEncodedHex()},this.asn1Array=new Array,typeof t!="undefined"&&this.setByParamArray(t)};H.lang.extend(a.asn1.x509.GeneralNames,a.asn1.ASN1Object);a.asn1.x509.DistributionPointName=function(t){a.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=null,i=null,n=null,r=null,s=a,o=s.asn1,h=o.DERTaggedObject;if(this.getEncodedHex=function(){if(this.type!="full")throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new h({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},t!==void 0)if(o.x509.GeneralNames.prototype.isPrototypeOf(t))this.type="full",this.tag="a0",this.asn1V=t;else throw"This class supports GeneralNames only as argument"};H.lang.extend(a.asn1.x509.DistributionPointName,a.asn1.ASN1Object);a.asn1.x509.DistributionPoint=function(t){a.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=null,i=a,n=i.asn1;this.getEncodedHex=function(){var r=new n.DERSequence;if(this.asn1DP!=null){var s=new n.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});r.appendASN1Object(s)}return this.hTLV=r.getEncodedHex(),this.hTLV},t!==void 0&&t.dpobj!==void 0&&(this.asn1DP=t.dpobj)};H.lang.extend(a.asn1.x509.DistributionPoint,a.asn1.ASN1Object);a.asn1.x509.OID=new function(t){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14"},this.objCache={},this.name2obj=function(e){if(typeof this.objCache[e]!="undefined")return this.objCache[e];if(typeof this.name2oidList[e]=="undefined")throw"Name of ObjectIdentifier not defined: "+e;var i=this.name2oidList[e],n=new a.asn1.DERObjectIdentifier({oid:i});return this.objCache[e]=n,n},this.atype2obj=function(e){if(typeof this.objCache[e]!="undefined")return this.objCache[e];if(typeof this.atype2oidList[e]=="undefined")throw"AttributeType name undefined: "+e;var i=this.atype2oidList[e],n=new a.asn1.DERObjectIdentifier({oid:i});return this.objCache[e]=n,n}};a.asn1.x509.OID.oid2name=function(t){var e=a.asn1.x509.OID.name2oidList;for(var i in e)if(e[i]==t)return i;return""};a.asn1.x509.OID.oid2atype=function(t){var e=a.asn1.x509.OID.atype2oidList;for(var i in e)if(e[i]==t)return i;return t};a.asn1.x509.OID.name2oid=function(t){var e=a.asn1.x509.OID.name2oidList;return e[t]===void 0?"":e[t]};a.asn1.x509.X509Util={};a.asn1.x509.X509Util.newCertPEM=function(t){var e=a.asn1.x509,i=e.TBSCertificate,n=e.Certificate,r=new i;if(t.serial!==void 0)r.setSerialNumberByParam(t.serial);else throw"serial number undefined.";if(typeof t.sigalg.name=="string")r.setSignatureAlgByParam(t.sigalg);else throw"unproper signature algorithm name";if(t.issuer!==void 0)r.setIssuerByParam(t.issuer);else throw"issuer name undefined.";if(t.notbefore!==void 0)r.setNotBeforeByParam(t.notbefore);else throw"notbefore undefined.";if(t.notafter!==void 0)r.setNotAfterByParam(t.notafter);else throw"notafter undefined.";if(t.subject!==void 0)r.setSubjectByParam(t.subject);else throw"subject name undefined.";if(t.sbjpubkey!==void 0)r.setSubjectPublicKeyByGetKey(t.sbjpubkey);else throw"subject public key undefined.";if(t.ext!==void 0&&t.ext.length!==void 0)for(var s=0;s<t.ext.length;s++)for(key in t.ext[s])r.appendExtensionByName(key,t.ext[s][key]);if(t.cakey===void 0&&t.sighex===void 0)throw"param cakey and sighex undefined.";var o=null,h=null;return t.cakey&&(t.cakey.isPrivate===!0?o=t.cakey:o=Q.getKey.apply(null,t.cakey),h=new n({tbscertobj:r,prvkeyobj:o}),h.sign()),t.sighex&&(h=new n({tbscertobj:r}),h.setSignatureHex(t.sighex)),h.getPEMString()};(typeof a=="undefined"||!a)&&(a={});(typeof a.asn1=="undefined"||!a.asn1)&&(a.asn1={});(typeof a.asn1.cms=="undefined"||!a.asn1.cms)&&(a.asn1.cms={});a.asn1.cms.Attribute=function(t){var e=[],i=a,n=i.asn1;n.cms.Attribute.superclass.constructor.call(this),this.getEncodedHex=function(){var r,s,o;r=new n.DERObjectIdentifier({oid:this.attrTypeOid}),s=new n.DERSet({array:this.valueList});try{s.getEncodedHex()}catch(h){throw"fail valueSet.getEncodedHex in Attribute(1)/"+h}o=new n.DERSequence({array:[r,s]});try{this.hTLV=o.getEncodedHex()}catch(h){throw"failed seq.getEncodedHex in Attribute(2)/"+h}return this.hTLV}};H.lang.extend(a.asn1.cms.Attribute,a.asn1.ASN1Object);a.asn1.cms.ContentType=function(t){var e=a,i=e.asn1;i.cms.ContentType.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.3";var n=null;if(typeof t!="undefined"){var n=new i.DERObjectIdentifier(t);this.valueList=[n]}};H.lang.extend(a.asn1.cms.ContentType,a.asn1.cms.Attribute);a.asn1.cms.MessageDigest=function(t){var e=a,i=e.asn1,n=i.DEROctetString,r=i.cms;if(r.MessageDigest.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.4",t!==void 0)if(t.eciObj instanceof r.EncapsulatedContentInfo&&typeof t.hashAlg=="string"){var s=t.eciObj.eContentValueHex,o=t.hashAlg,h=e.crypto.Util.hashHex(s,o),g=new n({hex:h});g.getEncodedHex(),this.valueList=[g]}else{var g=new n(t);g.getEncodedHex(),this.valueList=[g]}};H.lang.extend(a.asn1.cms.MessageDigest,a.asn1.cms.Attribute);a.asn1.cms.SigningTime=function(t){var e=a,i=e.asn1;if(i.cms.SigningTime.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.5",t!==void 0){var n=new i.x509.Time(t);try{n.getEncodedHex()}catch(r){throw"SigningTime.getEncodedHex() failed/"+r}this.valueList=[n]}};H.lang.extend(a.asn1.cms.SigningTime,a.asn1.cms.Attribute);a.asn1.cms.SigningCertificate=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.cms,s=e.crypto;r.SigningCertificate.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.12",this.setCerts=function(o){for(var h=[],g=0;g<o.length;g++){var p=at(o[g]),S=e.crypto.Util.hashHex(p,"sha1"),y=new i.DEROctetString({hex:S});y.getEncodedHex();var l=new r.IssuerAndSerialNumber({cert:o[g]});l.getEncodedHex();var f=new n({array:[y,l]});f.getEncodedHex(),h.push(f)}var c=new n({array:h});c.getEncodedHex(),this.valueList=[c]},t!==void 0&&typeof t.array=="object"&&this.setCerts(t.array)};H.lang.extend(a.asn1.cms.SigningCertificate,a.asn1.cms.Attribute);a.asn1.cms.SigningCertificateV2=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.x509,s=i.cms,o=e.crypto;if(s.SigningCertificateV2.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.47",this.setCerts=function(g,p){for(var S=[],y=0;y<g.length;y++){var l=at(g[y]),f=[];p!=="sha256"&&f.push(new r.AlgorithmIdentifier({name:p}));var c=o.Util.hashHex(l,p),u=new i.DEROctetString({hex:c});u.getEncodedHex(),f.push(u);var d=new s.IssuerAndSerialNumber({cert:g[y]});d.getEncodedHex(),f.push(d);var v=new n({array:f});v.getEncodedHex(),S.push(v)}var m=new n({array:S});m.getEncodedHex(),this.valueList=[m]},t!==void 0&&typeof t.array=="object"){var h="sha256";typeof t.hashAlg=="string"&&(h=t.hashAlg),this.setCerts(t.array,h)}};H.lang.extend(a.asn1.cms.SigningCertificateV2,a.asn1.cms.Attribute);a.asn1.cms.IssuerAndSerialNumber=function(t){var e=a,i=e.asn1,n=i.DERInteger,r=i.cms,s=i.x509,o=s.X500Name,h=X;r.IssuerAndSerialNumber.superclass.constructor.call(this);var g=null,p=null;this.setByCertPEM=function(S){var y=at(S),l=new h;l.hex=y;var f=l.getIssuerHex();this.dIssuer=new o,this.dIssuer.hTLV=f;var c=l.getSerialNumberHex();this.dSerial=new n({hex:c})},this.getEncodedHex=function(){var S=new i.DERSequence({array:[this.dIssuer,this.dSerial]});return this.hTLV=S.getEncodedHex(),this.hTLV},t!==void 0&&(typeof t=="string"&&t.indexOf("-----BEGIN ")!=-1&&this.setByCertPEM(t),t.issuer&&t.serial&&(t.issuer instanceof o?this.dIssuer=t.issuer:this.dIssuer=new o(t.issuer),t.serial instanceof n?this.dSerial=t.serial:this.dSerial=new n(t.serial)),typeof t.cert=="string"&&this.setByCertPEM(t.cert))};H.lang.extend(a.asn1.cms.IssuerAndSerialNumber,a.asn1.ASN1Object);a.asn1.cms.AttributeList=function(t){var e=a,i=e.asn1,n=i.cms;n.AttributeList.superclass.constructor.call(this),this.list=new Array,this.sortFlag=!0,this.add=function(r){r instanceof n.Attribute&&this.list.push(r)},this.length=function(){return this.list.length},this.clear=function(){this.list=new Array,this.hTLV=null,this.hV=null},this.getEncodedHex=function(){if(typeof this.hTLV=="string")return this.hTLV;var r=new i.DERSet({array:this.list,sortflag:this.sortFlag});return this.hTLV=r.getEncodedHex(),this.hTLV},t!==void 0&&typeof t.sortflag!="undefined"&&t.sortflag==!1&&(this.sortFlag=!1)};H.lang.extend(a.asn1.cms.AttributeList,a.asn1.ASN1Object);a.asn1.cms.SignerInfo=function(t){var e=a,i=e.asn1,n=i.DERTaggedObject,r=i.cms,s=r.AttributeList,o=r.ContentType,h=r.EncapsulatedContentInfo,g=r.MessageDigest,p=r.SignedData,S=i.x509,y=S.AlgorithmIdentifier,l=e.crypto,f=Q;r.SignerInfo.superclass.constructor.call(this),this.dCMSVersion=new i.DERInteger({int:1}),this.dSignerIdentifier=null,this.dDigestAlgorithm=null,this.dSignedAttrs=new s,this.dSigAlg=null,this.dSig=null,this.dUnsignedAttrs=new s,this.setSignerIdentifier=function(c){if(typeof c=="string"&&c.indexOf("CERTIFICATE")!=-1&&c.indexOf("BEGIN")!=-1&&c.indexOf("END")!=-1){var u=c;this.dSignerIdentifier=new r.IssuerAndSerialNumber({cert:c})}},this.setForContentAndHash=function(c){c!==void 0&&(c.eciObj instanceof h&&(this.dSignedAttrs.add(new o({oid:"1.2.840.113549.1.7.1"})),this.dSignedAttrs.add(new g({eciObj:c.eciObj,hashAlg:c.hashAlg}))),c.sdObj!==void 0&&c.sdObj instanceof p&&c.sdObj.digestAlgNameList.join(":").indexOf(c.hashAlg)==-1&&c.sdObj.digestAlgNameList.push(c.hashAlg),typeof c.hashAlg=="string"&&(this.dDigestAlgorithm=new y({name:c.hashAlg})))},this.sign=function(c,u){this.dSigAlg=new y({name:u});var d=this.dSignedAttrs.getEncodedHex(),v=f.getKey(c),m=new l.Signature({alg:u});m.init(v),m.updateHex(d);var F=m.sign();this.dSig=new i.DEROctetString({hex:F})},this.addUnsigned=function(c){this.hTLV=null,this.dUnsignedAttrs.hTLV=null,this.dUnsignedAttrs.add(c)},this.getEncodedHex=function(){if(this.dSignedAttrs instanceof s&&this.dSignedAttrs.length()==0)throw"SignedAttrs length = 0 (empty)";var c=new n({obj:this.dSignedAttrs,tag:"a0",explicit:!1}),u=null;this.dUnsignedAttrs.length()>0&&(u=new n({obj:this.dUnsignedAttrs,tag:"a1",explicit:!1}));var d=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,c,this.dSigAlg,this.dSig];u!=null&&d.push(u);var v=new i.DERSequence({array:d});return this.hTLV=v.getEncodedHex(),this.hTLV}};H.lang.extend(a.asn1.cms.SignerInfo,a.asn1.ASN1Object);a.asn1.cms.EncapsulatedContentInfo=function(t){var e=a,i=e.asn1,n=i.DERTaggedObject,r=i.DERSequence,s=i.DERObjectIdentifier,o=i.DEROctetString,h=i.cms;h.EncapsulatedContentInfo.superclass.constructor.call(this),this.dEContentType=new s({name:"data"}),this.dEContent=null,this.isDetached=!1,this.eContentValueHex=null,this.setContentType=function(g){g.match(/^[0-2][.][0-9.]+$/)?this.dEContentType=new s({oid:g}):this.dEContentType=new s({name:g})},this.setContentValue=function(g){g!==void 0&&(typeof g.hex=="string"?this.eContentValueHex=g.hex:typeof g.str=="string"&&(this.eContentValueHex=Ut(g.str)))},this.setContentValueHex=function(g){this.eContentValueHex=g},this.setContentValueStr=function(g){this.eContentValueHex=Ut(g)},this.getEncodedHex=function(){if(typeof this.eContentValueHex!="string")throw"eContentValue not yet set";var g=new o({hex:this.eContentValueHex});this.dEContent=new n({obj:g,tag:"a0",explicit:!0});var p=[this.dEContentType];this.isDetached||p.push(this.dEContent);var S=new r({array:p});return this.hTLV=S.getEncodedHex(),this.hTLV}};H.lang.extend(a.asn1.cms.EncapsulatedContentInfo,a.asn1.ASN1Object);a.asn1.cms.ContentInfo=function(t){var e=a,i=e.asn1,n=i.DERTaggedObject,r=i.DERSequence,s=i.x509;a.asn1.cms.ContentInfo.superclass.constructor.call(this),this.dContentType=null,this.dContent=null,this.setContentType=function(o){typeof o=="string"&&(this.dContentType=s.OID.name2obj(o))},this.getEncodedHex=function(){var o=new n({obj:this.dContent,tag:"a0",explicit:!0}),h=new r({array:[this.dContentType,o]});return this.hTLV=h.getEncodedHex(),this.hTLV},t!==void 0&&(t.type&&this.setContentType(t.type),t.obj&&t.obj instanceof i.ASN1Object&&(this.dContent=t.obj))};H.lang.extend(a.asn1.cms.ContentInfo,a.asn1.ASN1Object);a.asn1.cms.SignedData=function(t){var e=a,i=e.asn1,n=i.ASN1Object,r=i.DERInteger,s=i.DERSet,o=i.DERSequence,h=i.DERTaggedObject,g=i.cms,p=g.EncapsulatedContentInfo,S=g.SignerInfo,y=g.ContentInfo,l=i.x509,f=l.AlgorithmIdentifier;a.asn1.cms.SignedData.superclass.constructor.call(this),this.dCMSVersion=new r({int:1}),this.dDigestAlgs=null,this.digestAlgNameList=[],this.dEncapContentInfo=new p,this.dCerts=null,this.certificateList=[],this.crlList=[],this.signerInfoList=[new S],this.addCertificatesByPEM=function(c){var u=at(c),d=new n;d.hTLV=u,this.certificateList.push(d)},this.getEncodedHex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.dDigestAlgs==null){for(var c=[],u=0;u<this.digestAlgNameList.length;u++){var d=this.digestAlgNameList[u],v=new f({name:d});c.push(v)}this.dDigestAlgs=new s({array:c})}var m=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(this.dCerts==null&&this.certificateList.length>0){var F=new s({array:this.certificateList});this.dCerts=new h({obj:F,tag:"a0",explicit:!1})}this.dCerts!=null&&m.push(this.dCerts);var x=new s({array:this.signerInfoList});m.push(x);var E=new o({array:m});return this.hTLV=E.getEncodedHex(),this.hTLV},this.getContentInfo=function(){this.getEncodedHex();var c=new y({type:"signed-data",obj:this});return c},this.getContentInfoEncodedHex=function(){var c=this.getContentInfo(),u=c.getEncodedHex();return u},this.getPEM=function(){return ht(this.getContentInfoEncodedHex(),"CMS")}};H.lang.extend(a.asn1.cms.SignedData,a.asn1.ASN1Object);a.asn1.cms.CMSUtil=new function(){};a.asn1.cms.CMSUtil.newSignedData=function(t){var e=a,i=e.asn1,n=i.cms,r=n.SignerInfo,s=n.SignedData,o=n.SigningTime,h=n.SigningCertificate,g=n.SigningCertificateV2,p=i.cades,S=p.SignaturePolicyIdentifier,y=new s;if(y.dEncapContentInfo.setContentValue(t.content),typeof t.certs=="object")for(var l=0;l<t.certs.length;l++)y.addCertificatesByPEM(t.certs[l]);y.signerInfoList=[];for(var l=0;l<t.signerInfos.length;l++){var f=t.signerInfos[l],c=new r;c.setSignerIdentifier(f.signerCert),c.setForContentAndHash({sdObj:y,eciObj:y.dEncapContentInfo,hashAlg:f.hashAlg});for(attrName in f.sAttr){var u=f.sAttr[attrName];if(attrName=="SigningTime"){var d=new o(u);c.dSignedAttrs.add(d)}if(attrName=="SigningCertificate"){var d=new h(u);c.dSignedAttrs.add(d)}if(attrName=="SigningCertificateV2"){var d=new g(u);c.dSignedAttrs.add(d)}if(attrName=="SignaturePolicyIdentifier"){var d=new S(u);c.dSignedAttrs.add(d)}}c.sign(f.signerPrvKey,f.sigAlg),y.signerInfoList.push(c)}return y};a.asn1.cms.CMSUtil.verifySignedData=function(t){var e=a,i=e.asn1,n=i.cms,r=n.SignerInfo,s=n.SignedData,o=n.SigningTime,h=n.SigningCertificate,g=n.SigningCertificateV2,p=i.cades,S=p.SignaturePolicyIdentifier,y=e.lang.String.isHex,l=j,f=l.getVbyList,c=l.getTLVbyList,u=l.getIdxbyList,d=l.getChildIdx,v=l.getTLV,m=l.oidname,F=e.crypto.Util.hashHex;t.cms===void 0&&y(t.cms);var x=t.cms,E=function(D,A){for(var T,_=3;_<6;_++)if(T=u(D,0,[1,0,_]),T!==void 0){var k=D.substr(T,2);k==="a0"&&(A.certsIdx=T),k==="a1"&&(A.revinfosIdx=T),k==="31"&&(A.signerinfosIdx=T)}},w=function(D,A){var T=A.signerinfosIdx;if(T!==void 0){var _=d(D,T);A.signerInfoIdxList=_;for(var k=0;k<_.length;k++){var M=_[k],z={idx:M};B(D,z),A.signerInfos.push(z)}}},B=function(D,A){var T=A.idx;A.signerid_issuer1=c(D,T,[1,0],"30"),A.signerid_serial1=f(D,T,[1,1],"02"),A.hashalg=m(f(D,T,[2,0],"06"));var _=u(D,T,[3],"a0");A.idxSignedAttrs=_,I(D,A,_);var k=d(D,T),M=k.length;if(M<6)throw"malformed SignerInfo";A.sigalg=m(f(D,T,[M-2,0],"06")),A.sigval=f(D,T,[M-1],"04")},I=function(D,A,T){var _=d(D,T);A.signedAttrIdxList=_;for(var k=0;k<_.length;k++){var M=_[k],z=f(D,M,[0],"06"),q;z==="2a864886f70d010905"?(q=tt(f(D,M,[1,0])),A.saSigningTime=q):z==="2a864886f70d010904"&&(q=f(D,M,[1,0],"04"),A.saMessageDigest=q)}},P=function(D,A){if(f(D,0,[0],"06")!=="2a864886f70d010702")return A;A.cmsType="signedData",A.econtent=f(D,0,[1,0,2,1,0]),E(D,A),A.signerInfos=[],w(D,A)},R=function(D,A){for(var T=A.parse.signerInfos,_=T.length,k=!0,M=0;M<_;M++){var z=T[M];L(D,A,z,M),z.isValid||(k=!1)}A.isValid=k},N=function(D,A,T,_){var k=A.parse.certsIdx,M;if(A.certs===void 0){M=[],A.certkeys=[];for(var z=d(D,k),q=0;q<z.length;q++){var Y=v(D,z[q]),G=new X;G.readCertHex(Y),M[q]=G,A.certkeys[q]=G.getPublicKey()}A.certs=M}else M=A.certs;A.cccc=M.length,A.cccci=z.length;for(var q=0;q<M.length;q++){var Dt=G.getIssuerHex(),gt=G.getSerialNumberHex();T.signerid_issuer1===Dt&&T.signerid_serial1===gt&&(T.certkey_idx=q)}},L=function(D,A,T,_){T.verifyDetail={};var k=T.verifyDetail,M=A.parse.econtent,z=T.hashalg,q=T.saMessageDigest;k.validMessageDigest=!1,F(M,z)===q&&(k.validMessageDigest=!0),N(D,A,T,_),k.validSignatureValue=!1;var Y=T.sigalg,G="31"+v(D,T.idxSignedAttrs).substr(2);T.signedattrshex=G;var Dt=A.certs[T.certkey_idx].getPublicKey(),gt=new a.crypto.Signature({alg:Y});gt.init(Dt),gt.updateHex(G);var ot=gt.verify(T.sigval);k.validSignatureValue_isValid=ot,ot===!0&&(k.validSignatureValue=!0),T.isValid=!1,k.validMessageDigest&&k.validSignatureValue&&(T.isValid=!0)},O=function(){},C={isValid:!1,parse:{}};return P(x,C.parse),R(x,C),C};(typeof a=="undefined"||!a)&&(a={});(typeof a.asn1=="undefined"||!a.asn1)&&(a.asn1={});(typeof a.asn1.tsp=="undefined"||!a.asn1.tsp)&&(a.asn1.tsp={});a.asn1.tsp.Accuracy=function(t){var e=a,i=e.asn1,n=i.DERInteger,r=i.DERSequence,s=i.DERTaggedObject;i.tsp.Accuracy.superclass.constructor.call(this),this.seconds=null,this.millis=null,this.micros=null,this.getEncodedHex=function(){var o=null,h=null,g=null,p=[];if(this.seconds!=null&&(o=new n({int:this.seconds}),p.push(o)),this.millis!=null){var S=new n({int:this.millis});h=new s({obj:S,tag:"80",explicit:!1}),p.push(h)}if(this.micros!=null){var y=new n({int:this.micros});g=new s({obj:y,tag:"81",explicit:!1}),p.push(g)}var l=new r({array:p});return this.hTLV=l.getEncodedHex(),this.hTLV},t!==void 0&&(typeof t.seconds=="number"&&(this.seconds=t.seconds),typeof t.millis=="number"&&(this.millis=t.millis),typeof t.micros=="number"&&(this.micros=t.micros))};H.lang.extend(a.asn1.tsp.Accuracy,a.asn1.ASN1Object);a.asn1.tsp.MessageImprint=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.DEROctetString,s=i.x509,o=s.AlgorithmIdentifier;i.tsp.MessageImprint.superclass.constructor.call(this),this.dHashAlg=null,this.dHashValue=null,this.getEncodedHex=function(){if(typeof this.hTLV=="string")return this.hTLV;var h=new n({array:[this.dHashAlg,this.dHashValue]});return h.getEncodedHex()},t!==void 0&&(typeof t.hashAlg=="string"&&(this.dHashAlg=new o({name:t.hashAlg})),typeof t.hashValue=="string"&&(this.dHashValue=new r({hex:t.hashValue})))};H.lang.extend(a.asn1.tsp.MessageImprint,a.asn1.ASN1Object);a.asn1.tsp.TimeStampReq=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.DERInteger,s=i.DERBoolean,o=i.DERObjectIdentifier,h=i.tsp,g=h.MessageImprint;h.TimeStampReq.superclass.constructor.call(this),this.dVersion=new r({int:1}),this.dMessageImprint=null,this.dPolicy=null,this.dNonce=null,this.certReq=!0,this.setMessageImprint=function(p){if(p instanceof g){this.dMessageImprint=p;return}typeof p=="object"&&(this.dMessageImprint=new g(p))},this.getEncodedHex=function(){if(this.dMessageImprint==null)throw"messageImprint shall be specified";var p=[this.dVersion,this.dMessageImprint];this.dPolicy!=null&&p.push(this.dPolicy),this.dNonce!=null&&p.push(this.dNonce),this.certReq&&p.push(new s);var S=new n({array:p});return this.hTLV=S.getEncodedHex(),this.hTLV},t!==void 0&&(typeof t.mi=="object"&&this.setMessageImprint(t.mi),typeof t.policy=="object"&&(this.dPolicy=new o(t.policy)),typeof t.nonce=="object"&&(this.dNonce=new r(t.nonce)),typeof t.certreq=="boolean"&&(this.certReq=t.certreq))};H.lang.extend(a.asn1.tsp.TimeStampReq,a.asn1.ASN1Object);a.asn1.tsp.TSTInfo=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.DERInteger,s=i.DERBoolean,o=i.DERGeneralizedTime,h=i.DERObjectIdentifier,g=i.tsp,p=g.MessageImprint,S=g.Accuracy,y=i.x509.X500Name;if(g.TSTInfo.superclass.constructor.call(this),this.dVersion=new r({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerialNumber=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var l=[this.dVersion];if(this.dPolicy==null)throw"policy shall be specified.";if(l.push(this.dPolicy),this.dMessageImprint==null)throw"messageImprint shall be specified.";if(l.push(this.dMessageImprint),this.dSerialNumber==null)throw"serialNumber shall be specified.";if(l.push(this.dSerialNumber),this.dGenTime==null)throw"genTime shall be specified.";l.push(this.dGenTime),this.dAccuracy!=null&&l.push(this.dAccuracy),this.dOrdering!=null&&l.push(this.dOrdering),this.dNonce!=null&&l.push(this.dNonce),this.dTsa!=null&&l.push(this.dTsa);var f=new n({array:l});return this.hTLV=f.getEncodedHex(),this.hTLV},t!==void 0){if(typeof t.policy=="string"){if(!t.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new h({oid:t.policy})}t.messageImprint!==void 0&&(this.dMessageImprint=new p(t.messageImprint)),t.serialNumber!==void 0&&(this.dSerialNumber=new r(t.serialNumber)),t.genTime!==void 0&&(this.dGenTime=new o(t.genTime)),t.accuracy!==void 0&&(this.dAccuracy=new S(t.accuracy)),t.ordering!==void 0&&t.ordering==!0&&(this.dOrdering=new s),t.nonce!==void 0&&(this.dNonce=new r(t.nonce)),t.tsa!==void 0&&(this.dTsa=new y(t.tsa))}};H.lang.extend(a.asn1.tsp.TSTInfo,a.asn1.ASN1Object);a.asn1.tsp.TimeStampResp=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.ASN1Object,s=i.tsp,o=s.PKIStatusInfo;s.TimeStampResp.superclass.constructor.call(this),this.dStatus=null,this.dTST=null,this.getEncodedHex=function(){if(this.dStatus==null)throw"status shall be specified";var h=[this.dStatus];this.dTST!=null&&h.push(this.dTST);var g=new n({array:h});return this.hTLV=g.getEncodedHex(),this.hTLV},t!==void 0&&(typeof t.status=="object"&&(this.dStatus=new o(t.status)),t.tst!==void 0&&t.tst instanceof r&&(this.dTST=t.tst.getContentInfo()))};H.lang.extend(a.asn1.tsp.TimeStampResp,a.asn1.ASN1Object);a.asn1.tsp.PKIStatusInfo=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.tsp,s=r.PKIStatus,o=r.PKIFreeText,h=r.PKIFailureInfo;r.PKIStatusInfo.superclass.constructor.call(this),this.dStatus=null,this.dStatusString=null,this.dFailureInfo=null,this.getEncodedHex=function(){if(this.dStatus==null)throw"status shall be specified";var g=[this.dStatus];this.dStatusString!=null&&g.push(this.dStatusString),this.dFailureInfo!=null&&g.push(this.dFailureInfo);var p=new n({array:g});return this.hTLV=p.getEncodedHex(),this.hTLV},t!==void 0&&(typeof t.status=="object"&&(this.dStatus=new s(t.status)),typeof t.statstr=="object"&&(this.dStatusString=new o({array:t.statstr})),typeof t.failinfo=="object"&&(this.dFailureInfo=new h(t.failinfo)))};H.lang.extend(a.asn1.tsp.PKIStatusInfo,a.asn1.ASN1Object);a.asn1.tsp.PKIStatus=function(t){var e=a,i=e.asn1,n=i.DERInteger,r=i.tsp,s=r.PKIStatus;r.PKIStatus.superclass.constructor.call(this);var o=null;if(this.getEncodedHex=function(){return this.hTLV=this.dStatus.getEncodedHex(),this.hTLV},t!==void 0)if(t.name!==void 0){var h=s.valueList;if(h[t.name]===void 0)throw"name undefined: "+t.name;this.dStatus=new n({int:h[t.name]})}else this.dStatus=new n(t)};H.lang.extend(a.asn1.tsp.PKIStatus,a.asn1.ASN1Object);a.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};a.asn1.tsp.PKIFreeText=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.DERUTF8String,s=i.tsp;s.PKIFreeText.superclass.constructor.call(this),this.textList=[],this.getEncodedHex=function(){for(var o=[],h=0;h<this.textList.length;h++)o.push(new r({str:this.textList[h]}));var g=new n({array:o});return this.hTLV=g.getEncodedHex(),this.hTLV},t!==void 0&&typeof t.array=="object"&&(this.textList=t.array)};H.lang.extend(a.asn1.tsp.PKIFreeText,a.asn1.ASN1Object);a.asn1.tsp.PKIFailureInfo=function(t){var e=a,i=e.asn1,n=i.DERBitString,r=i.tsp,s=r.PKIFailureInfo;if(s.superclass.constructor.call(this),this.value=null,this.getEncodedHex=function(){if(this.value==null)throw"value shall be specified";var h=new Number(this.value).toString(2),g=new n;return g.setByBinaryString(h),this.hTLV=g.getEncodedHex(),this.hTLV},t!==void 0)if(typeof t.name=="string"){var o=s.valueList;if(o[t.name]===void 0)throw"name undefined: "+t.name;this.value=o[t.name]}else typeof t.int=="number"&&(this.value=t.int)};H.lang.extend(a.asn1.tsp.PKIFailureInfo,a.asn1.ASN1Object);a.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};a.asn1.tsp.AbstractTSAAdapter=function(t){this.getTSTHex=function(e,i){throw"not implemented yet"}};a.asn1.tsp.SimpleTSAAdapter=function(t){var e=a,i=e.asn1,n=i.tsp,r=e.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(s,o){var h=r(s,o);this.params.tstInfo.messageImprint={hashAlg:o,hashValue:h},this.params.tstInfo.serialNumber={int:this.serial++};var g=Math.floor(Math.random()*1e9);this.params.tstInfo.nonce={int:g};var p=n.TSPUtil.newTimeStampToken(this.params);return p.getContentInfoEncodedHex()},t!==void 0&&(this.params=t)};H.lang.extend(a.asn1.tsp.SimpleTSAAdapter,a.asn1.tsp.AbstractTSAAdapter);a.asn1.tsp.FixedTSAAdapter=function(t){var e=a,i=e.asn1,n=i.tsp,r=e.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(s,o){var h=r(s,o);this.params.tstInfo.messageImprint={hashAlg:o,hashValue:h};var g=n.TSPUtil.newTimeStampToken(this.params);return g.getContentInfoEncodedHex()},t!==void 0&&(this.params=t)};H.lang.extend(a.asn1.tsp.FixedTSAAdapter,a.asn1.tsp.AbstractTSAAdapter);a.asn1.tsp.TSPUtil=new function(){};a.asn1.tsp.TSPUtil.newTimeStampToken=function(t){var e=a,i=e.asn1,n=i.cms,r=i.tsp,s=i.tsp.TSTInfo,o=new n.SignedData,h=new s(t.tstInfo),g=h.getEncodedHex();if(o.dEncapContentInfo.setContentValue({hex:g}),o.dEncapContentInfo.setContentType("tstinfo"),typeof t.certs=="object")for(var p=0;p<t.certs.length;p++)o.addCertificatesByPEM(t.certs[p]);var S=o.signerInfoList[0];S.setSignerIdentifier(t.signerCert),S.setForContentAndHash({sdObj:o,eciObj:o.dEncapContentInfo,hashAlg:t.hashAlg});var y=new n.SigningCertificate({array:[t.signerCert]});return S.dSignedAttrs.add(y),S.sign(t.signerPrvKey,t.sigAlg),o};a.asn1.tsp.TSPUtil.parseTimeStampReq=function(t){var e=j,i=e.getChildIdx,n=e.getV,r=e.getTLV,s={};s.certreq=!1;var o=i(t,0);if(o.length<2)throw"TimeStampReq must have at least 2 items";var h=r(t,o[1]);s.mi=a.asn1.tsp.TSPUtil.parseMessageImprint(h);for(var g=2;g<o.length;g++){var p=o[g],S=t.substr(p,2);if(S=="06"){var y=n(t,p);s.policy=e.hextooidstr(y)}S=="02"&&(s.nonce=n(t,p)),S=="01"&&(s.certreq=!0)}return s};a.asn1.tsp.TSPUtil.parseMessageImprint=function(t){var e=j,i=e.getChildIdx,n=e.getV,r=e.getIdxbyList,s={};if(t.substr(0,2)!="30")throw"head of messageImprint hex shall be '30'";var o=i(t,0),h=r(t,0,[0,0]),g=n(t,h),p=e.hextooidstr(g),S=a.asn1.x509.OID.oid2name(p);if(S=="")throw"hashAlg name undefined: "+p;var y=S,l=r(t,0,[1]);return s.hashAlg=y,s.hashValue=n(t,l),s};(typeof a=="undefined"||!a)&&(a={});(typeof a.asn1=="undefined"||!a.asn1)&&(a.asn1={});(typeof a.asn1.cades=="undefined"||!a.asn1.cades)&&(a.asn1.cades={});a.asn1.cades.SignaturePolicyIdentifier=function(t){var e=a,i=e.asn1,n=i.DERObjectIdentifier,r=i.DERSequence,s=i.cades,o=s.OtherHashAlgAndValue;if(s.SignaturePolicyIdentifier.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.15",t!==void 0&&typeof t.oid=="string"&&typeof t.hash=="object"){var h=new n({oid:t.oid}),g=new o(t.hash),p=new r({array:[h,g]});this.valueList=[p]}};H.lang.extend(a.asn1.cades.SignaturePolicyIdentifier,a.asn1.cms.Attribute);a.asn1.cades.OtherHashAlgAndValue=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.DEROctetString,s=i.x509,o=s.AlgorithmIdentifier,h=i.cades,g=h.OtherHashAlgAndValue;g.superclass.constructor.call(this),this.dAlg=null,this.dHash=null,this.getEncodedHex=function(){var p=new n({array:[this.dAlg,this.dHash]});return this.hTLV=p.getEncodedHex(),this.hTLV},t!==void 0&&typeof t.alg=="string"&&typeof t.hash=="string"&&(this.dAlg=new o({name:t.alg}),this.dHash=new r({hex:t.hash}))};H.lang.extend(a.asn1.cades.OtherHashAlgAndValue,a.asn1.ASN1Object);a.asn1.cades.SignatureTimeStamp=function(t){var e=a,i=e.asn1,n=i.ASN1Object,r=i.x509,s=i.cades;if(s.SignatureTimeStamp.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.14",this.tstHex=null,t!==void 0){if(t.res!==void 0&&!(typeof t.res=="string"&&t.res.match(/^[0-9A-Fa-f]+$/))){if(!(t.res instanceof n))throw"res param shall be ASN1Object or hex string"}if(t.tst!==void 0){if(typeof t.tst=="string"&&t.tst.match(/^[0-9A-Fa-f]+$/)){var o=new n;this.tstHex=t.tst,o.hTLV=this.tstHex,o.getEncodedHex(),this.valueList=[o]}else if(!(t.tst instanceof n))throw"tst param shall be ASN1Object or hex string"}}};H.lang.extend(a.asn1.cades.SignatureTimeStamp,a.asn1.cms.Attribute);a.asn1.cades.CompleteCertificateRefs=function(t){var e=a,i=e.asn1,n=i.cades;n.CompleteCertificateRefs.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.21",this.setByArray=function(r){this.valueList=[];for(var s=0;s<r.length;s++){var o=new n.OtherCertID(r[s]);this.valueList.push(o)}},t!==void 0&&typeof t=="object"&&typeof t.length=="number"&&this.setByArray(t)};H.lang.extend(a.asn1.cades.CompleteCertificateRefs,a.asn1.cms.Attribute);a.asn1.cades.OtherCertID=function(t){var e=a,i=e.asn1,n=i.cms,r=i.cades;r.OtherCertID.superclass.constructor.call(this),this.hasIssuerSerial=!0,this.dOtherCertHash=null,this.dIssuerSerial=null,this.setByCertPEM=function(s){this.dOtherCertHash=new r.OtherHash(s),this.hasIssuerSerial&&(this.dIssuerSerial=new n.IssuerAndSerialNumber(s))},this.getEncodedHex=function(){if(this.hTLV!=null)return this.hTLV;if(this.dOtherCertHash==null)throw"otherCertHash not set";var s=[this.dOtherCertHash];this.dIssuerSerial!=null&&s.push(this.dIssuerSerial);var o=new i.DERSequence({array:s});return this.hTLV=o.getEncodedHex(),this.hTLV},t!==void 0&&(typeof t=="string"&&t.indexOf("-----BEGIN ")!=-1&&this.setByCertPEM(t),typeof t=="object"&&(t.hasis===!1&&(this.hasIssuerSerial=!1),typeof t.cert=="string"&&this.setByCertPEM(t.cert)))};H.lang.extend(a.asn1.cades.OtherCertID,a.asn1.ASN1Object);a.asn1.cades.OtherHash=function(t){var e=a,i=e.asn1,n=i.cms,r=i.cades,s=r.OtherHashAlgAndValue,o=e.crypto.Util.hashHex;if(r.OtherHash.superclass.constructor.call(this),this.alg="sha256",this.dOtherHash=null,this.setByCertPEM=function(h){if(h.indexOf("-----BEGIN ")==-1)throw"certPEM not to seem PEM format";var g=at(h),p=o(g,this.alg);this.dOtherHash=new s({alg:this.alg,hash:p})},this.getEncodedHex=function(){if(this.dOtherHash==null)throw"OtherHash not set";return this.dOtherHash.getEncodedHex()},t!==void 0)if(typeof t=="string")if(t.indexOf("-----BEGIN ")!=-1)this.setByCertPEM(t);else if(t.match(/^[0-9A-Fa-f]+$/))this.dOtherHash=new i.DEROctetString({hex:t});else throw"unsupported string value for params";else typeof t=="object"&&(typeof t.cert=="string"?(typeof t.alg=="string"&&(this.alg=t.alg),this.setByCertPEM(t.cert)):this.dOtherHash=new s(t))};H.lang.extend(a.asn1.cades.OtherHash,a.asn1.ASN1Object);a.asn1.cades.CAdESUtil=new function(){};a.asn1.cades.CAdESUtil.addSigTS=function(t,e,i){};a.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(t){var e=j,i=e.getChildIdx,n=e.getTLV,r=e.getTLVbyList,s=e.getIdxbyList,o=a,h=o.asn1,g=h.ASN1Object,p=h.cms,S=p.SignedData,y=h.cades,l=y.CAdESUtil,f={};if(r(t,0,[0])!="06092a864886f70d010702")throw"hex is not CMS SignedData";var c=s(t,0,[1,0]),u=i(t,c);if(u.length<4)throw"num of SignedData elem shall be 4 at least";var d=u.shift();f.version=n(t,d);var v=u.shift();f.algs=n(t,v);var m=u.shift();f.encapcontent=n(t,m),f.certs=null,f.revs=null,f.si=[];var F=u.shift();t.substr(F,2)=="a0"&&(f.certs=n(t,F),F=u.shift()),t.substr(F,2)=="a1"&&(f.revs=n(t,F),F=u.shift());var x=F;if(t.substr(x,2)!="31")throw"Can't find signerInfos";for(var E=i(t,x),w=0;w<E.length;w++){var B=E[w],I=l.parseSignerInfoForAddingUnsigned(t,B,w);f.si[w]=I}var P=null;f.obj=new S,P=new g,P.hTLV=f.version,f.obj.dCMSVersion=P,P=new g,P.hTLV=f.algs,f.obj.dDigestAlgs=P,P=new g,P.hTLV=f.encapcontent,f.obj.dEncapContentInfo=P,P=new g,P.hTLV=f.certs,f.obj.dCerts=P,f.obj.signerInfoList=[];for(var w=0;w<f.si.length;w++)f.obj.signerInfoList.push(f.si[w].obj);return f};a.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(t,e,i){var n=j,r=n.getChildIdx,s=n.getTLV,o=n.getV,h=a,g=h.asn1,p=g.ASN1Object,S=g.cms,y=S.AttributeList,l=S.SignerInfo,f={},c=r(t,e);if(c.length!=6)throw"not supported items for SignerInfo (!=6)";var u=c.shift();f.version=s(t,u);var d=c.shift();f.si=s(t,d);var v=c.shift();f.digalg=s(t,v);var m=c.shift();f.sattrs=s(t,m);var F=c.shift();f.sigalg=s(t,F);var x=c.shift();f.sig=s(t,x),f.sigval=o(t,x);var E=null;return f.obj=new l,E=new p,E.hTLV=f.version,f.obj.dCMSVersion=E,E=new p,E.hTLV=f.si,f.obj.dSignerIdentifier=E,E=new p,E.hTLV=f.digalg,f.obj.dDigestAlgorithm=E,E=new p,E.hTLV=f.sattrs,f.obj.dSignedAttrs=E,E=new p,E.hTLV=f.sigalg,f.obj.dSigAlg=E,E=new p,E.hTLV=f.sig,f.obj.dSig=E,f.obj.dUnsignedAttrs=new y,f};(typeof a.asn1.csr=="undefined"||!a.asn1.csr)&&(a.asn1.csr={});a.asn1.csr.CertificationRequest=function(t){var e=a,i=e.asn1,n=i.DERBitString,r=i.DERSequence,s=i.csr,o=i.x509;s.CertificationRequest.superclass.constructor.call(this);var h=null,g=null,p=null,S=null,y=null;this.sign=function(l,f){this.prvKey==null&&(this.prvKey=f),this.asn1SignatureAlg=new o.AlgorithmIdentifier({name:l}),sig=new e.crypto.Signature({alg:l}),sig.init(this.prvKey),sig.updateHex(this.asn1CSRInfo.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new n({hex:"00"+this.hexSig});var c=new r({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=c.getEncodedHex(),this.isModified=!1},this.getPEMString=function(){return ht(this.getEncodedHex(),"CERTIFICATE REQUEST")},this.getEncodedHex=function(){if(this.isModified==!1&&this.hTLV!=null)return this.hTLV;throw"not signed yet"},t!==void 0&&t.csrinfo!==void 0&&(this.asn1CSRInfo=t.csrinfo)};H.lang.extend(a.asn1.csr.CertificationRequest,a.asn1.ASN1Object);a.asn1.csr.CertificationRequestInfo=function(t){var e=a,i=e.asn1,n=i.DERInteger,r=i.DERSequence,s=i.DERSet,o=i.DERNull,h=i.DERTaggedObject,g=i.DERObjectIdentifier,p=i.csr,S=i.x509,y=S.X500Name,l=S.Extension,f=Q;p.CertificationRequestInfo.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new n({int:0}),this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSubjectByParam=function(c){this.asn1Subject=new y(c)},this.setSubjectPublicKeyByGetKey=function(c){var u=f.getKey(c);this.asn1SubjPKey=new S.SubjectPublicKeyInfo(u)},this.appendExtensionByName=function(c,u){l.appendByNameToArray(c,u,this.extensionsArray)},this.getEncodedHex=function(){if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var c=new r({array:this.extensionsArray}),u=new s({array:[c]}),d=new r({array:[new g({oid:"1.2.840.113549.1.9.14"}),u]}),v=new h({explicit:!0,tag:"a0",obj:d});this.asn1Array.push(v)}else{var v=new h({explicit:!1,tag:"a0",obj:new o});this.asn1Array.push(v)}var m=new r({array:this.asn1Array});return this.hTLV=m.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()};H.lang.extend(a.asn1.csr.CertificationRequestInfo,a.asn1.ASN1Object);a.asn1.csr.CSRUtil=new function(){};a.asn1.csr.CSRUtil.newCSRPEM=function(t){var e=Q,i=a.asn1.csr;if(t.subject===void 0)throw"parameter subject undefined";if(t.sbjpubkey===void 0)throw"parameter sbjpubkey undefined";if(t.sigalg===void 0)throw"parameter sigalg undefined";if(t.sbjprvkey===void 0)throw"parameter sbjpubkey undefined";var n=new i.CertificationRequestInfo;if(n.setSubjectByParam(t.subject),n.setSubjectPublicKeyByGetKey(t.sbjpubkey),t.ext!==void 0&&t.ext.length!==void 0)for(var r=0;r<t.ext.length;r++)for(key in t.ext[r])n.appendExtensionByName(key,t.ext[r][key]);var s=new i.CertificationRequest({csrinfo:n}),o=e.getKey(t.sbjprvkey);s.sign(t.sigalg,o);var h=s.getPEMString();return h};a.asn1.csr.CSRUtil.getInfo=function(t){var e=j,i=e.getTLVbyList,n={};if(n.subject={},n.pubkey={},t.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw"argument is not PEM file";var r=at(t,"CERTIFICATE REQUEST");return n.subject.hex=i(r,0,[0,1]),n.subject.name=X.hex2dn(n.subject.hex),n.pubkey.hex=i(r,0,[0,2]),n.pubkey.obj=Q.getKey(n.pubkey.hex,null,"pkcs8pub"),n};(typeof a=="undefined"||!a)&&(a={});(typeof a.asn1=="undefined"||!a.asn1)&&(a.asn1={});(typeof a.asn1.ocsp=="undefined"||!a.asn1.ocsp)&&(a.asn1.ocsp={});a.asn1.ocsp.DEFAULT_HASH="sha1";a.asn1.ocsp.CertID=function(t){var e=a,i=e.asn1,n=i.DEROctetString,r=i.DERInteger,s=i.DERSequence,o=i.x509,h=o.AlgorithmIdentifier,g=i.ocsp,p=g.DEFAULT_HASH,S=e.crypto,y=S.Util.hashHex,l=X,f=j;if(g.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(d,v,m,F){F===void 0&&(F=p),this.dHashAlg=new h({name:F}),this.dIssuerNameHash=new n({hex:d}),this.dIssuerKeyHash=new n({hex:v}),this.dSerialNumber=new r({hex:m})},this.setByCert=function(d,v,m){m===void 0&&(m=p);var F=new l;F.readCertPEM(v);var x=new l;x.readCertPEM(d);var E=x.getPublicKeyHex(),w=f.getTLVbyList(E,0,[1,0],"30"),B=F.getSerialNumberHex(),I=y(x.getSubjectHex(),m),P=y(w,m);this.setByValue(I,P,B,m),this.hoge=F.getSerialNumberHex()},this.getEncodedHex=function(){if(this.dHashAlg===null&&this.dIssuerNameHash===null&&this.dIssuerKeyHash===null&&this.dSerialNumber===null)throw"not yet set values";var d=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],v=new s({array:d});return this.hTLV=v.getEncodedHex(),this.hTLV},t!==void 0){var c=t;if(c.issuerCert!==void 0&&c.subjectCert!==void 0){var u=p;c.alg===void 0&&(u=void 0),this.setByCert(c.issuerCert,c.subjectCert,u)}else if(c.namehash!==void 0&&c.keyhash!==void 0&&c.serial!==void 0){var u=p;c.alg===void 0&&(u=void 0),this.setByValue(c.namehash,c.keyhash,c.serial,u)}else throw"invalid constructor arguments"}};H.lang.extend(a.asn1.ocsp.CertID,a.asn1.ASN1Object);a.asn1.ocsp.Request=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.ocsp;if(r.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.getEncodedHex=function(){var o=[];if(this.dReqCert===null)throw"reqCert not set";o.push(this.dReqCert);var h=new n({array:o});return this.hTLV=h.getEncodedHex(),this.hTLV},typeof t!="undefined"){var s=new r.CertID(t);this.dReqCert=s}};H.lang.extend(a.asn1.ocsp.Request,a.asn1.ASN1Object);a.asn1.ocsp.TBSRequest=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.ocsp;r.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(s){for(var o=[],h=0;h<s.length;h++){var g=new r.Request(s[0]);o.push(g)}this.dRequestList=o},this.getEncodedHex=function(){var s=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var o=new n({array:this.dRequestList});if(s.push(o),this.dRequestExt!==null)throw"requestExtensions not supported";var h=new n({array:s});return this.hTLV=h.getEncodedHex(),this.hTLV},t!==void 0&&t.reqList!==void 0&&this.setRequestListByParam(t.reqList)};H.lang.extend(a.asn1.ocsp.TBSRequest,a.asn1.ASN1Object);a.asn1.ocsp.OCSPRequest=function(t){var e=a,i=e.asn1,n=i.DERSequence,r=i.ocsp;if(r.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.getEncodedHex=function(){var o=[];if(this.dTbsRequest!==null)o.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var h=new n({array:o});return this.hTLV=h.getEncodedHex(),this.hTLV},t!==void 0&&t.reqList!==void 0){var s=new r.TBSRequest(t);this.dTbsRequest=s}};H.lang.extend(a.asn1.ocsp.OCSPRequest,a.asn1.ASN1Object);a.asn1.ocsp.OCSPUtil={};a.asn1.ocsp.OCSPUtil.getRequestHex=function(t,e,i){var n=a,r=n.asn1,s=r.ocsp;i===void 0&&(i=s.DEFAULT_HASH);var o={alg:i,issuerCert:t,subjectCert:e},h=new s.OCSPRequest({reqList:[o]});return h.getEncodedHex()};a.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(t){var e=j,n=e.getVbyList,i=e.getIdxbyList,n=e.getVbyList,r=e.getV,s={};try{var o=n(t,0,[0],"0a");s.responseStatus=parseInt(o,16)}catch(S){}if(s.responseStatus!==0)return s;try{var h=i(t,0,[1,0,1,0,0,2,0,1]);t.substr(h,2)==="80"?s.certStatus="good":t.substr(h,2)==="a1"?(s.certStatus="revoked",s.revocationTime=tt(n(t,h,[0]))):t.substr(h,2)==="82"&&(s.certStatus="unknown")}catch(S){}try{var g=i(t,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=tt(r(t,g))}catch(S){}try{var p=i(t,0,[1,0,1,0,0,2,0,3]);t.substr(p,2)==="a0"&&(s.nextUpdate=tt(n(t,p,[0])))}catch(S){}return s};var a;(typeof a=="undefined"||!a)&&(a={});(typeof a.lang=="undefined"||!a.lang)&&(a.lang={});a.lang.String=function(){};function or(t){for(var e=new Array,i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e}function re(t){for(var e="",i=0;i<t.length;i++){var n=t[i].toString(16);n.length==1&&(n="0"+n),e=e+n}return e}function Rt(t){return re(or(t))}function me(t){return t=t.replace(/\=/g,""),t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t}function se(t){return t.length%4==2?t=t+"==":t.length%4==3&&(t=t+"="),t=t.replace(/-/g,"+"),t=t.replace(/_/g,"/"),t}function et(t){return t.length%2==1&&(t="0"+t),me(ce(t))}function Z(t){return te(se(t))}var qt,St;typeof Buffer=="function"?(qt=function(t){return me(new Buffer(t,"utf8").toString("base64"))},St=function(t){return new Buffer(se(t),"base64").toString("utf8")}):(qt=function(t){return et(Fe(Ee(t)))},St=function(t){return decodeURIComponent(xe(Z(t)))});function Ut(t){return Fe(Ee(t))}function tt(t){return decodeURIComponent(xe(t))}function At(t){for(var e="",i=0;i<t.length-1;i+=2)e+=String.fromCharCode(parseInt(t.substr(i,2),16));return e}function mt(t){for(var e="",i=0;i<t.length;i++)e+=("0"+t.charCodeAt(i).toString(16)).slice(-2);return e}function hr(t){return ce(t)}function ae(t){var e=hr(t),i=e.replace(/(.{64})/g,`$1\r
`);return i=i.replace(/\r\n$/,""),i}function ur(t){var e=t.replace(/[^0-9A-Za-z\/+=]*/g,""),i=te(e);return i}function ht(t,e){var i=ae(t);return"-----BEGIN "+e+`-----\r
`+i+`\r
-----END `+e+`-----\r
`}function at(t,e){if(t.indexOf("-----BEGIN ")==-1)throw"can't find PEM header: "+e;return e!==void 0?(t=t.replace(new RegExp("^[^]*-----BEGIN "+e+"-----"),""),t=t.replace(new RegExp("-----END "+e+"-----[^]*$"),"")):(t=t.replace(/^[^]*-----BEGIN [^-]+-----/,""),t=t.replace(/-----END [^-]+-----[^]*$/,"")),ur(t)}function fr(t){var e,i,n,r,s,o,h,g,p,S,y,l;if(l=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),l)return p=l[1],e=parseInt(p),p.length===2&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),i=parseInt(l[2])-1,n=parseInt(l[3]),r=parseInt(l[4]),s=parseInt(l[5]),o=parseInt(l[6]),h=0,S=l[7],S!==""&&(y=(S.substr(1)+"00").substr(0,3),h=parseInt(y)),Date.UTC(e,i,n,r,s,o,h);throw"unsupported zulu format: "+t}function lr(t){var e=fr(t);return~~(e/1e3)}function Fe(t){return t.replace(/%/g,"")}function xe(t){return t.replace(/(..)/g,"%$1")}function cr(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;t=t.toLowerCase();var i=t.split(":").length-1;if(i<2)throw e;var n=":".repeat(7-i+2);t=t.replace("::",n);var r=t.split(":");if(r.length!=8)throw e;for(var s=0;s<8;s++)r[s]=("0000"+r[s]).slice(-4);return r.join("")}function dr(t){if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";t=t.toLowerCase();for(var e=t.match(/.{1,4}/g),i=0;i<8;i++)e[i]=e[i].replace(/^0+/,""),e[i]==""&&(e[i]="0");t=":"+e.join(":")+":";var n=t.match(/:(0:){2,}/g);if(n===null)return t.slice(1,-1);for(var r="",i=0;i<n.length;i++)n[i].length>r.length&&(r=n[i]);return t=t.replace(r,"::"),t.slice(1,-1)}function gr(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(t.length==8){var i;try{return i=parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16),i}catch(n){throw e}}else return t.length==32?dr(t):t}function Ee(t){for(var e=encodeURIComponent(t),i="",n=0;n<e.length;n++)e[n]=="%"?(i=i+e.substr(n,3),n=n+2):i=i+"%"+Rt(e[n]);return i}a.lang.String.isInteger=function(t){return t.match(/^[0-9]+$/)?!0:!!t.match(/^-[0-9]+$/)};a.lang.String.isHex=function(t){return!!(t.length%2==0&&(t.match(/^[0-9a-f]+$/)||t.match(/^[0-9A-F]+$/)))};a.lang.String.isBase64=function(t){return t=t.replace(/\s+/g,""),!!(t.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&t.length%4==0)};a.lang.String.isBase64URL=function(t){return t.match(/[+/=]/)?!1:(t=se(t),a.lang.String.isBase64(t))};a.lang.String.isIntegerArray=function(t){return t=t.replace(/\s+/g,""),!!t.match(/^\[[0-9,]+\]$/)};function le(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}function pr(t){t=t.replace(/^\s*\[\s*/,""),t=t.replace(/\s*\]\s*$/,""),t=t.replace(/\s*/g,"");try{var e=t.split(/,/).map(function(i,n,r){var s=parseInt(i);if(s<0||255<s)throw"integer not in range 0-255";var o=("00"+s.toString(16)).slice(-2);return o}).join("");return e}catch(i){throw"malformed integer array string: "+i}}(typeof a=="undefined"||!a)&&(a={});(typeof a.crypto=="undefined"||!a.crypto)&&(a.crypto={});a.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:V.algo.MD5,sha1:V.algo.SHA1,sha224:V.algo.SHA224,sha256:V.algo.SHA256,sha384:V.algo.SHA384,sha512:V.algo.SHA512,ripemd160:V.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(typeof this.DIGESTINFOHEAD[e]=="undefined")throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,i){var n=this.getDigestInfoHex(t,e),r=i/4;if(n.length+22>r)throw"key is too short for SigAlg: keylen="+i+","+e;for(var s="0001",o="00"+n,h="",g=r-s.length-o.length,p=0;p<g;p+=2)h+="ff";var S=s+h+o;return S},this.hashString=function(t,e){var i=new a.crypto.MessageDigest({alg:e});return i.digestString(t)},this.hashHex=function(t,e){var i=new a.crypto.MessageDigest({alg:e});return i.digestHex(t)},this.sha1=function(t){var e=new a.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return e.digestString(t)},this.sha256=function(t){var e=new a.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return e.digestString(t)},this.sha256Hex=function(t){var e=new a.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return e.digestHex(t)},this.sha512=function(t){var e=new a.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return e.digestString(t)},this.sha512Hex=function(t){var e=new a.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return e.digestHex(t)}};a.crypto.Util.md5=function(t){var e=new a.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return e.digestString(t)};a.crypto.Util.ripemd160=function(t){var e=new a.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return e.digestString(t)};a.crypto.Util.SECURERANDOMGEN=new Bt;a.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return a.crypto.Util.SECURERANDOMGEN.nextBytes(e),re(e)};a.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new b(a.crypto.Util.getRandomHexOfNbytes(t),16)};a.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,i=(t-e)/8,n=new Array(i+1);return a.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<e&255^255)&n[0],re(n)};a.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new b(a.crypto.Util.getRandomHexOfNbits(t),16)};a.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var i=a.crypto.Util.getRandomBigIntegerOfNbits(e);if(t.compareTo(i)!=-1)return i}};a.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var i=t.compareTo(e);if(i==1)throw"biMin is greater than biMax";if(i==0)return t;var n=e.subtract(t),r=a.crypto.Util.getRandomBigIntegerZeroToMax(n);return r.add(t)};a.crypto.MessageDigest=function(t){var e=null,i=null,n=null;this.setAlgAndProvider=function(r,s){if(r=a.crypto.MessageDigest.getCanonicalAlgName(r),r!==null&&s===void 0&&(s=a.crypto.Util.DEFAULTPROVIDER[r]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)!=-1&&s=="cryptojs"){try{this.md=a.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r].create()}catch(o){throw"setAlgAndProvider hash alg set fail alg="+r+"/"+o}this.updateString=function(o){this.md.update(o)},this.updateHex=function(o){var h=V.enc.Hex.parse(o);this.md.update(h)},this.digest=function(){var o=this.md.finalize();return o.toString(V.enc.Hex)},this.digestString=function(o){return this.updateString(o),this.digest()},this.digestHex=function(o){return this.updateHex(o),this.digest()}}if(":sha256:".indexOf(r)!=-1&&s=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(o){throw"setAlgAndProvider hash alg set fail alg="+r+"/"+o}this.updateString=function(o){this.md.update(o)},this.updateHex=function(o){var h=sjcl.codec.hex.toBits(o);this.md.update(h)},this.digest=function(){var o=this.md.finalize();return sjcl.codec.hex.fromBits(o)},this.digestString=function(o){return this.updateString(o),this.digest()},this.digestHex=function(o){return this.updateHex(o),this.digest()}}},this.updateString=function(r){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(r){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(r){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(r){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},t!==void 0&&t.alg!==void 0&&(this.algName=t.alg,t.prov===void 0&&(this.provName=a.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};a.crypto.MessageDigest.getCanonicalAlgName=function(t){return typeof t=="string"&&(t=t.toLowerCase(),t=t.replace(/-/,"")),t};a.crypto.MessageDigest.getHashLength=function(t){var e=a.crypto.MessageDigest,i=e.getCanonicalAlgName(t);if(e.HASHLENGTH[i]===void 0)throw"not supported algorithm: "+t;return e.HASHLENGTH[i]};a.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};a.crypto.Mac=function(t){var e=null,i=null,n=null,r=null,s=null;this.setAlgAndProvider=function(o,h){if(o=o.toLowerCase(),o==null&&(o="hmacsha1"),o=o.toLowerCase(),o.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+o;h===void 0&&(h=a.crypto.Util.DEFAULTPROVIDER[o]),this.algProv=o+"/"+h;var g=o.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(g)!=-1&&h=="cryptojs"){try{var p=a.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[g];this.mac=V.algo.HMAC.create(p,this.pass)}catch(S){throw"setAlgAndProvider hash alg set fail hashAlg="+g+"/"+S}this.updateString=function(S){this.mac.update(S)},this.updateHex=function(S){var y=V.enc.Hex.parse(S);this.mac.update(y)},this.doFinal=function(){var S=this.mac.finalize();return S.toString(V.enc.Hex)},this.doFinalString=function(S){return this.updateString(S),this.doFinal()},this.doFinalHex=function(S){return this.updateHex(S),this.doFinal()}}},this.updateString=function(o){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(o){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(o){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(o){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(o){if(typeof o=="string"){var h=o;(o.length%2==1||!o.match(/^[0-9A-Fa-f]+$/))&&(h=mt(o)),this.pass=V.enc.Hex.parse(h);return}if(typeof o!="object")throw"KJUR.crypto.Mac unsupported password type: "+o;var h=null;if(o.hex!==void 0){if(o.hex.length%2!=0||!o.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+o.hex;h=o.hex}if(o.utf8!==void 0&&(h=Ut(o.utf8)),o.rstr!==void 0&&(h=mt(o.rstr)),o.b64!==void 0&&(h=te(o.b64)),o.b64u!==void 0&&(h=Z(o.b64u)),h==null)throw"KJUR.crypto.Mac unsupported password type: "+o;this.pass=V.enc.Hex.parse(h)},t!==void 0&&(t.pass!==void 0&&this.setPassword(t.pass),t.alg!==void 0&&(this.algName=t.alg,t.prov===void 0&&(this.provName=a.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))};a.crypto.Signature=function(t){var e=null,i=null,n=null,r=null,s=null,o=null,h=null,g=null,p=null,S=null,y=-1,l=null,f=null,c=null,u=null,d=null;if(this._setAlgNames=function(){var v=this.algName.match(/^(.+)with(.+)$/);v&&(this.mdAlgName=v[1].toLowerCase(),this.pubkeyAlgName=v[2].toLowerCase())},this._zeroPaddingOfSignature=function(v,m){for(var F="",x=m/4-v.length,E=0;E<x;E++)F=F+"0";return F+v},this.setAlgAndProvider=function(v,m){if(this._setAlgNames(),m!="cryptojs/jsrsa")throw"provider not supported: "+m;if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new a.crypto.MessageDigest({alg:this.mdAlgName})}catch(F){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+F}this.init=function(F,x){var E=null;try{x===void 0?E=Q.getKey(F):E=Q.getKey(F,x)}catch(w){throw"init failed:"+w}if(E.isPrivate===!0)this.prvKey=E,this.state="SIGN";else if(E.isPublic===!0)this.pubKey=E,this.state="VERIFY";else throw"init failed.:"+E},this.updateString=function(F){this.md.updateString(F)},this.updateHex=function(F){this.md.updateHex(F)},this.sign=function(){if(this.sHashHex=this.md.digest(),typeof this.ecprvhex!="undefined"&&typeof this.eccurvename!="undefined"){var F=new a.crypto.ECDSA({curve:this.eccurvename});this.hSign=F.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof K&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof K&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof a.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof a.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(F){return this.updateString(F),this.sign()},this.signHex=function(F){return this.updateHex(F),this.sign()},this.verify=function(F){if(this.sHashHex=this.md.digest(),typeof this.ecpubhex!="undefined"&&typeof this.eccurvename!="undefined"){var x=new a.crypto.ECDSA({curve:this.eccurvename});return x.verifyHex(this.sHashHex,F,this.ecpubhex)}else{if(this.pubKey instanceof K&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,F,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof K&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,F);if(a.crypto.ECDSA!==void 0&&this.pubKey instanceof a.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,F);if(a.crypto.DSA!==void 0&&this.pubKey instanceof a.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,F);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}},this.init=function(v,m){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(v){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(v){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(v){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(v){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(v){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,t!==void 0&&(t.alg!==void 0&&(this.algName=t.alg,t.prov===void 0?this.provName=a.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),t.psssaltlen!==void 0&&(this.pssSaltLen=t.psssaltlen),t.prvkeypem!==void 0)){if(t.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var e=Q.getKey(t.prvkeypem);this.init(e)}catch(v){throw"fatal error to load pem private key: "+v}}};a.crypto.Cipher=function(t){};a.crypto.Cipher.encrypt=function(t,e,i){if(e instanceof K&&e.isPublic){var n=a.crypto.Cipher.getAlgByKeyAndName(e,i);if(n==="RSA")return e.encrypt(t);if(n==="RSAOAEP")return e.encryptOAEP(t,"sha1");var r=n.match(/^RSAOAEP(\d+)$/);if(r!==null)return e.encryptOAEP(t,"sha"+r[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+i}else throw"Cipher.encrypt: unsupported key or algorithm"};a.crypto.Cipher.decrypt=function(t,e,i){if(e instanceof K&&e.isPrivate){var n=a.crypto.Cipher.getAlgByKeyAndName(e,i);if(n==="RSA")return e.decrypt(t);if(n==="RSAOAEP")return e.decryptOAEP(t,"sha1");var r=n.match(/^RSAOAEP(\d+)$/);if(r!==null)return e.decryptOAEP(t,"sha"+r[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+i}else throw"Cipher.decrypt: unsupported key or algorithm"};a.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof K){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e)!=-1)return e;if(e==null)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e};a.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};(typeof a=="undefined"||!a)&&(a={});(typeof a.crypto=="undefined"||!a.crypto)&&(a.crypto={});a.crypto.ECDSA=function(t){var e="secp256r1",i=null,n=null,r=null,s=b,o=J,h=a.crypto.ECDSA,g=a.crypto.ECParameterDB,p=new Bt,S=null;this.type="EC",this.isPrivate=!1,this.isPublic=!1;function y(l,f,c,u){for(var d=Math.max(f.bitLength(),u.bitLength()),v=l.add2D(c),m=l.curve.getInfinity(),F=d-1;F>=0;--F)m=m.twice2D(),m.z=s.ONE,f.testBit(F)?u.testBit(F)?m=m.add2D(v):m=m.add2D(l):u.testBit(F)&&(m=m.add2D(c));return m}this.getBigRandom=function(l){return new s(l.bitLength(),p).mod(l.subtract(s.ONE)).add(s.ONE)},this.setNamedCurve=function(l){this.ecparams=g.getByName(l),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=l},this.setPrivateKeyHex=function(l){this.isPrivate=!0,this.prvKeyHex=l},this.setPublicKeyHex=function(l){this.isPublic=!0,this.pubKeyHex=l},this.getPublicKeyXYHex=function(){var l=this.pubKeyHex;if(l.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var f=this.ecparams.keylen/4;if(l.length!==2+f*2)throw"malformed public key hex length";var c={};return c.x=l.substr(2,f),c.y=l.substr(2+f),c},this.getShortNISTPCurveName=function(){var l=this.curveName;return l==="secp256r1"||l==="NIST P-256"||l==="P-256"||l==="prime256v1"?"P-256":l==="secp384r1"||l==="NIST P-384"||l==="P-384"?"P-384":null},this.generateKeyPairHex=function(){var l=this.ecparams.n,f=this.getBigRandom(l),c=this.ecparams.G.multiply(f),u=c.getX().toBigInteger(),d=c.getY().toBigInteger(),v=this.ecparams.keylen/4,m=("0000000000"+f.toString(16)).slice(-v),F=("0000000000"+u.toString(16)).slice(-v),x=("0000000000"+d.toString(16)).slice(-v),E="04"+F+x;return this.setPrivateKeyHex(m),this.setPublicKeyHex(E),{ecprvhex:m,ecpubhex:E}},this.signWithMessageHash=function(l){return this.signHex(l,this.prvKeyHex)},this.signHex=function(l,f){var c=new s(f,16),u=this.ecparams.n,d=new s(l.substring(0,this.ecparams.keylen/4),16);do var v=this.getBigRandom(u),m=this.ecparams.G,F=m.multiply(v),x=F.getX().toBigInteger().mod(u);while(x.compareTo(s.ZERO)<=0);var E=v.modInverse(u).multiply(d.add(c.multiply(x))).mod(u);return h.biRSSigToASN1Sig(x,E)},this.sign=function(l,f){var c=f,u=this.ecparams.n,d=s.fromByteArrayUnsigned(l);do var v=this.getBigRandom(u),m=this.ecparams.G,F=m.multiply(v),x=F.getX().toBigInteger().mod(u);while(x.compareTo(b.ZERO)<=0);var E=v.modInverse(u).multiply(d.add(c.multiply(x))).mod(u);return this.serializeSig(x,E)},this.verifyWithMessageHash=function(l,f){return this.verifyHex(l,f,this.pubKeyHex)},this.verifyHex=function(l,f,c){var u,d,v=h.parseSigHex(f);u=v.r,d=v.s;var m=o.decodeFromHex(this.ecparams.curve,c),F=new s(l.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(F,u,d,m)},this.verify=function(l,f,c){var u,d;if(Bitcoin.Util.isArray(f)){var v=this.parseSig(f);u=v.r,d=v.s}else if(typeof f=="object"&&f.r&&f.s)u=f.r,d=f.s;else throw"Invalid value for signature";var m;if(c instanceof J)m=c;else if(Bitcoin.Util.isArray(c))m=o.decodeFrom(this.ecparams.curve,c);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var F=s.fromByteArrayUnsigned(l);return this.verifyRaw(F,u,d,m)},this.verifyRaw=function(l,f,c,u){var d=this.ecparams.n,v=this.ecparams.G;if(f.compareTo(s.ONE)<0||f.compareTo(d)>=0||c.compareTo(s.ONE)<0||c.compareTo(d)>=0)return!1;var m=c.modInverse(d),F=l.multiply(m).mod(d),x=f.multiply(m).mod(d),E=v.multiply(F).add(u.multiply(x)),w=E.getX().toBigInteger().mod(d);return w.equals(f)},this.serializeSig=function(l,f){var c=l.toByteArraySigned(),u=f.toByteArraySigned(),d=[];return d.push(2),d.push(c.length),d=d.concat(c),d.push(2),d.push(u.length),d=d.concat(u),d.unshift(d.length),d.unshift(48),d},this.parseSig=function(l){var f;if(l[0]!=48)throw new Error("Signature not a valid DERSequence");if(f=2,l[f]!=2)throw new Error("First element in signature must be a DERInteger");var c=l.slice(f+2,f+2+l[f+1]);if(f+=2+l[f+1],l[f]!=2)throw new Error("Second element in signature must be a DERInteger");var u=l.slice(f+2,f+2+l[f+1]);f+=2+l[f+1];var d=s.fromByteArrayUnsigned(c),v=s.fromByteArrayUnsigned(u);return{r:d,s:v}},this.parseSigCompact=function(l){if(l.length!==65)throw"Signature has the wrong length";var f=l[0]-27;if(f<0||f>7)throw"Invalid signature type";var c=this.ecparams.n,u=s.fromByteArrayUnsigned(l.slice(1,33)).mod(c),d=s.fromByteArrayUnsigned(l.slice(33,65)).mod(c);return{r:u,s:d,i:f}},this.readPKCS5PrvKeyHex=function(l){var f=j,c=h.getName,u=f.getVbyList;if(f.isASN1HEX(l)===!1)throw"not ASN.1 hex string";var d,v,m;try{d=u(l,0,[2,0],"06"),v=u(l,0,[1],"04");try{m=u(l,0,[3,0],"03").substr(2)}catch(F){}}catch(F){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=c(d),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(m),this.setPrivateKeyHex(v),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(l){var f=j,c=a.crypto.ECDSA.getName,u=f.getVbyList;if(f.isASN1HEX(l)===!1)throw"not ASN.1 hex string";var d,v,m,F;try{d=u(l,0,[1,0],"06"),v=u(l,0,[1,1],"06"),m=u(l,0,[2,0,1],"04");try{F=u(l,0,[2,0,2,0],"03").substr(2)}catch(x){}}catch(x){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=c(v),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(F),this.setPrivateKeyHex(m),this.isPublic=!1},this.readPKCS8PubKeyHex=function(l){var f=j,c=a.crypto.ECDSA.getName,u=f.getVbyList;if(f.isASN1HEX(l)===!1)throw"not ASN.1 hex string";var d,v,m;try{d=u(l,0,[0,0],"06"),v=u(l,0,[0,1],"06"),m=u(l,0,[1],"03").substr(2)}catch(F){throw"malformed PKCS#8 ECC public key"}if(this.curveName=c(v),this.curveName===null)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(m)},this.readCertPubKeyHex=function(l,f){f!==5&&(f=6);var c=j,u=h.getName,d=c.getVbyList;if(c.isASN1HEX(l)===!1)throw"not ASN.1 hex string";var v,m;try{v=d(l,0,[0,f,0,1],"06"),m=d(l,0,[0,f,1],"03").substr(2)}catch(F){throw"malformed X.509 certificate ECC public key"}if(this.curveName=u(v),this.curveName===null)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(m)},t!==void 0&&t.curve!==void 0&&(this.curveName=t.curve),this.curveName===void 0&&(this.curveName=e),this.setNamedCurve(this.curveName),t!==void 0&&(t.prv!==void 0&&this.setPrivateKeyHex(t.prv),t.pub!==void 0&&this.setPublicKeyHex(t.pub))};a.crypto.ECDSA.parseSigHex=function(t){var e=a.crypto.ECDSA.parseSigHexInHexRS(t),i=new b(e.r,16),n=new b(e.s,16);return{r:i,s:n}};a.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=j,i=e.getChildIdx,n=e.getV;if(t.substr(0,2)!="30")throw"signature is not a ASN.1 sequence";var r=i(t,0);if(r.length!=2)throw"number of signature ASN.1 sequence elements seem wrong";var s=r[0],o=r[1];if(t.substr(s,2)!="02")throw"1st item of sequene of signature is not ASN.1 integer";if(t.substr(o,2)!="02")throw"2nd item of sequene of signature is not ASN.1 integer";var h=n(t,s),g=n(t,o);return{r:h,s:g}};a.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=a.crypto.ECDSA.parseSigHexInHexRS(t),i=e.r,n=e.s;if(i.substr(0,2)=="00"&&i.length%32==2&&(i=i.substr(2)),n.substr(0,2)=="00"&&n.length%32==2&&(n=n.substr(2)),i.length%32==30&&(i="00"+i),n.length%32==30&&(n="00"+n),i.length%32!=0)throw"unknown ECDSA sig r length error";if(n.length%32!=0)throw"unknown ECDSA sig s length error";return i+n};a.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%(16*8)!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),i=t.substr(t.length/2);return a.crypto.ECDSA.hexRSSigToASN1Sig(e,i)};a.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var i=new b(t,16),n=new b(e,16);return a.crypto.ECDSA.biRSSigToASN1Sig(i,n)};a.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var i=a.asn1,n=new i.DERInteger({bigint:t}),r=new i.DERInteger({bigint:e}),s=new i.DERSequence({array:[n,r]});return s.getEncodedHex()};a.crypto.ECDSA.getName=function(t){return t==="2b8104001f"?"secp192k1":t==="2a8648ce3d030107"?"secp256r1":t==="2b8104000a"?"secp256k1":t==="2b81040021"?"secp224r1":t==="2b81040022"?"secp384r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)!==-1?"secp256r1":"|secp256k1|".indexOf(t)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(t)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(t)!==-1?"secp384r1":null};(typeof a=="undefined"||!a)&&(a={});(typeof a.crypto=="undefined"||!a.crypto)&&(a.crypto={});a.crypto.ECParameterDB=new function(){var t={},e={};function i(n){return new b(n,16)}this.getByName=function(n){var r=n;if(typeof e[r]!="undefined"&&(r=e[n]),typeof t[r]!="undefined")return t[r];throw"unregistered EC curve name: "+r},this.regist=function(n,r,s,o,h,g,p,S,y,l,f,c){t[n]={};var u=i(s),d=i(o),v=i(h),m=i(g),F=i(p),x=new Ct(u,d,v),E=x.decodePointHex("04"+S+y);t[n].name=n,t[n].keylen=r,t[n].curve=x,t[n].G=E,t[n].n=m,t[n].h=F,t[n].oid=f,t[n].info=c;for(var w=0;w<l.length;w++)e[l[w]]=n}};a.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");a.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");a.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");a.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);a.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);a.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);a.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);a.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);a.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);a.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);(typeof a=="undefined"||!a)&&(a={});(typeof a.crypto=="undefined"||!a.crypto)&&(a.crypto={});a.crypto.DSA=function(){this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(t,e,i,n,r){this.isPrivate=!0,this.p=t,this.q=e,this.g=i,this.y=n,this.x=r},this.setPrivateHex=function(t,e,i,n,r){var s,o,h,g,p;s=new b(t,16),o=new b(e,16),h=new b(i,16),typeof n=="string"&&n.length>1?g=new b(n,16):g=null,p=new b(r,16),this.setPrivate(s,o,h,g,p)},this.setPublic=function(t,e,i,n){this.isPublic=!0,this.p=t,this.q=e,this.g=i,this.y=n,this.x=null},this.setPublicHex=function(t,e,i,n){var r,s,o,h;r=new b(t,16),s=new b(e,16),o=new b(i,16),h=new b(n,16),this.setPublic(r,s,o,h)},this.signWithMessageHash=function(t){var e=this.p,i=this.q,n=this.g,r=this.y,s=this.x,o=a.crypto.Util.getRandomBigIntegerMinToMax(b.ONE.add(b.ONE),i.subtract(b.ONE)),h=t.substr(0,i.bitLength()/4),g=new b(h,16),p=n.modPow(o,e).mod(i),S=o.modInverse(i).multiply(g.add(s.multiply(p))).mod(i),y=a.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:p}},{int:{bigint:S}}]});return y},this.verifyWithMessageHash=function(t,e){var i=this.p,n=this.q,r=this.g,s=this.y,o=this.parseASN1Signature(e),h=o[0],g=o[1],p=t.substr(0,n.bitLength()/4),S=new b(p,16);if(b.ZERO.compareTo(h)>0||h.compareTo(n)>0||b.ZERO.compareTo(g)>=0||g.compareTo(n)>0)throw"invalid DSA signature";var y=g.modInverse(n),l=S.multiply(y).mod(n),f=h.multiply(y).mod(n),c=r.modPow(l,i).multiply(s.modPow(f,i)).mod(i).mod(n);return c.compareTo(h)==0},this.parseASN1Signature=function(t){try{var e=new b(j.getVbyList(t,0,[0],"02"),16),i=new b(j.getVbyList(t,0,[1],"02"),16);return[e,i]}catch(n){throw"malformed ASN.1 DSA signature"}},this.readPKCS5PrvKeyHex=function(t){var e,i,n,r,s,o=j,h=o.getVbyList;if(o.isASN1HEX(t)===!1)throw"not ASN.1 hex string";try{e=h(t,0,[1],"02"),i=h(t,0,[2],"02"),n=h(t,0,[3],"02"),r=h(t,0,[4],"02"),s=h(t,0,[5],"02")}catch(g){throw console.log("EXCEPTION:"+g),"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(e,i,n,r,s)},this.readPKCS8PrvKeyHex=function(t){var e,i,n,r,s=j,o=s.getVbyList;if(s.isASN1HEX(t)===!1)throw"not ASN.1 hex string";try{e=o(t,0,[1,1,0],"02"),i=o(t,0,[1,1,1],"02"),n=o(t,0,[1,1,2],"02"),r=o(t,0,[2,0],"02")}catch(h){throw console.log("EXCEPTION:"+h),"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(e,i,n,null,r)},this.readPKCS8PubKeyHex=function(t){var e,i,n,r,s=j,o=s.getVbyList;if(s.isASN1HEX(t)===!1)throw"not ASN.1 hex string";try{e=o(t,0,[0,1,0],"02"),i=o(t,0,[0,1,1],"02"),n=o(t,0,[0,1,2],"02"),r=o(t,0,[1,0],"02")}catch(h){throw console.log("EXCEPTION:"+h),"malformed PKCS#8 DSA public key"}this.setPublicHex(e,i,n,r)},this.readCertPubKeyHex=function(t,e){e!==5&&(e=6);var i,n,r,s,o=j,h=o.getVbyList;if(o.isASN1HEX(t)===!1)throw"not ASN.1 hex string";try{i=h(t,0,[0,e,0,1,0],"02"),n=h(t,0,[0,e,0,1,1],"02"),r=h(t,0,[0,e,0,1,2],"02"),s=h(t,0,[0,e,1,0],"02")}catch(g){throw console.log("EXCEPTION:"+g),"malformed X.509 certificate DSA public key"}this.setPublicHex(i,n,r,s)}};var Q=function(){var t=function(u,d,v){return n(V.AES,u,d,v)},e=function(u,d,v){return n(V.TripleDES,u,d,v)},i=function(u,d,v){return n(V.DES,u,d,v)},n=function(u,d,v,m){var F=V.enc.Hex.parse(d),x=V.enc.Hex.parse(v),E=V.enc.Hex.parse(m),w={};w.key=x,w.iv=E,w.ciphertext=F;var B=u.decrypt(w,x,{iv:E});return V.enc.Hex.stringify(B)},r=function(u,d,v){return h(V.AES,u,d,v)},s=function(u,d,v){return h(V.TripleDES,u,d,v)},o=function(u,d,v){return h(V.DES,u,d,v)},h=function(u,d,v,m){var F=V.enc.Hex.parse(d),x=V.enc.Hex.parse(v),E=V.enc.Hex.parse(m),w=u.encrypt(F,x,{iv:E}),B=V.enc.Hex.parse(w.toString()),I=V.enc.Base64.stringify(B);return I},g={"AES-256-CBC":{proc:t,eproc:r,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:r,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:r,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:e,eproc:s,keylen:24,ivlen:8},"DES-CBC":{proc:i,eproc:o,keylen:8,ivlen:8}},p=function(u){return g[u].proc},S=function(u){var d=V.lib.WordArray.random(u),v=V.enc.Hex.stringify(d);return v},y=function(u){var d={},v=u.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));v&&(d.cipher=v[1],d.ivsalt=v[2]);var m=u.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));m&&(d.type=m[1]);var F=-1,x=0;u.indexOf(`\r
\r
`)!=-1&&(F=u.indexOf(`\r
\r
`),x=2),u.indexOf(`

`)!=-1&&(F=u.indexOf(`

`),x=1);var E=u.indexOf("-----END");if(F!=-1&&E!=-1){var w=u.substring(F+x*2,E-x);w=w.replace(/\s+/g,""),d.data=w}return d},l=function(u,d,v){for(var m=v.substring(0,16),F=V.enc.Hex.parse(m),x=V.enc.Utf8.parse(d),E=g[u].keylen+g[u].ivlen,w="",B=null;;){var I=V.algo.MD5.create();if(B!=null&&I.update(B),I.update(x),I.update(F),B=I.finalize(),w=w+V.enc.Hex.stringify(B),w.length>=E*2)break}var P={};return P.keyhex=w.substr(0,g[u].keylen*2),P.ivhex=w.substr(g[u].keylen*2,g[u].ivlen*2),P},f=function(u,d,v,m){var F=V.enc.Base64.parse(u),x=V.enc.Hex.stringify(F),E=g[d].proc,w=E(x,v,m);return w},c=function(u,d,v,m){var F=g[d].eproc,x=F(u,v,m);return x};return{version:"1.0.0",parsePKCS5PEM:function(u){return y(u)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(u,d,v){return l(u,d,v)},decryptKeyB64:function(u,d,v,m){return f(u,d,v,m)},getDecryptedKeyHex:function(u,d){var v=y(u),m=v.type,F=v.cipher,x=v.ivsalt,E=v.data,w=l(F,d,x),B=w.keyhex,I=f(E,F,B,x);return I},getEncryptedPKCS5PEMFromPrvKeyHex:function(u,d,v,m,F){var R="";if((typeof m=="undefined"||m==null)&&(m="AES-256-CBC"),typeof g[m]=="undefined")throw"KEYUTIL unsupported algorithm: "+m;if(typeof F=="undefined"||F==null){var x=g[m].ivlen,E=S(x);F=E.toUpperCase()}var w=l(m,v,F),B=w.keyhex,I=c(d,m,B,F),P=I.replace(/(.{64})/g,`$1\r
`),R="-----BEGIN "+u+` PRIVATE KEY-----\r
`;return R+=`Proc-Type: 4,ENCRYPTED\r
`,R+="DEK-Info: "+m+","+F+`\r
`,R+=`\r
`,R+=P,R+=`\r
-----END `+u+` PRIVATE KEY-----\r
`,R},parseHexOfEncryptedPKCS8:function(u){var d=j,v=d.getChildIdx,m=d.getV,F={},x=v(u,0);if(x.length!=2)throw"malformed format: SEQUENCE(0).items != 2: "+x.length;F.ciphertext=m(u,x[1]);var E=v(u,x[0]);if(E.length!=2)throw"malformed format: SEQUENCE(0.0).items != 2: "+E.length;if(m(u,E[0])!="2a864886f70d01050d")throw"this only supports pkcs5PBES2";var w=v(u,E[1]);if(E.length!=2)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+w.length;var B=v(u,w[1]);if(B.length!=2)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+B.length;if(m(u,B[0])!="2a864886f70d0307")throw"this only supports TripleDES";F.encryptionSchemeAlg="TripleDES",F.encryptionSchemeIV=m(u,B[1]);var I=v(u,w[0]);if(I.length!=2)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+I.length;if(m(u,I[0])!="2a864886f70d01050c")throw"this only supports pkcs5PBKDF2";var P=v(u,I[1]);if(P.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+P.length;F.pbkdf2Salt=m(u,P[0]);var R=m(u,P[1]);try{F.pbkdf2Iter=parseInt(R,16)}catch(N){throw"malformed format pbkdf2Iter: "+R}return F},getPBKDF2KeyHexFromParam:function(u,d){var v=V.enc.Hex.parse(u.pbkdf2Salt),m=u.pbkdf2Iter,F=V.PBKDF2(d,v,{keySize:192/32,iterations:m}),x=V.enc.Hex.stringify(F);return x},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(u,d){var v=at(u,"ENCRYPTED PRIVATE KEY"),m=this.parseHexOfEncryptedPKCS8(v),F=Q.getPBKDF2KeyHexFromParam(m,d),x={};x.ciphertext=V.enc.Hex.parse(m.ciphertext);var E=V.enc.Hex.parse(F),w=V.enc.Hex.parse(m.encryptionSchemeIV),B=V.TripleDES.decrypt(x,E,{iv:w}),I=V.enc.Hex.stringify(B);return I},getKeyFromEncryptedPKCS8PEM:function(u,d){var v=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(u,d),m=this.getKeyFromPlainPrivatePKCS8Hex(v);return m},parsePlainPrivatePKCS8Hex:function(u){var d=j,v=d.getChildIdx,m=d.getV,F={};if(F.algparam=null,u.substr(0,2)!="30")throw"malformed plain PKCS8 private key(code:001)";var x=v(u,0);if(x.length!=3)throw"malformed plain PKCS8 private key(code:002)";if(u.substr(x[1],2)!="30")throw"malformed PKCS8 private key(code:003)";var E=v(u,x[1]);if(E.length!=2)throw"malformed PKCS8 private key(code:004)";if(u.substr(E[0],2)!="06")throw"malformed PKCS8 private key(code:005)";if(F.algoid=m(u,E[0]),u.substr(E[1],2)=="06"&&(F.algparam=m(u,E[1])),u.substr(x[2],2)!="04")throw"malformed PKCS8 private key(code:006)";return F.keyidx=d.getVidx(u,x[2]),F},getKeyFromPlainPrivatePKCS8PEM:function(u){var d=at(u,"PRIVATE KEY"),v=this.getKeyFromPlainPrivatePKCS8Hex(d);return v},getKeyFromPlainPrivatePKCS8Hex:function(u){var d=this.parsePlainPrivatePKCS8Hex(u),v;if(d.algoid=="2a864886f70d010101")v=new K;else if(d.algoid=="2a8648ce380401")v=new a.crypto.DSA;else if(d.algoid=="2a8648ce3d0201")v=new a.crypto.ECDSA;else throw"unsupported private key algorithm";return v.readPKCS8PrvKeyHex(u),v},_getKeyFromPublicPKCS8Hex:function(u){var d,v=j.getVbyList(u,0,[0,0],"06");if(v==="2a864886f70d010101")d=new K;else if(v==="2a8648ce380401")d=new a.crypto.DSA;else if(v==="2a8648ce3d0201")d=new a.crypto.ECDSA;else throw"unsupported PKCS#8 public key hex";return d.readPKCS8PubKeyHex(u),d},parsePublicRawRSAKeyHex:function(u){var d=j,v=d.getChildIdx,m=d.getV,F={};if(u.substr(0,2)!="30")throw"malformed RSA key(code:001)";var x=v(u,0);if(x.length!=2)throw"malformed RSA key(code:002)";if(u.substr(x[0],2)!="02")throw"malformed RSA key(code:003)";if(F.n=m(u,x[0]),u.substr(x[1],2)!="02")throw"malformed RSA key(code:004)";return F.e=m(u,x[1]),F},parsePublicPKCS8Hex:function(u){var d=j,v=d.getChildIdx,m=d.getV,F={};F.algparam=null;var x=v(u,0);if(x.length!=2)throw"outer DERSequence shall have 2 elements: "+x.length;var E=x[0];if(u.substr(E,2)!="30")throw"malformed PKCS8 public key(code:001)";var w=v(u,E);if(w.length!=2)throw"malformed PKCS8 public key(code:002)";if(u.substr(w[0],2)!="06")throw"malformed PKCS8 public key(code:003)";if(F.algoid=m(u,w[0]),u.substr(w[1],2)=="06"?F.algparam=m(u,w[1]):u.substr(w[1],2)=="30"&&(F.algparam={},F.algparam.p=d.getVbyList(u,w[1],[0],"02"),F.algparam.q=d.getVbyList(u,w[1],[1],"02"),F.algparam.g=d.getVbyList(u,w[1],[2],"02")),u.substr(x[1],2)!="03")throw"malformed PKCS8 public key(code:004)";return F.key=m(u,x[1]).substr(2),F}}}();Q.getKey=function(t,e,i){var n=j,r=n.getChildIdx,s=n.getV,o=n.getVbyList,h=a.crypto,g=h.ECDSA,p=h.DSA,S=K,y=at,l=Q;if(typeof S!="undefined"&&t instanceof S||typeof g!="undefined"&&t instanceof g||typeof p!="undefined"&&t instanceof p)return t;if(t.curve!==void 0&&t.xy!==void 0&&t.d===void 0)return new g({pub:t.xy,curve:t.curve});if(t.curve!==void 0&&t.d!==void 0)return new g({prv:t.d,curve:t.curve});if(t.kty===void 0&&t.n!==void 0&&t.e!==void 0&&t.d===void 0){var f=new S;return f.setPublic(t.n,t.e),f}if(t.kty===void 0&&t.n!==void 0&&t.e!==void 0&&t.d!==void 0&&t.p!==void 0&&t.q!==void 0&&t.dp!==void 0&&t.dq!==void 0&&t.co!==void 0&&t.qi===void 0){var f=new S;return f.setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),f}if(t.kty===void 0&&t.n!==void 0&&t.e!==void 0&&t.d!==void 0&&t.p===void 0){var f=new S;return f.setPrivate(t.n,t.e,t.d),f}if(t.p!==void 0&&t.q!==void 0&&t.g!==void 0&&t.y!==void 0&&t.x===void 0){var f=new p;return f.setPublic(t.p,t.q,t.g,t.y),f}if(t.p!==void 0&&t.q!==void 0&&t.g!==void 0&&t.y!==void 0&&t.x!==void 0){var f=new p;return f.setPrivate(t.p,t.q,t.g,t.y,t.x),f}if(t.kty==="RSA"&&t.n!==void 0&&t.e!==void 0&&t.d===void 0){var f=new S;return f.setPublic(Z(t.n),Z(t.e)),f}if(t.kty==="RSA"&&t.n!==void 0&&t.e!==void 0&&t.d!==void 0&&t.p!==void 0&&t.q!==void 0&&t.dp!==void 0&&t.dq!==void 0&&t.qi!==void 0){var f=new S;return f.setPrivateEx(Z(t.n),Z(t.e),Z(t.d),Z(t.p),Z(t.q),Z(t.dp),Z(t.dq),Z(t.qi)),f}if(t.kty==="RSA"&&t.n!==void 0&&t.e!==void 0&&t.d!==void 0){var f=new S;return f.setPrivate(Z(t.n),Z(t.e),Z(t.d)),f}if(t.kty==="EC"&&t.crv!==void 0&&t.x!==void 0&&t.y!==void 0&&t.d===void 0){var c=new g({curve:t.crv}),u=c.ecparams.keylen/4,d=("0000000000"+Z(t.x)).slice(-u),v=("0000000000"+Z(t.y)).slice(-u),m="04"+d+v;return c.setPublicKeyHex(m),c}if(t.kty==="EC"&&t.crv!==void 0&&t.x!==void 0&&t.y!==void 0&&t.d!==void 0){var c=new g({curve:t.crv}),u=c.ecparams.keylen/4,d=("0000000000"+Z(t.x)).slice(-u),v=("0000000000"+Z(t.y)).slice(-u),m="04"+d+v,F=("0000000000"+Z(t.d)).slice(-u);return c.setPublicKeyHex(m),c.setPrivateKeyHex(F),c}if(i==="pkcs5prv"){var x=t,n=j,E,f;if(E=r(x,0),E.length===9)f=new S,f.readPKCS5PrvKeyHex(x);else if(E.length===6)f=new p,f.readPKCS5PrvKeyHex(x);else if(E.length>2&&x.substr(E[1],2)==="04")f=new g,f.readPKCS5PrvKeyHex(x);else throw"unsupported PKCS#1/5 hexadecimal key";return f}if(i==="pkcs8prv"){var f=l.getKeyFromPlainPrivatePKCS8Hex(t);return f}if(i==="pkcs8pub")return l._getKeyFromPublicPKCS8Hex(t);if(i==="x509pub")return X.getPublicKeyFromCertHex(t);if(t.indexOf("-END CERTIFICATE-",0)!=-1||t.indexOf("-END X509 CERTIFICATE-",0)!=-1||t.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return X.getPublicKeyFromCertPEM(t);if(t.indexOf("-END PUBLIC KEY-")!=-1){var w=at(t,"PUBLIC KEY");return l._getKeyFromPublicPKCS8Hex(w)}if(t.indexOf("-END RSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")==-1){var B=y(t,"RSA PRIVATE KEY");return l.getKey(B,null,"pkcs5prv")}if(t.indexOf("-END DSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")==-1){var I=y(t,"DSA PRIVATE KEY"),P=o(I,0,[1],"02"),R=o(I,0,[2],"02"),N=o(I,0,[3],"02"),L=o(I,0,[4],"02"),O=o(I,0,[5],"02"),f=new p;return f.setPrivate(new b(P,16),new b(R,16),new b(N,16),new b(L,16),new b(O,16)),f}if(t.indexOf("-END EC PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")==-1){var B=y(t,"EC PRIVATE KEY");return l.getKey(B,null,"pkcs5prv")}if(t.indexOf("-END PRIVATE KEY-")!=-1)return l.getKeyFromPlainPrivatePKCS8PEM(t);if(t.indexOf("-END RSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1){var C=l.getDecryptedKeyHex(t,e),D=new K;return D.readPKCS5PrvKeyHex(C),D}if(t.indexOf("-END EC PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1){var I=l.getDecryptedKeyHex(t,e),f=o(I,0,[1],"04"),A=o(I,0,[2,0],"06"),T=o(I,0,[3,0],"03").substr(2),_="";if(a.crypto.OID.oidhex2name[A]!==void 0)_=a.crypto.OID.oidhex2name[A];else throw"undefined OID(hex) in KJUR.crypto.OID: "+A;var c=new g({curve:_});return c.setPublicKeyHex(T),c.setPrivateKeyHex(f),c.isPublic=!1,c}if(t.indexOf("-END DSA PRIVATE KEY-")!=-1&&t.indexOf("4,ENCRYPTED")!=-1){var I=l.getDecryptedKeyHex(t,e),P=o(I,0,[1],"02"),R=o(I,0,[2],"02"),N=o(I,0,[3],"02"),L=o(I,0,[4],"02"),O=o(I,0,[5],"02"),f=new p;return f.setPrivate(new b(P,16),new b(R,16),new b(N,16),new b(L,16),new b(O,16)),f}if(t.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return l.getKeyFromEncryptedPKCS8PEM(t,e);throw"not supported argument"};Q.generateKeypair=function(t,e){if(t=="RSA"){var i=e,n=new K;n.generate(i,"10001"),n.isPrivate=!0,n.isPublic=!0;var r=new K,s=n.n.toString(16),o=n.e.toString(16);r.setPublic(s,o),r.isPrivate=!1,r.isPublic=!0;var h={};return h.prvKeyObj=n,h.pubKeyObj=r,h}else if(t=="EC"){var g=e,p=new a.crypto.ECDSA({curve:g}),S=p.generateKeyPairHex(),n=new a.crypto.ECDSA({curve:g});n.setPublicKeyHex(S.ecpubhex),n.setPrivateKeyHex(S.ecprvhex),n.isPrivate=!0,n.isPublic=!1;var r=new a.crypto.ECDSA({curve:g});r.setPublicKeyHex(S.ecpubhex),r.isPrivate=!1,r.isPublic=!0;var h={};return h.prvKeyObj=n,h.pubKeyObj=r,h}else throw"unknown algorithm: "+t};Q.getPEM=function(t,e,i,n,r,s){var o=a,h=o.asn1,g=h.DERObjectIdentifier,p=h.DERInteger,S=h.ASN1Util.newObject,y=h.x509,l=y.SubjectPublicKeyInfo,f=o.crypto,c=f.DSA,u=f.ECDSA,d=K;function v(D){var A=S({seq:[{int:0},{int:{bigint:D.n}},{int:D.e},{int:{bigint:D.d}},{int:{bigint:D.p}},{int:{bigint:D.q}},{int:{bigint:D.dmp1}},{int:{bigint:D.dmq1}},{int:{bigint:D.coeff}}]});return A}function m(D){var A=S({seq:[{int:1},{octstr:{hex:D.prvKeyHex}},{tag:["a0",!0,{oid:{name:D.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+D.pubKeyHex}}]}]});return A}function F(D){var A=S({seq:[{int:0},{int:{bigint:D.p}},{int:{bigint:D.q}},{int:{bigint:D.g}},{int:{bigint:D.y}},{int:{bigint:D.x}}]});return A}if((d!==void 0&&t instanceof d||c!==void 0&&t instanceof c||u!==void 0&&t instanceof u)&&t.isPublic==!0&&(e===void 0||e=="PKCS8PUB")){var x=new l(t),E=x.getEncodedHex();return ht(E,"PUBLIC KEY")}if(e=="PKCS1PRV"&&d!==void 0&&t instanceof d&&(i===void 0||i==null)&&t.isPrivate==!0){var x=v(t),E=x.getEncodedHex();return ht(E,"RSA PRIVATE KEY")}if(e=="PKCS1PRV"&&u!==void 0&&t instanceof u&&(i===void 0||i==null)&&t.isPrivate==!0){var w=new g({name:t.curveName}),B=w.getEncodedHex(),I=m(t),P=I.getEncodedHex(),R="";return R+=ht(B,"EC PARAMETERS"),R+=ht(P,"EC PRIVATE KEY"),R}if(e=="PKCS1PRV"&&c!==void 0&&t instanceof c&&(i===void 0||i==null)&&t.isPrivate==!0){var x=F(t),E=x.getEncodedHex();return ht(E,"DSA PRIVATE KEY")}if(e=="PKCS5PRV"&&d!==void 0&&t instanceof d&&i!==void 0&&i!=null&&t.isPrivate==!0){var x=v(t),E=x.getEncodedHex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",E,i,n,s)}if(e=="PKCS5PRV"&&u!==void 0&&t instanceof u&&i!==void 0&&i!=null&&t.isPrivate==!0){var x=m(t),E=x.getEncodedHex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",E,i,n,s)}if(e=="PKCS5PRV"&&c!==void 0&&t instanceof c&&i!==void 0&&i!=null&&t.isPrivate==!0){var x=F(t),E=x.getEncodedHex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",E,i,n,s)}var N=function(D,A){var T=L(D,A),_=new S({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:T.pbkdf2Salt}},{int:T.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:T.encryptionSchemeIV}}]}]}]},{octstr:{hex:T.ciphertext}}]});return _.getEncodedHex()},L=function(D,A){var T=100,_=V.lib.WordArray.random(8),k="DES-EDE3-CBC",M=V.lib.WordArray.random(8),z=V.PBKDF2(A,_,{keySize:192/32,iterations:T}),q=V.enc.Hex.parse(D),Y=V.TripleDES.encrypt(q,z,{iv:M})+"",G={};return G.ciphertext=Y,G.pbkdf2Salt=V.enc.Hex.stringify(_),G.pbkdf2Iter=T,G.encryptionSchemeAlg=k,G.encryptionSchemeIV=V.enc.Hex.stringify(M),G};if(e=="PKCS8PRV"&&d!=null&&t instanceof d&&t.isPrivate==!0){var O=v(t),C=O.getEncodedHex(),x=S({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:C}}]}),E=x.getEncodedHex();if(i===void 0||i==null)return ht(E,"PRIVATE KEY");var P=N(E,i);return ht(P,"ENCRYPTED PRIVATE KEY")}if(e=="PKCS8PRV"&&u!==void 0&&t instanceof u&&t.isPrivate==!0){var O=new S({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}),C=O.getEncodedHex(),x=S({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:C}}]}),E=x.getEncodedHex();if(i===void 0||i==null)return ht(E,"PRIVATE KEY");var P=N(E,i);return ht(P,"ENCRYPTED PRIVATE KEY")}if(e=="PKCS8PRV"&&c!==void 0&&t instanceof c&&t.isPrivate==!0){var O=new p({bigint:t.x}),C=O.getEncodedHex(),x=S({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:C}}]}),E=x.getEncodedHex();if(i===void 0||i==null)return ht(E,"PRIVATE KEY");var P=N(E,i);return ht(P,"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"};Q.getKeyFromCSRPEM=function(t){var e=at(t,"CERTIFICATE REQUEST"),i=Q.getKeyFromCSRHex(e);return i};Q.getKeyFromCSRHex=function(t){var e=Q.parseCSRHex(t),i=Q.getKey(e.p8pubkeyhex,null,"pkcs8pub");return i};Q.parseCSRHex=function(t){var e=j,i=e.getChildIdx,n=e.getTLV,r={},s=t;if(s.substr(0,2)!="30")throw"malformed CSR(code:001)";var o=i(s,0);if(o.length<1)throw"malformed CSR(code:002)";if(s.substr(o[0],2)!="30")throw"malformed CSR(code:003)";var h=i(s,o[0]);if(h.length<3)throw"malformed CSR(code:004)";return r.p8pubkeyhex=n(s,h[2]),r};Q.getJWKFromKey=function(t){var e={};if(t instanceof K&&t.isPrivate)return e.kty="RSA",e.n=et(t.n.toString(16)),e.e=et(t.e.toString(16)),e.d=et(t.d.toString(16)),e.p=et(t.p.toString(16)),e.q=et(t.q.toString(16)),e.dp=et(t.dmp1.toString(16)),e.dq=et(t.dmq1.toString(16)),e.qi=et(t.coeff.toString(16)),e;if(t instanceof K&&t.isPublic)return e.kty="RSA",e.n=et(t.n.toString(16)),e.e=et(t.e.toString(16)),e;if(t instanceof a.crypto.ECDSA&&t.isPrivate){var i=t.getShortNISTPCurveName();if(i!=="P-256"&&i!=="P-384")throw"unsupported curve name for JWT: "+i;var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=et(n.x),e.y=et(n.y),e.d=et(t.prvKeyHex),e}else if(t instanceof a.crypto.ECDSA&&t.isPublic){var i=t.getShortNISTPCurveName();if(i!=="P-256"&&i!=="P-384")throw"unsupported curve name for JWT: "+i;var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=et(n.x),e.y=et(n.y),e}throw"not supported key object"};K.getPosArrayOfChildrenFromHex=function(t){return j.getChildIdx(t,0)};K.getHexValueArrayOfChildrenFromHex=function(t){var e=j,i=e.getV,l=K.getPosArrayOfChildrenFromHex(t),n=i(t,l[0]),r=i(t,l[1]),s=i(t,l[2]),o=i(t,l[3]),h=i(t,l[4]),g=i(t,l[5]),p=i(t,l[6]),S=i(t,l[7]),y=i(t,l[8]),l=new Array;return l.push(n,r,s,o,h,g,p,S,y),l};K.prototype.readPrivateKeyFromPEMString=function(t){var e=at(t),i=K.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])};K.prototype.readPKCS5PrvKeyHex=function(t){var e=K.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};K.prototype.readPKCS8PrvKeyHex=function(t){var e,i,n,r,s,o,h,g,p=j,S=p.getVbyList;if(p.isASN1HEX(t)===!1)throw"not ASN.1 hex string";try{e=S(t,0,[2,0,1],"02"),i=S(t,0,[2,0,2],"02"),n=S(t,0,[2,0,3],"02"),r=S(t,0,[2,0,4],"02"),s=S(t,0,[2,0,5],"02"),o=S(t,0,[2,0,6],"02"),h=S(t,0,[2,0,7],"02"),g=S(t,0,[2,0,8],"02")}catch(y){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(e,i,n,r,s,o,h,g)};K.prototype.readPKCS5PubKeyHex=function(t){var e=j,i=e.getV;if(e.isASN1HEX(t)===!1)throw"keyHex is not ASN.1 hex string";var n=e.getChildIdx(t,0);if(n.length!==2||t.substr(n[0],2)!=="02"||t.substr(n[1],2)!=="02")throw"wrong hex for PKCS#5 public key";var r=i(t,n[0]),s=i(t,n[1]);this.setPublic(r,s)};K.prototype.readPKCS8PubKeyHex=function(t){var e=j;if(e.isASN1HEX(t)===!1)throw"not ASN.1 hex string";if(e.getTLVbyList(t,0,[0,0])!=="06092a864886f70d010101")throw"not PKCS8 RSA public key";var i=e.getTLVbyList(t,0,[1,0]);this.readPKCS5PubKeyHex(i)};K.prototype.readCertPubKeyHex=function(t,e){var i,n;i=new X,i.readCertHex(t),n=i.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var be=new RegExp("[^0-9a-f]","gi");function we(t,e){for(var i="",n=e/4-t.length,r=0;r<n;r++)i=i+"0";return i+t}K.prototype.sign=function(t,e){var i=function(r){return a.crypto.Util.hashString(r,e)},n=i(t);return this.signWithMessageHash(n,e)};K.prototype.signWithMessageHash=function(t,e){var i=a.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),n=nt(i,16),r=this.doPrivate(n),s=r.toString(16);return we(s,this.n.bitLength())};function Ae(t,e,i){for(var n="",r=0;n.length<e;)n+=At(i(mt(t+String.fromCharCode.apply(String,[(r&4278190080)>>24,(r&16711680)>>16,(r&65280)>>8,r&255])))),r+=1;return n}K.prototype.signPSS=function(t,e,i){var n=function(s){return a.crypto.Util.hashHex(s,e)},r=n(mt(t));return i===void 0&&(i=-1),this.signWithMessageHashPSS(r,e,i)};K.prototype.signWithMessageHashPSS=function(t,e,i){var n=At(t),r=n.length,s=this.n.bitLength()-1,o=Math.ceil(s/8),h,g=function(d){return a.crypto.Util.hashHex(d,e)};if(i===-1||i===void 0)i=r;else if(i===-2)i=o-r-2;else if(i<-2)throw"invalid salt length";if(o<r+i+2)throw"data too long";var p="";i>0&&(p=new Array(i),new Bt().nextBytes(p),p=String.fromCharCode.apply(String,p));var S=At(g(mt("\0\0\0\0\0\0\0\0"+n+p))),y=[];for(h=0;h<o-i-r-2;h+=1)y[h]=0;var l=String.fromCharCode.apply(String,y)+""+p,f=Ae(S,l.length,g),c=[];for(h=0;h<l.length;h+=1)c[h]=l.charCodeAt(h)^f.charCodeAt(h);var u=65280>>8*o-s&255;for(c[0]&=~u,h=0;h<r;h++)c.push(S.charCodeAt(h));return c.push(188),we(this.doPrivate(new b(c)).toString(16),this.n.bitLength())};function Ce(t){for(var e in a.crypto.Util.DIGESTINFOHEAD){var i=a.crypto.Util.DIGESTINFOHEAD[e],n=i.length;if(t.substring(0,n)==i){var r=[e,t.substring(n)];return r}}return[]}K.prototype.verify=function(t,e){e=e.replace(be,""),e=e.replace(/[ \n]+/g,"");var i=nt(e,16);if(i.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(i),r=n.toString(16).replace(/^1f+00/,""),s=Ce(r);if(s.length==0)return!1;var o=s[0],h=s[1],g=function(S){return a.crypto.Util.hashString(S,o)},p=g(t);return h==p};K.prototype.verifyWithMessageHash=function(t,e){e=e.replace(be,""),e=e.replace(/[ \n]+/g,"");var i=nt(e,16);if(i.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(i),r=n.toString(16).replace(/^1f+00/,""),s=Ce(r);if(s.length==0)return!1;var o=s[0],h=s[1];return h==t};K.prototype.verifyPSS=function(t,e,i,n){var r=function(o){return a.crypto.Util.hashHex(o,i)},s=r(mt(t));return n===void 0&&(n=-1),this.verifyWithMessageHashPSS(s,e,i,n)};K.prototype.verifyWithMessageHashPSS=function(t,e,i,n){var r=new b(e,16);if(r.bitLength()>this.n.bitLength())return!1;var s=function(m){return a.crypto.Util.hashHex(m,i)},o=At(t),h=o.length,g=this.n.bitLength()-1,p=Math.ceil(g/8),S;if(n===-1||n===void 0)n=h;else if(n===-2)n=p-h-2;else if(n<-2)throw"invalid salt length";if(p<h+n+2)throw"data too long";var y=this.doPublic(r).toByteArray();for(S=0;S<y.length;S+=1)y[S]&=255;for(;y.length<p;)y.unshift(0);if(y[p-1]!==188)throw"encoded message does not end in 0xbc";y=String.fromCharCode.apply(String,y);var l=y.substr(0,p-h-1),f=y.substr(l.length,h),c=65280>>8*p-g&255;if((l.charCodeAt(0)&c)!==0)throw"bits beyond keysize not zero";var u=Ae(f,l.length,s),d=[];for(S=0;S<l.length;S+=1)d[S]=l.charCodeAt(S)^u.charCodeAt(S);d[0]&=~c;var v=p-h-n-2;for(S=0;S<v;S+=1)if(d[S]!==0)throw"leftmost octets not zero";if(d[v]!==1)throw"0x01 marker not found";return f===At(s(mt("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,d.slice(-n)))))};K.SALT_LEN_HLEN=-1;K.SALT_LEN_MAX=-2;K.SALT_LEN_RECOVER=-2;function X(){var t=j,e=t.getChildIdx,i=t.getV,n=t.getTLV,r=t.getVbyList,s=t.getTLVbyList,o=t.getIdxbyList,h=t.getVidx,g=t.oidname,p=X,S=at;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return this.hex===null||this.version!==0?this.version:s(this.hex,0,[0,0])!=="a003020102"?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return r(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return g(r(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return s(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return p.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return s(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return p.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var y=r(this.hex,0,[0,4+this.foffset,0]);return y=y.replace(/(..)/g,"%$1"),y=decodeURIComponent(y),y},this.getNotAfter=function(){var y=r(this.hex,0,[0,4+this.foffset,1]);return y=y.replace(/(..)/g,"%$1"),y=decodeURIComponent(y),y},this.getPublicKeyHex=function(){return t.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return o(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var y=this.getPublicKeyIdx();return o(this.hex,y,[1,0],"30")},this.getPublicKey=function(){return Q.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return g(r(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return r(this.hex,0,[2],"03",!0)},this.verifySignature=function(y){var l=this.getSignatureAlgorithmName(),f=this.getSignatureValueHex(),c=s(this.hex,0,[0],"30"),u=new a.crypto.Signature({alg:l});return u.init(y),u.updateHex(c),u.verify(f)},this.parseExt=function(){if(this.version!==3)return-1;var y=o(this.hex,0,[0,7,0],"30"),l=e(this.hex,y);this.aExtInfo=new Array;for(var f=0;f<l.length;f++){var c={};c.critical=!1;var u=e(this.hex,l[f]),d=0;u.length===3&&(c.critical=!0,d=1),c.oid=t.hextooidstr(r(this.hex,l[f],[0],"06"));var v=o(this.hex,l[f],[1+d]);c.vidx=h(this.hex,v),this.aExtInfo.push(c)}},this.getExtInfo=function(y){var l=this.aExtInfo,f=y;if(y.match(/^[0-9.]+$/)||(f=a.asn1.x509.OID.name2oid(y)),f!==""){for(var c=0;c<l.length;c++)if(l[c].oid===f)return l[c]}},this.getExtBasicConstraints=function(){var y=this.getExtInfo("basicConstraints");if(y===void 0)return y;var l=i(this.hex,y.vidx);if(l==="")return{};if(l==="0101ff")return{cA:!0};if(l.substr(0,8)==="0101ff02"){var f=i(l,6),c=parseInt(f,16);return{cA:!0,pathLen:c}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var y=this.getExtInfo("keyUsage");if(y===void 0)return"";var l=i(this.hex,y.vidx);if(l.length%2!=0||l.length<=2)throw"malformed key usage value";var f=parseInt(l.substr(0,2)),c=parseInt(l.substr(2),16).toString(2);return c.substr(0,c.length-f)},this.getExtKeyUsageString=function(){for(var y=this.getExtKeyUsageBin(),l=new Array,f=0;f<y.length;f++)y.substr(f,1)=="1"&&l.push(X.KEYUSAGE_NAME[f]);return l.join(",")},this.getExtSubjectKeyIdentifier=function(){var y=this.getExtInfo("subjectKeyIdentifier");return y===void 0?y:i(this.hex,y.vidx)},this.getExtAuthorityKeyIdentifier=function(){var y=this.getExtInfo("authorityKeyIdentifier");if(y===void 0)return y;for(var l={},f=n(this.hex,y.vidx),c=e(f,0),u=0;u<c.length;u++)f.substr(c[u],2)==="80"&&(l.kid=i(f,c[u]));return l},this.getExtExtKeyUsageName=function(){var y=this.getExtInfo("extKeyUsage");if(y===void 0)return y;var l=new Array,f=n(this.hex,y.vidx);if(f==="")return l;for(var c=e(f,0),u=0;u<c.length;u++)l.push(g(i(f,c[u])));return l},this.getExtSubjectAltName=function(){for(var y=this.getExtSubjectAltName2(),l=new Array,f=0;f<y.length;f++)y[f][0]==="DNS"&&l.push(y[f][1]);return l},this.getExtSubjectAltName2=function(){var y,l,f,c=this.getExtInfo("subjectAltName");if(c===void 0)return c;for(var u=new Array,d=n(this.hex,c.vidx),v=e(d,0),m=0;m<v.length;m++)f=d.substr(v[m],2),y=i(d,v[m]),f==="81"&&(l=tt(y),u.push(["MAIL",l])),f==="82"&&(l=tt(y),u.push(["DNS",l])),f==="84"&&(l=X.hex2dn(y,0),u.push(["DN",l])),f==="86"&&(l=tt(y),u.push(["URI",l])),f==="87"&&(l=gr(y),u.push(["IP",l]));return u},this.getExtCRLDistributionPointsURI=function(){var y=this.getExtInfo("cRLDistributionPoints");if(y===void 0)return y;for(var l=new Array,f=e(this.hex,y.vidx),c=0;c<f.length;c++)try{var u=r(this.hex,f[c],[0,0,0],"86"),d=tt(u);l.push(d)}catch(v){}return l},this.getExtAIAInfo=function(){var y=this.getExtInfo("authorityInfoAccess");if(y===void 0)return y;for(var l={ocsp:[],caissuer:[]},f=e(this.hex,y.vidx),c=0;c<f.length;c++){var u=r(this.hex,f[c],[0],"06"),d=r(this.hex,f[c],[1],"86");u==="2b06010505073001"&&l.ocsp.push(tt(d)),u==="2b06010505073002"&&l.caissuer.push(tt(d))}return l},this.getExtCertificatePolicies=function(){var y=this.getExtInfo("certificatePolicies");if(y===void 0)return y;for(var l=n(this.hex,y.vidx),f=[],c=e(l,0),u=0;u<c.length;u++){var d={},v=e(l,c[u]);if(d.id=g(i(l,v[0])),v.length===2)for(var m=e(l,v[1]),F=0;F<m.length;F++){var x=r(l,m[F],[0],"06");x==="2b06010505070201"?d.cps=tt(r(l,m[F],[1])):x==="2b06010505070202"&&(d.unotice=tt(r(l,m[F],[1,0])))}f.push(d)}return f},this.readCertPEM=function(y){this.readCertHex(S(y))},this.readCertHex=function(y){this.hex=y,this.getVersion();try{o(this.hex,0,[0,7],"a3"),this.parseExt()}catch(l){}},this.getInfo=function(){var y=X,l,f,c;if(l=`Basic Fields
`,l+="  serial number: "+this.getSerialNumberHex()+`
`,l+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,l+="  issuer: "+this.getIssuerString()+`
`,l+="  notBefore: "+this.getNotBefore()+`
`,l+="  notAfter: "+this.getNotAfter()+`
`,l+="  subject: "+this.getSubjectString()+`
`,l+=`  subject public key info: 
`,f=this.getPublicKey(),l+="    key algorithm: "+f.type+`
`,f.type==="RSA"&&(l+="    n="+le(f.n.toString(16)).substr(0,16)+`...
`,l+="    e="+le(f.e.toString(16))+`
`),c=this.aExtInfo,c!=null){l+=`X509v3 Extensions:
`;for(var u=0;u<c.length;u++){var d=c[u],v=a.asn1.x509.OID.oid2name(d.oid);v===""&&(v=d.oid);var m="";if(d.critical===!0&&(m="CRITICAL"),l+="  "+v+" "+m+`:
`,v==="basicConstraints"){var F=this.getExtBasicConstraints();F.cA===void 0?l+=`    {}
`:(l+="    cA=true",F.pathLen!==void 0&&(l+=", pathLen="+F.pathLen),l+=`
`)}else if(v==="keyUsage")l+="    "+this.getExtKeyUsageString()+`
`;else if(v==="subjectKeyIdentifier")l+="    "+this.getExtSubjectKeyIdentifier()+`
`;else if(v==="authorityKeyIdentifier"){var x=this.getExtAuthorityKeyIdentifier();x.kid!==void 0&&(l+="    kid="+x.kid+`
`)}else if(v==="extKeyUsage"){var E=this.getExtExtKeyUsageName();l+="    "+E.join(", ")+`
`}else if(v==="subjectAltName"){var w=this.getExtSubjectAltName2();l+="    "+w+`
`}else if(v==="cRLDistributionPoints"){var B=this.getExtCRLDistributionPointsURI();l+="    "+B+`
`}else if(v==="authorityInfoAccess"){var I=this.getExtAIAInfo();I.ocsp!==void 0&&(l+="    ocsp: "+I.ocsp.join(",")+`
`),I.caissuer!==void 0&&(l+="    caissuer: "+I.caissuer.join(",")+`
`)}else if(v==="certificatePolicies")for(var P=this.getExtCertificatePolicies(),R=0;R<P.length;R++)P[R].id!==void 0&&(l+="    policy oid: "+P[R].id+`
`),P[R].cps!==void 0&&(l+="    cps: "+P[R].cps+`
`)}}return l+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,l+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,l}}X.hex2dn=function(t,e){if(e===void 0&&(e=0),t.substr(e,2)!=="30")throw"malformed DN";for(var i=new Array,n=j.getChildIdx(t,e),r=0;r<n.length;r++)i.push(X.hex2rdn(t,n[r]));return i=i.map(function(s){return s.replace("/","\\/")}),"/"+i.join("/")};X.hex2rdn=function(t,e){if(e===void 0&&(e=0),t.substr(e,2)!=="31")throw"malformed RDN";for(var i=new Array,n=j.getChildIdx(t,e),r=0;r<n.length;r++)i.push(X.hex2attrTypeValue(t,n[r]));return i=i.map(function(s){return s.replace("+","\\+")}),i.join("+")};X.hex2attrTypeValue=function(t,e){var i=j,n=i.getV;if(e===void 0&&(e=0),t.substr(e,2)!=="30")throw"malformed attribute type and value";var r=i.getChildIdx(t,e);r.length!==2||t.substr(r[0],2);var s=n(t,r[0]),o=a.asn1.ASN1Util.oidHexToInt(s),h=a.asn1.x509.OID.oid2atype(o),g=n(t,r[1]),p=At(g);return h+"="+p};X.getPublicKeyFromCertHex=function(t){var e=new X;return e.readCertHex(t),e.getPublicKey()};X.getPublicKeyFromCertPEM=function(t){var e=new X;return e.readCertPEM(t),e.getPublicKey()};X.getPublicKeyInfoPropOfCertPEM=function(t){var e=j,i=e.getVbyList,n={},r,s,o;return n.algparam=null,r=new X,r.readCertPEM(t),s=r.getPublicKeyHex(),n.keyhex=i(s,0,[1],"03").substr(2),n.algoid=i(s,0,[0,0],"06"),n.algoid==="2a8648ce3d0201"&&(n.algparam=i(s,0,[0,1],"06")),n};X.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];(typeof a=="undefined"||!a)&&(a={});(typeof a.jws=="undefined"||!a.jws)&&(a.jws={});a.jws.JWS=function(){var t=a,e=t.jws.JWS,i=e.isSafeJSONString;this.parseJWS=function(n,r){if(!(this.parsedJWS!==void 0&&(r||this.parsedJWS.sigvalH!==void 0))){var s=n.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(s==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var o=s[1],h=s[2],g=s[3],p=o+"."+h;if(this.parsedJWS={},this.parsedJWS.headB64U=o,this.parsedJWS.payloadB64U=h,this.parsedJWS.sigvalB64U=g,this.parsedJWS.si=p,!r){var S=Z(g),y=nt(S,16);this.parsedJWS.sigvalH=S,this.parsedJWS.sigvalBI=y}var l=St(o),f=St(h);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=f,!i(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}};a.jws.JWS.sign=function(t,e,i,n,r){var s=a,o=s.jws,h=o.JWS,g=h.readSafeJSONString,p=h.isSafeJSONString,S=s.crypto,y=S.ECDSA,l=S.Mac,f=S.Signature,c=JSON,u,d,v;if(typeof e!="string"&&typeof e!="object")throw"spHeader must be JSON string or object: "+e;if(typeof e=="object"&&(d=e,u=c.stringify(d)),typeof e=="string"){if(u=e,!p(u))throw"JWS Head is not safe JSON string: "+u;d=g(u)}if(v=i,typeof i=="object"&&(v=c.stringify(i)),(t==""||t==null)&&d.alg!==void 0&&(t=d.alg),t!=""&&t!=null&&d.alg===void 0&&(d.alg=t,u=c.stringify(d)),t!==d.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+d.alg;var m=null;if(h.jwsalg2sigalg[t]===void 0)throw"unsupported alg name: "+t;m=h.jwsalg2sigalg[t];var F=qt(u),x=qt(v),E=F+"."+x,w="";if(m.substr(0,4)=="Hmac"){if(n===void 0)throw"mac key shall be specified for HS* alg";var B=new l({alg:m,prov:"cryptojs",pass:n});B.updateString(E),w=B.doFinal()}else if(m.indexOf("withECDSA")!=-1){var I=new f({alg:m});I.init(n,r),I.updateString(E),hASN1Sig=I.sign(),w=a.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else if(m!="none"){var I=new f({alg:m});I.init(n,r),I.updateString(E),w=I.sign()}var P=et(w);return E+"."+P};a.jws.JWS.verify=function(t,e,i){var n=a,r=n.jws,s=r.JWS,o=s.readSafeJSONString,h=n.crypto,g=h.ECDSA,p=h.Mac,S=h.Signature,y;typeof K!==void 0&&(y=K);var l=t.split(".");if(l.length!==3)return!1;var f=l[0],c=l[1],u=f+"."+c,d=Z(l[2]),v=o(St(l[0])),m=null,F=null;if(v.alg===void 0)throw"algorithm not specified in header";if(m=v.alg,F=m.substr(0,2),i!=null&&Object.prototype.toString.call(i)==="[object Array]"&&i.length>0){var x=":"+i.join(":")+":";if(x.indexOf(":"+m+":")==-1)throw"algorithm '"+m+"' not accepted in the list"}if(m!="none"&&e===null)throw"key shall be specified to verify.";if(typeof e=="string"&&e.indexOf("-----BEGIN ")!=-1&&(e=Q.getKey(e)),(F=="RS"||F=="PS")&&!(e instanceof y))throw"key shall be a RSAKey obj for RS* and PS* algs";if(F=="ES"&&!(e instanceof g))throw"key shall be a ECDSA obj for ES* algs";m=="none";var E=null;if(s.jwsalg2sigalg[v.alg]===void 0)throw"unsupported alg name: "+m;if(E=s.jwsalg2sigalg[m],E=="none")throw"not supported";if(E.substr(0,4)=="Hmac"){var w=null;if(e===void 0)throw"hexadecimal key shall be specified for HMAC";var B=new p({alg:E,pass:e});return B.updateString(u),w=B.doFinal(),d==w}else if(E.indexOf("withECDSA")!=-1){var I=null;try{I=g.concatSigToASN1Sig(d)}catch(R){return!1}var P=new S({alg:E});return P.init(e),P.updateString(u),P.verify(I)}else{var P=new S({alg:E});return P.init(e),P.updateString(u),P.verify(d)}};a.jws.JWS.parse=function(t){var e=t.split("."),i={},n,r,s;if(e.length!=2&&e.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return n=e[0],r=e[1],e.length==3&&(s=e[2]),i.headerObj=a.jws.JWS.readSafeJSONString(St(n)),i.payloadObj=a.jws.JWS.readSafeJSONString(St(r)),i.headerPP=JSON.stringify(i.headerObj,null,"  "),i.payloadObj==null?i.payloadPP=St(r):i.payloadPP=JSON.stringify(i.payloadObj,null,"  "),s!==void 0&&(i.sigHex=Z(s)),i};a.jws.JWS.verifyJWT=function(t,e,i){var n=a,r=n.jws,s=r.JWS,o=s.readSafeJSONString,h=s.inArray,g=s.includedArray,p=t.split("."),S=p[0],y=p[1],l=S+"."+y,f=Z(p[2]),c=o(St(S)),u=o(St(y));if(c.alg===void 0)return!1;if(i.alg===void 0)throw"acceptField.alg shall be specified";if(!h(c.alg,i.alg)||u.iss!==void 0&&typeof i.iss=="object"&&!h(u.iss,i.iss)||u.sub!==void 0&&typeof i.sub=="object"&&!h(u.sub,i.sub))return!1;if(u.aud!==void 0&&typeof i.aud=="object"){if(typeof u.aud=="string"){if(!h(u.aud,i.aud))return!1}else if(typeof u.aud=="object"&&!g(u.aud,i.aud))return!1}var d=r.IntDate.getNow();return i.verifyAt!==void 0&&typeof i.verifyAt=="number"&&(d=i.verifyAt),(i.gracePeriod===void 0||typeof i.gracePeriod!="number")&&(i.gracePeriod=0),!(u.exp!==void 0&&typeof u.exp=="number"&&u.exp+i.gracePeriod<d||u.nbf!==void 0&&typeof u.nbf=="number"&&d<u.nbf-i.gracePeriod||u.iat!==void 0&&typeof u.iat=="number"&&d<u.iat-i.gracePeriod||u.jti!==void 0&&i.jti!==void 0&&u.jti!==i.jti||!s.verify(t,e,i.alg))};a.jws.JWS.includedArray=function(t,e){var i=a.jws.JWS.inArray;if(t===null||typeof t!="object"||typeof t.length!="number")return!1;for(var n=0;n<t.length;n++)if(!i(t[n],e))return!1;return!0};a.jws.JWS.inArray=function(t,e){if(e===null||typeof e!="object"||typeof e.length!="number")return!1;for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1};a.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};a.jws.JWS.isSafeJSONString=function(t,e,i){var n=null;try{return n=Se(t),typeof n!="object"||n.constructor===Array?0:(e&&(e[i]=n),1)}catch(r){return 0}};a.jws.JWS.readSafeJSONString=function(t){var e=null;try{return e=Se(t),typeof e!="object"||e.constructor===Array?null:e}catch(i){return null}};a.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(e==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]};a.jws.JWS.getJWKthumbprint=function(t){if(t.kty!=="RSA"&&t.kty!=="EC"&&t.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var e="{";if(t.kty==="RSA"){if(typeof t.n!="string"||typeof t.e!="string")throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if(t.kty==="EC"){if(typeof t.crv!="string"||typeof t.x!="string"||typeof t.y!="string")throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if(t.kty==="oct"){if(typeof t.k!="string")throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var i=mt(e),n=a.crypto.Util.hashHex(i,"sha256"),r=et(n);return r};a.jws.IntDate={};a.jws.IntDate.get=function(t){var e=a.jws.IntDate,i=e.getNow,n=e.getZulu;if(t=="now")return i();if(t=="now + 1hour")return i()+60*60;if(t=="now + 1day")return i()+60*60*24;if(t=="now + 1month")return i()+60*60*24*30;if(t=="now + 1year")return i()+60*60*24*365;if(t.match(/Z$/))return n(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t};a.jws.IntDate.getZulu=function(t){return lr(t)};a.jws.IntDate.getNow=function(){var t=~~(new Date/1e3);return t};a.jws.IntDate.intDate2UTCString=function(t){var e=new Date(t*1e3);return e.toUTCString()};a.jws.IntDate.intDate2Zulu=function(t){var e=new Date(t*1e3),i=("0000"+e.getUTCFullYear()).slice(-4),n=("00"+(e.getUTCMonth()+1)).slice(-2),r=("00"+e.getUTCDate()).slice(-2),s=("00"+e.getUTCHours()).slice(-2),o=("00"+e.getUTCMinutes()).slice(-2),h=("00"+e.getUTCSeconds()).slice(-2);return i+n+r+s+o+h+"Z"};(typeof a=="undefined"||!a)&&(a={});(typeof a.jws=="undefined"||!a.jws)&&(a.jws={});a.jws.JWSJS=function(){var t=a,e=t.jws,i=e.JWS,n=i.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(r){this.init();var s=r.split(".");if(s.length!=3)throw"malformed input JWS";this.aHeader.push(s[0]),this.sPayload=s[1],this.aSignature.push(s[2])},this.addSignature=function(r,s,o,h){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var g=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var p=a.jws.JWS.sign(r,s,this.sPayload,o,h),S=p.split("."),y=S[0],l=S[2];this.aHeader.push(S[0]),this.aSignature.push(S[2])}catch(f){throw this.aHeader.length>g&&this.aHeader.pop(),this.aSignature.length>g&&this.aSignature.pop(),"addSignature failed: "+f}},this.verifyAll=function(r){if(this.aHeader.length!==r.length||this.aSignature.length!==r.length)return!1;for(var s=0;s<r.length;s++){var o=r[s];if(o.length!==2)return!1;var h=this.verifyNth(s,o[0],o[1]);if(h===!1)return!1}return!0},this.verifyNth=function(r,s,o){if(this.aHeader.length<=r||this.aSignature.length<=r)return!1;var h=this.aHeader[r],g=this.aSignature[r],p=h+"."+this.sPayload+"."+g,S=!1;try{S=i.verify(p,s,o)}catch(y){return!1}return S},this.readJWSJS=function(r){if(typeof r=="string"){var s=n(r);if(s==null)throw"argument is not safe JSON object string";this.aHeader=s.headers,this.sPayload=s.payload,this.aSignature=s.signatures}else try{if(r.headers.length>0)this.aHeader=r.headers;else throw"malformed header";if(typeof r.payload=="string")this.sPayload=r.payload;else throw"malformed signatures";if(r.signatures.length>0)this.aSignatures=r.signatures;else throw"malformed signatures"}catch(o){throw"malformed JWS-JS JSON object: "+o}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}};})();
/*!
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/
/*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
 */
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
/*! CryptoJS v3.1.2 core-fix.js
 * code.google.com/p/crypto-js
 * (c) 2009-2013 by Jeff Mott. All rights reserved.
 * code.google.com/p/crypto-js/wiki/License
 * THIS IS FIX of 'core.js' to fix Hmac issue.
 * https://code.google.com/p/crypto-js/issues/detail?id=84
 * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
 */
/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
 */
//# sourceMappingURL=jsrsasign-all-min.bundle.OJX7WT4T.js.map
